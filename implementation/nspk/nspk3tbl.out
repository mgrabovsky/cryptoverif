File "implementation/nspk/nspk3tbl.ocv", line 227, character 14 - line 227, character 15:
Warning: Foreach uses the same parameter N as foreach at line 197, character 14 - line 197, character 15. Avoid reusing parameters for multiple foreach to avoid losing precision in the probability bound.
File "implementation/nspk/nspk3tbl.ocv", line 271, character 24 - line 271, character 25:
Warning: Foreach uses the same parameter N as foreach at line 227, character 14 - line 227, character 15. Avoid reusing parameters for multiple foreach to avoid losing precision in the probability bound.
Doing expand get, insert, if, let, find... Done.
Doing remove assignments of useless... Done.
Doing simplify... Doing global dependency analysis on Nb_248 inside simplify... No change
Doing global dependency analysis on Na_235 inside simplify... No change
Doing global dependency analysis on Nb_248 inside simplify... No change
Doing global dependency analysis on Na_235 inside simplify... No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
      OStart() :=
      k_232 <-R skeyseed;
      pkS: spkey <- spkgen(k_232);
      skS: sskey <- sskgen(k_232);
      return(pkS);
      (
        OAGK() :=
        A: host <- concat4(hostnameA, roleA);
        k_233 <-R keyseed;
        pkA: pkey <- pkgen(k_233);
        skA: skey <- skgen(k_233);
        return(pkA);
        foreach i_228 <= N do
        OA1(hostX: host) :=
        return(A, hostX);
        OA3(pkX: pkey, =hostX, ms_234: signature) :=
        if check(concat3(pkX, hostX), pkS, ms_234) then
        Na_235 <-R nonce;
        msg_236: blocksize <- concat1(Na_235, A);
        r_238 <-R seed;
        return(enc_r(msg_236, pkX, r_238));
        OA5(m_239: bitstring) :=
        let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
        event beginA(A, hostX, Na_235, Nb_240);
        msg_241: blocksize <- pad(Nb_240);
        r_243 <-R seed;
        return(enc_r(msg_241, pkX, r_243));
        OAFinish() :=
        if defined(B) && (hostX = B) then
        event endA(A, hostX, Na_235, Nb_240)
      ) | (
        OBGK() :=
        B: host <- concat4(hostnameB, roleB);
        k_244 <-R keyseed;
        pkB: pkey <- pkgen(k_244);
        skB: skey <- skgen(k_244);
        return(pkB);
        foreach i_229 <= N do
        OB7(m_245: bitstring) :=
        let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
        return(B, hostY);
        OB9(pkY: pkey, =hostY, ms_247: signature) :=
        if check(concat3(pkY, hostY), pkS, ms_247) then
        Nb_248 <-R nonce;
        event beginB(hostY, B, Na_246, Nb_248);
        msg_249: blocksize <- concat2(Na_246, Nb_248, B);
        r_251 <-R seed;
        return(enc_r(msg_249, pkY, r_251));
        OB11(m3: bitstring) :=
        let injbot(pad(=Nb_248)) = dec(m3, skB) in
        return();
        OBFinish() :=
        if defined(A) && (hostY = A) then
        event endB(hostY, B, Na_246, Nb_248)
      ) | (
        foreach i_230 <= N do
        OS13(h1: host, h2: host) :=
        find  suchthat defined(A, pkA) && (A = h2) then
        (
          msg_253: sblocksize <- concat3(pkA, h2);
          r_307 <-R sseed;
          return(pkA, h2, sign_r(msg_253, skS, r_307))
        )
        orfind  suchthat defined(B, pkB) && (B = h2) then
        (
          msg_253: sblocksize <- concat3(pkB, h2);
          r_308 <-R sseed;
          return(pkB, h2, sign_r(msg_253, skS, r_308))
        )
        orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
        (
          msg_253: sblocksize <- concat3(Kkey[u_305], h2);
          r_309 <-R sseed;
          return(Kkey[u_305], h2, sign_r(msg_253, skS, r_309))
        )
      ) | (
        foreach i_231 <= N2 do
        OK12(Khost_256: host, Kkey: pkey) :=
        if defined(A, B, pkB, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
        keytbl_304: pkey <- cst_pkey
      )

Trying equivalence uf_cma(sign_r) with k_232... Failed.
Doing remove assignments of binder skS... Done.
Doing remove assignments of binder pkS... Done.
Trying equivalence uf_cma(sign_r) with k_232... Succeeded.
Doing remove assignments of useless... Done.
Doing simplify... Doing global dependency analysis on Nb_248 inside simplify... No change
Doing global dependency analysis on Na_235 inside simplify... No change
Doing global dependency analysis on Nb_248 inside simplify... No change
Doing global dependency analysis on Na_235 inside simplify... No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence uf_cma(sign_r) ... Failed.
Trying equivalence ind_cca2(enc_r) ... Failed.
Doing remove assignments of binder pkB... Done.
Doing remove assignments of binder skB... Done.
Trying equivalence ind_cca2(enc_r) with k_244, r_337, r_336, r_340, r_339, r_343, r_342, r_330, r_332, r_334... Reduced (pkgen(k_233) = @19_pkgen2(k_389)) to false Probability: Penccoll
Succeeded.
Doing remove assignments of useless... Done.
Doing simplify... Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Na_338 inside simplify... No change
Doing global dependency analysis on Nb_331 inside simplify... No change
Doing global dependency analysis on Nb_329 inside simplify... No change
Doing global dependency analysis on Na_335 inside simplify... No change
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Na_338 inside simplify... No change
Doing global dependency analysis on Nb_331 inside simplify... No change
Doing global dependency analysis on Nb_329 inside simplify... No change
Doing global dependency analysis on Na_335 inside simplify... No change
Run simplify 2 time(s). Maximum reached.
Done.
Doing SA rename msg_236... Done.
Doing remove assignments of useless... Done.
Doing simplify... Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Na_338 inside simplify... No change
Doing global dependency analysis on Nb_331 inside simplify... Done. Restarting simplify
Doing global dependency analysis on Nb_469 inside simplify... No change
Doing global dependency analysis on Na_338 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Nb_471 inside simplify... No change
Doing global dependency analysis on Nb_473 inside simplify... No change
Doing global dependency analysis on Na_335 inside simplify... No change
Doing global dependency analysis on Nb_469 inside simplify... No change
Doing global dependency analysis on Na_338 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Nb_471 inside simplify... No change
Doing global dependency analysis on Nb_473 inside simplify... No change
Doing global dependency analysis on Na_335 inside simplify... No change
Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between injbot(pad(Nb_331)) and @19_dec2(m3, @19_skgen2(k_389)) Probability: N / |nonce|
(injbot(pad(Nb_331)) characterizes a part of Nb_331[...] of type(s) nonce;
 @19_dec2(m3, @19_skgen2(k_389)) does not depend on Nb_331[...])
Eliminated collisions between Nb_331 and Nb_240[@i_421] Probability: N / |nonce|
(Nb_331 characterizes a part of Nb_331[...] of type(s) nonce;
 Nb_240[@i_421] does not depend on Nb_331[...])
Eliminated collisions between Nb_331 and Nb_240[@i_425] Probability: N / |nonce|
(Nb_331 characterizes a part of Nb_331[...] of type(s) nonce;
 Nb_240[@i_425] does not depend on Nb_331[...])
Done.
Doing SA rename msg_249... Done.
Doing remove assignments of useless... No change.
Doing simplify... Doing global dependency analysis on Nb_469 inside simplify... No change
Doing global dependency analysis on Na_338 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Nb_471 inside simplify... No change
Doing global dependency analysis on Nb_473 inside simplify... No change
Doing global dependency analysis on Na_335 inside simplify... No change
Run simplify 1 time(s). Fixpoint reached.
No change.
Doing simplify... Doing global dependency analysis on Nb_469 inside simplify... No change
Doing global dependency analysis on Na_338 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Nb_471 inside simplify... No change
Doing global dependency analysis on Nb_473 inside simplify... No change
Doing global dependency analysis on Na_335 inside simplify... No change
Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... Done.
Doing remove assignments of useless... No change.
User advice: to prove event endB(x, y, na, nb) ==> beginA(x, y, na, nb), you could try
  SA rename Nb_240
User advice: to prove event inj:endB(x, y, na, nb) ==> inj:beginA(x, y, na, nb), you could try
  SA rename Nb_240
Trying equivalence uf_cma(sign_r) ... Failed.
Trying equivalence ind_cca2(enc_r) ... Failed.
Doing SA rename Na_341... Done.
Doing remove assignments of useless... No change.
Doing simplify... Doing global dependency analysis on Nb_469 inside simplify... No change
Doing global dependency analysis on Na_338 inside simplify... No change
Doing global dependency analysis on Na_519 inside simplify... No change
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Nb_471 inside simplify... No change
Doing global dependency analysis on Nb_473 inside simplify... No change
Doing global dependency analysis on Na_335 inside simplify... No change
Doing global dependency analysis on Na_520 inside simplify... No change
Run simplify 1 time(s). Fixpoint reached.
No change.
Trying equivalence ind_cca2(enc_r) with Na_520, @19_r3_368, @19_r3_373, @19_r3_348, @19_r3_353, @19_r3_388, @19_r3_470, @19_r3_474, @19_r3_472... Failed.
Trying equivalence ind_cca2(enc_r) with Na_519, @19_r3_368, @19_r3_373, @19_r3_348, @19_r3_353, @19_r3_388, @19_r3_470, @19_r3_474, @19_r3_472... Failed.
Doing remove assignments of binder pkA... Done.
Doing remove assignments of binder skA... Done.
Trying equivalence ind_cca2(enc_r) with k_233, @19_r3_368, @19_r3_373, @19_r3_348, @19_r3_353, @19_r3_388, @19_r3_470, @19_r3_474, @19_r3_472... Succeeded.
Doing remove assignments of useless... Done.
Doing simplify... Doing global dependency analysis on Nb_469 inside simplify... No change
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Nb_471 inside simplify... No change
Doing global dependency analysis on Nb_473 inside simplify... No change
Doing global dependency analysis on Na_335 inside simplify... No change
Doing global dependency analysis on Na_338 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_469 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Nb_471 inside simplify... No change
Doing global dependency analysis on Nb_473 inside simplify... No change
Doing global dependency analysis on Na_335 inside simplify... Done. Restarting simplify
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_469 inside simplify... No change
Doing global dependency analysis on Nb_473 inside simplify... No change
Doing global dependency analysis on Nb_471 inside simplify... No change
Doing global dependency analysis on Na_338 inside simplify... Done. Restarting simplify
Doing global dependency analysis on Nb_469 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Nb_471 inside simplify... No change
Doing global dependency analysis on Nb_473 inside simplify... No change
Run simplify 2 time(s). Maximum reached.
Eliminated collisions between injbot(concat2(Na_338, ?, ?)) and @19_dec2(m_239, @19_skgen2(k_562)) Probability: N / |nonce|
(injbot(concat2(Na_338, ?, ?)) characterizes a part of Na_338[...] of type(s) nonce;
 @19_dec2(m_239, @19_skgen2(k_562)) does not depend on Na_338[...])
Eliminated collisions between Na_338 and Na_246[@i_605] Probability: N / |nonce|
(Na_338 characterizes a part of Na_338[...] of type(s) nonce;
 Na_246[@i_605] does not depend on Na_338[...])
Eliminated collisions between Na_338 and Na_246[@i_603] Probability: N / |nonce|
(Na_338 characterizes a part of Na_338[...] of type(s) nonce;
 Na_246[@i_603] does not depend on Na_338[...])
Eliminated collisions between injbot(concat2(Na_335, ?, ?)) and @19_dec2(m_239, @19_skgen2(k_562)) Probability: N / |nonce|
(injbot(concat2(Na_335, ?, ?)) characterizes a part of Na_335[...] of type(s) nonce;
 @19_dec2(m_239, @19_skgen2(k_562)) does not depend on Na_335[...])
Eliminated collisions between Na_335 and Na_246[@i_619] Probability: N / |nonce|
(Na_335 characterizes a part of Na_335[...] of type(s) nonce;
 Na_246[@i_619] does not depend on Na_335[...])
Eliminated collisions between Na_335 and Na_246[@i_621] Probability: N / |nonce|
(Na_335 characterizes a part of Na_335[...] of type(s) nonce;
 Na_246[@i_621] does not depend on Na_335[...])
Eliminated collisions between Na_341 and Na_338[!2_4413] Probability: N * N / |nonce|
(Na_341 characterizes a part of Na_341 of type(s) nonce;
 Na_338[!2_4413] does not depend on Na_341)
Eliminated collisions between Na_338 and Na_341[!2_4317] Probability: N * N / |nonce|
(Na_338 characterizes a part of Na_338 of type(s) nonce;
 Na_341[!2_4317] does not depend on Na_338)
Eliminated collisions between Na_335 and Na_341[!2_4205] Probability: N * N / |nonce|
(Na_335 characterizes a part of Na_335 of type(s) nonce;
 Na_341[!2_4205] does not depend on Na_335)
Eliminated collisions between Na_335 and Na_338[!2_4182] Probability: N * N / |nonce|
(Na_335 characterizes a part of Na_335 of type(s) nonce;
 Na_338[!2_4182] does not depend on Na_335)
Eliminated collisions between Nb_473 and Nb_471 Probability: N * N / |nonce|
Eliminated collisions between Nb_471 and Nb_471 Probability: 0.5 * N * N / |nonce|
Eliminated collisions between Nb_333 and Nb_471 Probability: N * N / |nonce|
Eliminated collisions between Nb_469 and Nb_471 Probability: N * N / |nonce|
Eliminated collisions between Na_341 and Na_341 Probability: 0.5 * N * N / |nonce|
Eliminated collisions between Na_338 and Na_338 Probability: 0.5 * N * N / |nonce|
Reduced (@19_pkgen2(k_562) = @19_pkgen2(k_389)) to false Probability: Penccoll
Done.
Doing SA rename Nb_240... Done.
Doing remove assignments of useless... Done.
Doing simplify... Doing global dependency analysis on Nb_469 inside simplify... Done. Restarting simplify
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_473 inside simplify... Done. Restarting simplify
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_471 inside simplify... Done. Restarting simplify
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between injbot(pad(Nb_471)) and @19_dec2(m3, @19_skgen2(k_389)) Probability: N / |nonce|
(injbot(pad(Nb_471)) characterizes a part of Nb_471[...] of type(s) nonce;
 @19_dec2(m3, @19_skgen2(k_389)) does not depend on Nb_471[...])
Eliminated collisions between Nb_471 and Nb_819[@i_403] Probability: N / |nonce|
(Nb_471 characterizes a part of Nb_471[...] of type(s) nonce;
 Nb_819[@i_403] does not depend on Nb_471[...])
Eliminated collisions between injbot(pad(Nb_473)) and @19_dec2(m3, @19_skgen2(k_389)) Probability: N / |nonce|
(injbot(pad(Nb_473)) characterizes a part of Nb_473[...] of type(s) nonce;
 @19_dec2(m3, @19_skgen2(k_389)) does not depend on Nb_473[...])
Eliminated collisions between Nb_473 and Nb_819[@i_403] Probability: N / |nonce|
(Nb_473 characterizes a part of Nb_473[...] of type(s) nonce;
 Nb_819[@i_403] does not depend on Nb_473[...])
Eliminated collisions between injbot(pad(Nb_469)) and @19_dec2(m3, @19_skgen2(k_389)) Probability: N / |nonce|
(injbot(pad(Nb_469)) characterizes a part of Nb_469[...] of type(s) nonce;
 @19_dec2(m3, @19_skgen2(k_389)) does not depend on Nb_469[...])
Eliminated collisions between Nb_469 and Nb_819[@i_403] Probability: N / |nonce|
(Nb_469 characterizes a part of Nb_469[...] of type(s) nonce;
 Nb_819[@i_403] does not depend on Nb_469[...])
Done.
Doing simplify... Doing global dependency analysis on Nb_333 inside simplify... No change
Doing global dependency analysis on Na_341 inside simplify... No change
Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... Done.
Doing remove assignments of useless... No change.
Proved query event endA(x, y, na, nb) ==> beginB(x, y, na, nb)
Proved query event endB(x, y, na, nb) ==> beginA(x, y, na, nb)
Proved query event inj:endA(x, y, na, nb) ==> inj:beginB(x, y, na, nb)
Proved query event inj:endB(x, y, na, nb) ==> inj:beginA(x, y, na, nb)
===================== Proof starts =======================
Initial state
Game 1 is
        OStart() :=
        let skp(pkS: spkey, skS: sskey) = (k_232 <-R skeyseed; skp(spkgen(k_232), sskgen(k_232))) in
        return(pkS);
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          let kp(pkA: pkey, skA: skey) = (k_233 <-R keyseed; kp(pkgen(k_233), skgen(k_233))) in
          insert keytbl A, pkA;
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          if check(concat3(pkX, hostX), pkS, ms_234) then
          Na_235 <-R nonce;
          return((msg_236: blocksize <- concat1(Na_235, A); (k_237: pkey <- pkX; r_238 <-R seed; enc_r(msg_236, k_237, r_238))));
          OA5(m_239: bitstring) :=
          let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
          event beginA(A, hostX, Na_235, Nb_240);
          return((msg_241: blocksize <- pad(Nb_240); (k_242: pkey <- pkX; r_243 <-R seed; enc_r(msg_241, k_242, r_243))));
          OAFinish() :=
          if defined(B) && (hostX = B) then
          event endA(A, hostX, Na_235, Nb_240)
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          let kp(pkB: pkey, skB: skey) = (k_244 <-R keyseed; kp(pkgen(k_244), skgen(k_244))) in
          insert keytbl B, pkB;
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          if check(concat3(pkY, hostY), pkS, ms_247) then
          Nb_248 <-R nonce;
          event beginB(hostY, B, Na_246, Nb_248);
          return((msg_249: blocksize <- concat2(Na_246, Nb_248, B); (k_250: pkey <- pkY; r_251 <-R seed; enc_r(msg_249, k_250, r_251))));
          OB11(m3: bitstring) :=
          let injbot(pad(=Nb_248)) = dec(m3, skB) in
          return();
          OBFinish() :=
          if defined(A) && (hostY = A) then
          event endB(hostY, B, Na_246, Nb_248)
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          get keytbl (Khost_252: host, Rkey: pkey) suchthat (Khost_252 = h2) in
          return(Rkey, h2, (msg_253: sblocksize <- concat3(Rkey, h2); (k_254: sskey <- skS; r_255 <-R sseed; sign_r(msg_253, k_254, r_255))))
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkA, pkB) && (Khost_256 <> A) && (Khost_256 <> B) then
          insert keytbl Khost_256, Kkey
        )


Applying expand get, insert, if, let, find
  - Expand get/insert for table keytbl
  - Expand if/find/let
yields

Game 2 is
        OStart() :=
        k_232 <-R skeyseed;
     {3}let skp(pkS: spkey, skS: sskey) = skp(spkgen(k_232), sskgen(k_232)) in
        return(pkS);
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
    {21}  let kp(pkA: pkey, skA: skey) = kp(pkgen(k_233), skgen(k_233)) in
          keytbl_299: host <- A;
          keytbl_300: pkey <- pkA;
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          if check(concat3(pkX, hostX), pkS, ms_234) then
          Na_235 <-R nonce;
          msg_236: blocksize <- concat1(Na_235, A);
          k_237: pkey <- pkX;
          r_238 <-R seed;
          return(enc_r(msg_236, k_237, r_238));
          OA5(m_239: bitstring) :=
          let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
          event beginA(A, hostX, Na_235, Nb_240);
          msg_241: blocksize <- pad(Nb_240);
          k_242: pkey <- pkX;
          r_243 <-R seed;
          return(enc_r(msg_241, k_242, r_243));
          OAFinish() :=
          if defined(B) && (hostX = B) then
          event endA(A, hostX, Na_235, Nb_240)
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
   {150}  let kp(pkB: pkey, skB: skey) = kp(pkgen(k_244), skgen(k_244)) in
          keytbl_301: host <- B;
          keytbl_302: pkey <- pkB;
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          if check(concat3(pkY, hostY), pkS, ms_247) then
          Nb_248 <-R nonce;
          event beginB(hostY, B, Na_246, Nb_248);
          msg_249: blocksize <- concat2(Na_246, Nb_248, B);
          k_250: pkey <- pkY;
          r_251 <-R seed;
          return(enc_r(msg_249, k_250, r_251));
          OB11(m3: bitstring) :=
          let injbot(pad(=Nb_248)) = dec(m3, skB) in
          return();
          OBFinish() :=
          if defined(A) && (hostY = A) then
          event endB(hostY, B, Na_246, Nb_248)
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(keytbl_299, keytbl_300) && (keytbl_299 = h2) then
          (
            msg_253: sblocksize <- concat3(keytbl_300, h2);
            k_254: sskey <- skS;
            r_255 <-R sseed;
            return(keytbl_300, h2, sign_r(msg_253, k_254, r_255))
          )
          orfind  suchthat defined(keytbl_301, keytbl_302) && (keytbl_301 = h2) then
          (
            msg_253: sblocksize <- concat3(keytbl_302, h2);
            k_254: sskey <- skS;
            r_255 <-R sseed;
            return(keytbl_302, h2, sign_r(msg_253, k_254, r_255))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(keytbl_303[u_306], keytbl_304[u_306]) && (keytbl_303[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(keytbl_304[u_305], h2);
            k_254: sskey <- skS;
            r_255 <-R sseed;
            return(keytbl_304[u_305], h2, sign_r(msg_253, k_254, r_255))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkA, pkB) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_303: host <- Khost_256;
          keytbl_304: pkey <- Kkey
        )


Applying remove assignments of useless
  - Remove assignments on keytbl_303 (definition point kept, all usages removed)
  - Remove assignments on keytbl_304 (definition point kept, all usages removed)
  - Remove assignments on k_254 (definition removed, all usages removed)
  - Remove assignments on k_254 (definition removed, all usages removed)
  - Remove assignments on k_254 (definition removed, all usages removed)
  - Remove assignments on keytbl_301 (definition removed, all usages removed)
  - Remove assignments on keytbl_302 (definition removed, all usages removed)
  - Remove assignments on k_250 (definition removed, all usages removed)
  - Simplify pattern kp(pkB: pkey, skB: skey) at 150 (tuple expanded)
  - Remove assignments on keytbl_299 (definition removed, all usages removed)
  - Remove assignments on keytbl_300 (definition removed, all usages removed)
  - Remove assignments on k_237 (definition removed, all usages removed)
  - Remove assignments on k_242 (definition removed, all usages removed)
  - Simplify pattern kp(pkA: pkey, skA: skey) at 21 (tuple expanded)
  - Simplify pattern skp(pkS: spkey, skS: sskey) at 3 (tuple expanded)
yields

Game 3 is
        OStart() :=
        k_232 <-R skeyseed;
        pkS: spkey <- spkgen(k_232);
        skS: sskey <- sskgen(k_232);
        return(pkS);
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          if check(concat3(pkX, hostX), pkS, ms_234) then
          Na_235 <-R nonce;
          msg_236: blocksize <- concat1(Na_235, A);
          r_238 <-R seed;
          return(enc_r(msg_236, pkX, r_238));
          OA5(m_239: bitstring) :=
          let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
          event beginA(A, hostX, Na_235, Nb_240);
          msg_241: blocksize <- pad(Nb_240);
          r_243 <-R seed;
          return(enc_r(msg_241, pkX, r_243));
          OAFinish() :=
          if defined(B) && (hostX = B) then
          event endA(A, hostX, Na_235, Nb_240)
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          pkB: pkey <- pkgen(k_244);
          skB: skey <- skgen(k_244);
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          if check(concat3(pkY, hostY), pkS, ms_247) then
          Nb_248 <-R nonce;
          event beginB(hostY, B, Na_246, Nb_248);
          msg_249: blocksize <- concat2(Na_246, Nb_248, B);
          r_251 <-R seed;
          return(enc_r(msg_249, pkY, r_251));
          OB11(m3: bitstring) :=
          let injbot(pad(=Nb_248)) = dec(m3, skB) in
          return();
          OBFinish() :=
          if defined(A) && (hostY = A) then
          event endB(hostY, B, Na_246, Nb_248)
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
   {243}  find  suchthat defined(A, pkA, pkA, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_255 <-R sseed;
            return(pkA, h2, sign_r(msg_253, skS, r_255))
          )
          orfind  suchthat defined(B, pkB, pkB, pkB) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkB, h2);
            r_255 <-R sseed;
            return(pkB, h2, sign_r(msg_253, skS, r_255))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306], keytbl_303[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_255 <-R sseed;
            return(Kkey[u_305], h2, sign_r(msg_253, skS, r_255))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkA, pkB) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_303: host <- cst_host;
          keytbl_304: pkey <- cst_pkey
        )


Applying simplify
  - Simplification pass
    - Replaced defined condition Khost_256[u_306], Kkey[u_306], keytbl_304[u_306], keytbl_303[u_306] with keytbl_304[u_306], Kkey[u_306], Khost_256[u_306] in find at 243
    - Replaced defined condition B, pkB, pkB, pkB with pkB, B in find at 243
    - Replaced defined condition A, pkA, pkA, pkA with pkA, A in find at 243
yields

Game 4 is
        OStart() :=
        k_232 <-R skeyseed;
        pkS: spkey <- spkgen(k_232);
        skS: sskey <- sskgen(k_232);
        return(pkS);
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          if check(concat3(pkX, hostX), pkS, ms_234) then
          Na_235 <-R nonce;
          msg_236: blocksize <- concat1(Na_235, A);
          r_238 <-R seed;
          return(enc_r(msg_236, pkX, r_238));
          OA5(m_239: bitstring) :=
          let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
          event beginA(A, hostX, Na_235, Nb_240);
          msg_241: blocksize <- pad(Nb_240);
          r_243 <-R seed;
          return(enc_r(msg_241, pkX, r_243));
          OAFinish() :=
          if defined(B) && (hostX = B) then
          event endA(A, hostX, Na_235, Nb_240)
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          pkB: pkey <- pkgen(k_244);
          skB: skey <- skgen(k_244);
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          if check(concat3(pkY, hostY), pkS, ms_247) then
          Nb_248 <-R nonce;
          event beginB(hostY, B, Na_246, Nb_248);
          msg_249: blocksize <- concat2(Na_246, Nb_248, B);
          r_251 <-R seed;
          return(enc_r(msg_249, pkY, r_251));
          OB11(m3: bitstring) :=
          let injbot(pad(=Nb_248)) = dec(m3, skB) in
          return();
          OBFinish() :=
          if defined(A) && (hostY = A) then
          event endB(hostY, B, Na_246, Nb_248)
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_255 <-R sseed;
            return(pkA, h2, sign_r(msg_253, skS, r_255))
          )
          orfind  suchthat defined(B, pkB) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkB, h2);
            r_255 <-R sseed;
            return(pkB, h2, sign_r(msg_253, skS, r_255))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_255 <-R sseed;
            return(Kkey[u_305], h2, sign_r(msg_253, skS, r_255))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkB, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_303: host <- cst_host;
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of useless
  - Remove assignments on keytbl_303 (definition removed, all usages removed)
  - Rename variable r_255 into r_309, r_308, r_307
yields

Game 5 is
        OStart() :=
        k_232 <-R skeyseed;
        pkS: spkey <- spkgen(k_232);
        skS: sskey <- sskgen(k_232);
        return(pkS);
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          if check(concat3(pkX, hostX), pkS, ms_234) then
          Na_235 <-R nonce;
          msg_236: blocksize <- concat1(Na_235, A);
          r_238 <-R seed;
          return(enc_r(msg_236, pkX, r_238));
          OA5(m_239: bitstring) :=
          let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
          event beginA(A, hostX, Na_235, Nb_240);
          msg_241: blocksize <- pad(Nb_240);
          r_243 <-R seed;
          return(enc_r(msg_241, pkX, r_243));
          OAFinish() :=
          if defined(B) && (hostX = B) then
          event endA(A, hostX, Na_235, Nb_240)
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          pkB: pkey <- pkgen(k_244);
          skB: skey <- skgen(k_244);
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          if check(concat3(pkY, hostY), pkS, ms_247) then
          Nb_248 <-R nonce;
          event beginB(hostY, B, Na_246, Nb_248);
          msg_249: blocksize <- concat2(Na_246, Nb_248, B);
          r_251 <-R seed;
          return(enc_r(msg_249, pkY, r_251));
          OB11(m3: bitstring) :=
          let injbot(pad(=Nb_248)) = dec(m3, skB) in
          return();
          OBFinish() :=
          if defined(A) && (hostY = A) then
          event endB(hostY, B, Na_246, Nb_248)
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, sign_r(msg_253, skS, r_307))
          )
          orfind  suchthat defined(B, pkB) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkB, h2);
            r_308 <-R sseed;
            return(pkB, h2, sign_r(msg_253, skS, r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, sign_r(msg_253, skS, r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkB, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of binder skS
  - Remove assignments on skS (definition removed, all usages removed)
yields

Game 6 is
        OStart() :=
        k_232 <-R skeyseed;
        pkS: spkey <- spkgen(k_232);
        return(pkS);
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          if check(concat3(pkX, hostX), pkS, ms_234) then
          Na_235 <-R nonce;
          msg_236: blocksize <- concat1(Na_235, A);
          r_238 <-R seed;
          return(enc_r(msg_236, pkX, r_238));
          OA5(m_239: bitstring) :=
          let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
          event beginA(A, hostX, Na_235, Nb_240);
          msg_241: blocksize <- pad(Nb_240);
          r_243 <-R seed;
          return(enc_r(msg_241, pkX, r_243));
          OAFinish() :=
          if defined(B) && (hostX = B) then
          event endA(A, hostX, Na_235, Nb_240)
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          pkB: pkey <- pkgen(k_244);
          skB: skey <- skgen(k_244);
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          if check(concat3(pkY, hostY), pkS, ms_247) then
          Nb_248 <-R nonce;
          event beginB(hostY, B, Na_246, Nb_248);
          msg_249: blocksize <- concat2(Na_246, Nb_248, B);
          r_251 <-R seed;
          return(enc_r(msg_249, pkY, r_251));
          OB11(m3: bitstring) :=
          let injbot(pad(=Nb_248)) = dec(m3, skB) in
          return();
          OBFinish() :=
          if defined(A) && (hostY = A) then
          event endB(hostY, B, Na_246, Nb_248)
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, sign_r(msg_253, sskgen(k_232), r_307))
          )
          orfind  suchthat defined(B, pkB) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkB, h2);
            r_308 <-R sseed;
            return(pkB, h2, sign_r(msg_253, sskgen(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, sign_r(msg_253, sskgen(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkB, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of binder pkS
  - Remove assignments on pkS (definition removed, all usages removed)
yields

Game 7 is
        OStart() :=
        k_232 <-R skeyseed;
        return(spkgen(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          if check(concat3(pkX, hostX), spkgen(k_232), ms_234) then
          Na_235 <-R nonce;
          msg_236: blocksize <- concat1(Na_235, A);
          r_238 <-R seed;
          return(enc_r(msg_236, pkX, r_238));
          OA5(m_239: bitstring) :=
          let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
          event beginA(A, hostX, Na_235, Nb_240);
          msg_241: blocksize <- pad(Nb_240);
          r_243 <-R seed;
          return(enc_r(msg_241, pkX, r_243));
          OAFinish() :=
          if defined(B) && (hostX = B) then
          event endA(A, hostX, Na_235, Nb_240)
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          pkB: pkey <- pkgen(k_244);
          skB: skey <- skgen(k_244);
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          if check(concat3(pkY, hostY), spkgen(k_232), ms_247) then
          Nb_248 <-R nonce;
          event beginB(hostY, B, Na_246, Nb_248);
          msg_249: blocksize <- concat2(Na_246, Nb_248, B);
          r_251 <-R seed;
          return(enc_r(msg_249, pkY, r_251));
          OB11(m3: bitstring) :=
          let injbot(pad(=Nb_248)) = dec(m3, skB) in
          return();
          OBFinish() :=
          if defined(A) && (hostY = A) then
          event endB(hostY, B, Na_246, Nb_248)
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, sign_r(msg_253, sskgen(k_232), r_307))
          )
          orfind  suchthat defined(B, pkB) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkB, h2);
            r_308 <-R sseed;
            return(pkB, h2, sign_r(msg_253, sskgen(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, sign_r(msg_253, sskgen(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkB, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying equivalence uf_cma(sign_r) with k_232 [probability Psign(time(context for game 7) + time + (-1. + 2. * N) * time(check), N)]
  - Equivalence uf_cma(sign_r) with r_309, r_308, r_307, k_232
  - Expand if/find/let
yields

Game 8 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          @20_si1_310: signature <- ms_234;
          find @i_328 = @ri_327 <= N suchthat defined(@20_x_314[@ri_327]) && (@20_m1_311 = @20_x_314[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), @20_si1_310) then
          (
            Na_235 <-R nonce;
            msg_236: blocksize <- concat1(Na_235, A);
            r_238 <-R seed;
            return(enc_r(msg_236, pkX, r_238));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_235, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_243 <-R seed;
            return(enc_r(msg_241, pkX, r_243));
            OAFinish() :=
            if defined(B) && (hostX = B) then
            event endA(A, hostX, Na_235, Nb_240)
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(@20_x_315[@ri_325]) && (@20_m1_311 = @20_x_315[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), @20_si1_310) then
          (
            Na_235 <-R nonce;
            msg_236: blocksize <- concat1(Na_235, A);
            r_238 <-R seed;
            return(enc_r(msg_236, pkX, r_238));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_235, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_243 <-R seed;
            return(enc_r(msg_241, pkX, r_243));
            OAFinish() :=
            if defined(B) && (hostX = B) then
            event endA(A, hostX, Na_235, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(@20_x_316[@ri_323]) && (@20_m1_311 = @20_x_316[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), @20_si1_310) then
          (
            Na_235 <-R nonce;
            msg_236: blocksize <- concat1(Na_235, A);
            r_238 <-R seed;
            return(enc_r(msg_236, pkX, r_238));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_235, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_243 <-R seed;
            return(enc_r(msg_241, pkX, r_243));
            OAFinish() :=
            if defined(B) && (hostX = B) then
            event endA(A, hostX, Na_235, Nb_240)
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          pkB: pkey <- pkgen(k_244);
          skB: skey <- skgen(k_244);
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          @20_m1_313: sblocksize <- concat3(pkY, hostY);
          @20_si1_312: signature <- ms_247;
          find @i_322 = @ri_321 <= N suchthat defined(@20_x_314[@ri_321]) && (@20_m1_313 = @20_x_314[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), @20_si1_312) then
          (
            Nb_248 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_248);
            msg_249: blocksize <- concat2(Na_246, Nb_248, B);
            r_251 <-R seed;
            return(enc_r(msg_249, pkY, r_251));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_248)) = dec(m3, skB) in
            return();
            OBFinish() :=
            if defined(A) && (hostY = A) then
            event endB(hostY, B, Na_246, Nb_248)
          )
          orfind @i_320 = @ri_319 <= N suchthat defined(@20_x_315[@ri_319]) && (@20_m1_313 = @20_x_315[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), @20_si1_312) then
          (
            Nb_248 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_248);
            msg_249: blocksize <- concat2(Na_246, Nb_248, B);
            r_251 <-R seed;
            return(enc_r(msg_249, pkY, r_251));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_248)) = dec(m3, skB) in
            return();
            OBFinish() :=
            if defined(A) && (hostY = A) then
            event endB(hostY, B, Na_246, Nb_248)
          )
          orfind @i_318 = @ri_317 <= N suchthat defined(@20_x_316[@ri_317]) && (@20_m1_313 = @20_x_316[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), @20_si1_312) then
          (
            Nb_248 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_248);
            msg_249: blocksize <- concat2(Na_246, Nb_248, B);
            r_251 <-R seed;
            return(enc_r(msg_249, pkY, r_251));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_248)) = dec(m3, skB) in
            return();
            OBFinish() :=
            if defined(A) && (hostY = A) then
            event endB(hostY, B, Na_246, Nb_248)
          )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            @20_x_314: sblocksize <- msg_253;
            return(pkA, h2, @20_sign2(@20_x_314, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(B, pkB) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkB, h2);
            r_308 <-R sseed;
            @20_x_315: sblocksize <- msg_253;
            return(pkB, h2, @20_sign2(@20_x_315, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            @20_x_316: sblocksize <- msg_253;
            return(Kkey[u_305], h2, @20_sign2(@20_x_316, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkB, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of useless
  - Remove assignments on @20_x_314 (definition removed, all usages removed)
  - Remove assignments on @20_x_315 (definition removed, all usages removed)
  - Remove assignments on @20_x_316 (definition removed, all usages removed)
  - Remove assignments on @20_si1_312 (definition removed, all usages removed)
  - Remove assignments on @20_si1_310 (definition removed, all usages removed)
yields

Game 9 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
    {43}  find @i_328 = @ri_327 <= N suchthat defined(msg_253[@ri_327], r_307[@ri_327]) && (@20_m1_311 = msg_253[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_235 <-R nonce;
            msg_236: blocksize <- concat1(Na_235, A);
            r_238 <-R seed;
            return(enc_r(msg_236, pkX, r_238));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_235, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_243 <-R seed;
            return(enc_r(msg_241, pkX, r_243));
            OAFinish() :=
   {113}    if defined(B) && {114}(hostX = B) then
            event endA(A, hostX, Na_235, Nb_240)
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(msg_253[@ri_325], r_308[@ri_325]) && (@20_m1_311 = msg_253[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_235 <-R nonce;
            msg_236: blocksize <- concat1(Na_235, A);
            r_238 <-R seed;
            return(enc_r(msg_236, pkX, r_238));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_235, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_243 <-R seed;
            return(enc_r(msg_241, pkX, r_243));
            OAFinish() :=
            if defined(B) && {204}(hostX = B) then
            event endA(A, hostX, Na_235, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(msg_253[@ri_323], r_309[@ri_323]) && (@20_m1_311 = msg_253[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_235 <-R nonce;
            msg_236: blocksize <- concat1(Na_235, A);
            r_238 <-R seed;
            return(enc_r(msg_236, pkX, r_238));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_235, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_243 <-R seed;
            return(enc_r(msg_241, pkX, r_243));
            OAFinish() :=
   {293}    if defined(B) && {294}(hostX = B) then
            event endA(A, hostX, Na_235, Nb_240)
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          pkB: pkey <- pkgen(k_244);
          skB: skey <- skgen(k_244);
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          @20_m1_313: sblocksize <- concat3(pkY, hostY);
   {357}  find @i_322 = @ri_321 <= N suchthat defined(msg_253[@ri_321], r_307[@ri_321]) && (@20_m1_313 = msg_253[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_248 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_248);
            msg_249: blocksize <- concat2(Na_246, Nb_248, B);
            r_251 <-R seed;
            return(enc_r(msg_249, pkY, r_251));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_248)) = dec(m3, skB) in
            return();
            OBFinish() :=
            if defined(A) && {416}(hostY = A) then
            event endB(hostY, B, Na_246, Nb_248)
          )
          orfind @i_320 = @ri_319 <= N suchthat defined(msg_253[@ri_319], r_308[@ri_319]) && (@20_m1_313 = msg_253[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_248 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_248);
            msg_249: blocksize <- concat2(Na_246, Nb_248, B);
            r_251 <-R seed;
            return(enc_r(msg_249, pkY, r_251));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_248)) = dec(m3, skB) in
            return();
            OBFinish() :=
   {492}    if defined(A) && {493}(hostY = A) then
            event endB(hostY, B, Na_246, Nb_248)
          )
          orfind @i_318 = @ri_317 <= N suchthat defined(msg_253[@ri_317], r_309[@ri_317]) && (@20_m1_313 = msg_253[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_248 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_248);
            msg_249: blocksize <- concat2(Na_246, Nb_248, B);
            r_251 <-R seed;
            return(enc_r(msg_249, pkY, r_251));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_248)) = dec(m3, skB) in
            return();
            OBFinish() :=
   {569}    if defined(A) && {570}(hostY = A) then
            event endB(hostY, B, Na_246, Nb_248)
          )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(B, pkB) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkB, h2);
            r_308 <-R sseed;
            return(pkB, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkB, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying simplify
  - Simplification pass
    - Replaced ((@20_m1_313 = msg_253[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) with ((pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) at 1466
    - Replaced (hostY = A) with false at 570
    - Remove branch 1 in find at 569
    - Find at 569 removed (else branch kept if any)
    - Replaced defined condition msg_253[@ri_317], r_309[@ri_317] with r_309[@ri_317], h2[@ri_317], Kkey[u_305[@ri_317]] in find at 357
    - Replaced ((@20_m1_313 = msg_253[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) with ((pkY = pkB) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) at 1468
    - Replaced (hostY = A) with false at 493
    - Remove branch 1 in find at 492
    - Find at 492 removed (else branch kept if any)
    - Replaced defined condition msg_253[@ri_319], r_308[@ri_319] with r_308[@ri_319], h2[@ri_319] in find at 357
    - Replaced ((@20_m1_313 = msg_253[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) with ((pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) at 1470
    - Replaced (hostY = A) with true at 416
    - Replaced defined condition msg_253[@ri_321], r_307[@ri_321] with r_307[@ri_321], h2[@ri_321], pkA in find at 357
    - Replaced ((@20_m1_311 = msg_253[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234)) with ((pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234)) at 2472
    - Replaced (hostX = B) with false at 294
    - Remove branch 1 in find at 293
    - Find at 293 removed (else branch kept if any)
    - Replaced defined condition msg_253[@ri_323], r_309[@ri_323] with r_309[@ri_323], h2[@ri_323], Kkey[u_305[@ri_323]] in find at 43
    - Replaced ((@20_m1_311 = msg_253[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234)) with ((pkX = pkB) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234)) at 2474
    - Replaced (hostX = B) with true at 204
    - Replaced defined condition msg_253[@ri_325], r_308[@ri_325] with r_308[@ri_325], h2[@ri_325], pkB in find at 43
    - Replaced ((@20_m1_311 = msg_253[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234)) with ((pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234)) at 2476
    - Replaced (hostX = B) with false at 114
    - Remove branch 1 in find at 113
    - Find at 113 removed (else branch kept if any)
    - Replaced defined condition msg_253[@ri_327], r_307[@ri_327] with r_307[@ri_327], h2[@ri_327] in find at 43
yields

Game 10 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_235 <-R nonce;
            msg_236: blocksize <- concat1(Na_235, A);
            r_238 <-R seed;
            return(enc_r(msg_236, pkX, r_238));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_235, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_243 <-R seed;
            return(enc_r(msg_241, pkX, r_243));
            OAFinish() :=
            end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(pkB, h2[@ri_325], r_308[@ri_325]) && (pkX = pkB) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_235 <-R nonce;
            msg_236: blocksize <- concat1(Na_235, A);
            r_238 <-R seed;
            return(enc_r(msg_236, pkX, r_238));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_235, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_243 <-R seed;
            return(enc_r(msg_241, pkX, r_243));
            OAFinish() :=
            if defined(B) then
            event endA(A, hostX, Na_235, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_235 <-R nonce;
            msg_236: blocksize <- concat1(Na_235, A);
            r_238 <-R seed;
            return(enc_r(msg_236, pkX, r_238));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_235, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_235, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_243 <-R seed;
            return(enc_r(msg_241, pkX, r_243));
            OAFinish() :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          pkB: pkey <- pkgen(k_244);
          skB: skey <- skgen(k_244);
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          @20_m1_313: sblocksize <- concat3(pkY, hostY);
          find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_248 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_248);
            msg_249: blocksize <- concat2(Na_246, Nb_248, B);
            r_251 <-R seed;
            return(enc_r(msg_249, pkY, r_251));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_248)) = dec(m3, skB) in
            return();
            OBFinish() :=
            if defined(A) then
            event endB(hostY, B, Na_246, Nb_248)
          )
          orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = pkB) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_248 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_248);
            msg_249: blocksize <- concat2(Na_246, Nb_248, B);
            r_251 <-R seed;
            return(enc_r(msg_249, pkY, r_251));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_248)) = dec(m3, skB) in
            return();
            OBFinish() :=
            end
          )
          orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_248 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_248);
            msg_249: blocksize <- concat2(Na_246, Nb_248, B);
            r_251 <-R seed;
            return(enc_r(msg_249, pkY, r_251));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_248)) = dec(m3, skB) in
            return();
            OBFinish() :=
            end
          )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(B, pkB) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkB, h2);
            r_308 <-R sseed;
            return(pkB, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkA, pkB) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of useless
  - Rename variable Nb_248 into Nb_333, Nb_331, Nb_329
  - Rename variable r_251 into r_334, r_332, r_330
  - Rename variable Na_235 into Na_341, Na_338, Na_335
  - Rename variable r_238 into r_342, r_339, r_336
  - Rename variable r_243 into r_343, r_340, r_337
yields

Game 11 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_236: blocksize <- concat1(Na_335, A);
            r_336 <-R seed;
            return(enc_r(msg_236, pkX, r_336));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_337 <-R seed;
            return(enc_r(msg_241, pkX, r_337));
            OAFinish() :=
            end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(pkB, h2[@ri_325], r_308[@ri_325]) && (pkX = pkB) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            msg_236: blocksize <- concat1(Na_338, A);
            r_339 <-R seed;
            return(enc_r(msg_236, pkX, r_339));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_338, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_340 <-R seed;
            return(enc_r(msg_241, pkX, r_340));
            OAFinish() :=
            if defined(B) then
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_341 <-R nonce;
            msg_236: blocksize <- concat1(Na_341, A);
            r_342 <-R seed;
            return(enc_r(msg_236, pkX, r_342));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_341, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_343 <-R seed;
            return(enc_r(msg_241, pkX, r_343));
            OAFinish() :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          pkB: pkey <- pkgen(k_244);
          skB: skey <- skgen(k_244);
          return(pkB);
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          @20_m1_313: sblocksize <- concat3(pkY, hostY);
          find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_329 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_329);
            msg_249: blocksize <- concat2(Na_246, Nb_329, B);
            r_330 <-R seed;
            return(enc_r(msg_249, pkY, r_330));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_329)) = dec(m3, skB) in
            return();
            OBFinish() :=
            if defined(A) then
            event endB(hostY, B, Na_246, Nb_329)
          )
          orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = pkB) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_331 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_331);
            msg_249: blocksize <- concat2(Na_246, Nb_331, B);
            r_332 <-R seed;
            return(enc_r(msg_249, pkY, r_332));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_331)) = dec(m3, skB) in
            return();
            OBFinish() :=
            end
          )
          orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_333 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_333);
            msg_249: blocksize <- concat2(Na_246, Nb_333, B);
            r_334 <-R seed;
            return(enc_r(msg_249, pkY, r_334));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_333)) = dec(m3, skB) in
            return();
            OBFinish() :=
            end
          )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(B, pkB) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkB, h2);
            r_308 <-R sseed;
            return(pkB, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkA, pkB) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of binder pkB
  - Remove assignments on pkB (definition removed, all usages removed)
yields

Game 12 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_236: blocksize <- concat1(Na_335, A);
            r_336 <-R seed;
            return(enc_r(msg_236, pkX, r_336));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_337 <-R seed;
            return(enc_r(msg_241, pkX, r_337));
            OAFinish() :=
            end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_244, B, h2[@ri_325], r_308[@ri_325]) && (pkX = pkgen(k_244)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            msg_236: blocksize <- concat1(Na_338, A);
            r_339 <-R seed;
            return(enc_r(msg_236, pkX, r_339));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_338, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_340 <-R seed;
            return(enc_r(msg_241, pkX, r_340));
            OAFinish() :=
            if defined(B) then
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_341 <-R nonce;
            msg_236: blocksize <- concat1(Na_341, A);
            r_342 <-R seed;
            return(enc_r(msg_236, pkX, r_342));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_341, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_343 <-R seed;
            return(enc_r(msg_241, pkX, r_343));
            OAFinish() :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          skB: skey <- skgen(k_244);
          return(pkgen(k_244));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skB) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          @20_m1_313: sblocksize <- concat3(pkY, hostY);
          find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_329 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_329);
            msg_249: blocksize <- concat2(Na_246, Nb_329, B);
            r_330 <-R seed;
            return(enc_r(msg_249, pkY, r_330));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_329)) = dec(m3, skB) in
            return();
            OBFinish() :=
            if defined(A) then
            event endB(hostY, B, Na_246, Nb_329)
          )
          orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = pkgen(k_244)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_331 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_331);
            msg_249: blocksize <- concat2(Na_246, Nb_331, B);
            r_332 <-R seed;
            return(enc_r(msg_249, pkY, r_332));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_331)) = dec(m3, skB) in
            return();
            OBFinish() :=
            end
          )
          orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_333 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_333);
            msg_249: blocksize <- concat2(Na_246, Nb_333, B);
            r_334 <-R seed;
            return(enc_r(msg_249, pkY, r_334));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_333)) = dec(m3, skB) in
            return();
            OBFinish() :=
            end
          )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(k_244, B, B) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkgen(k_244), h2);
            r_308 <-R sseed;
            return(pkgen(k_244), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(k_244, B, A, B, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of binder skB
  - Remove assignments on skB (definition removed, all usages removed)
yields

Game 13 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_236: blocksize <- concat1(Na_335, A);
            r_336 <-R seed;
            return(enc_r(msg_236, pkX, r_336));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_337 <-R seed;
            return(enc_r(msg_241, pkX, r_337));
            OAFinish() :=
            end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_244, B, h2[@ri_325], r_308[@ri_325]) && (pkX = pkgen(k_244)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            msg_236: blocksize <- concat1(Na_338, A);
            r_339 <-R seed;
            return(enc_r(msg_236, pkX, r_339));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_338, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_340 <-R seed;
            return(enc_r(msg_241, pkX, r_340));
            OAFinish() :=
            if defined(B) then
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_341 <-R nonce;
            msg_236: blocksize <- concat1(Na_341, A);
            r_342 <-R seed;
            return(enc_r(msg_236, pkX, r_342));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_341, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_343 <-R seed;
            return(enc_r(msg_241, pkX, r_343));
            OAFinish() :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_244 <-R keyseed;
          return(pkgen(k_244));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          let injbot(concat1(Na_246: nonce, hostY: host)) = dec(m_245, skgen(k_244)) in
          return(B, hostY);
          OB9(pkY: pkey, =hostY, ms_247: signature) :=
          @20_m1_313: sblocksize <- concat3(pkY, hostY);
          find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_329 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_329);
            msg_249: blocksize <- concat2(Na_246, Nb_329, B);
            r_330 <-R seed;
            return(enc_r(msg_249, pkY, r_330));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_329)) = dec(m3, skgen(k_244)) in
            return();
            OBFinish() :=
            if defined(A) then
            event endB(hostY, B, Na_246, Nb_329)
          )
          orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = pkgen(k_244)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_331 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_331);
            msg_249: blocksize <- concat2(Na_246, Nb_331, B);
            r_332 <-R seed;
            return(enc_r(msg_249, pkY, r_332));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_331)) = dec(m3, skgen(k_244)) in
            return();
            OBFinish() :=
            end
          )
          orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
          (
            Nb_333 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_333);
            msg_249: blocksize <- concat2(Na_246, Nb_333, B);
            r_334 <-R seed;
            return(enc_r(msg_249, pkY, r_334));
            OB11(m3: bitstring) :=
            let injbot(pad(=Nb_333)) = dec(m3, skgen(k_244)) in
            return();
            OBFinish() :=
            end
          )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(k_244, B, B) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(pkgen(k_244), h2);
            r_308 <-R sseed;
            return(pkgen(k_244), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(k_244, B, A, B, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying equivalence ind_cca2(enc_r) with k_244, r_337, r_336, r_340, r_339, r_343, r_342, r_330, r_332, r_334 [probability 3. * N * Penc(time(context for game 13) + time + (-1. + 3. * N) * time(enc_r), 2. * N) + Penccoll]
  - Equivalence ind_cca2(enc_r) with k_244, r_332, r_330, r_342, r_343, r_339, r_340, r_336, r_337, r_334
  - Simplification pass
    - Replaced (@19_y_350 = @19_pkgen2(k_389)) with false at 4020
    - Remove branch 1 in find at 4019
    - Replaced (@19_y_345 = @19_pkgen2(k_389)) with false at 3941
    - Remove branch 1 in find at 3940
    - Replaced (@19_y_360 = @19_pkgen2(k_389)) with true at 4184
    - Replaced (@19_y_355 = @19_pkgen2(k_389)) with true at 4105
    - Replaced ((@19_y_375[@ri_452] = @19_pkgen2(k_389)) && (@19_m_393 = @19_m2_374[@ri_452])) with false at 3810
    - Remove branch 7 in find at 3698
    - Replaced ((@19_y_350[@ri_462] = @19_pkgen2(k_389)) && (@19_m_393 = @19_m2_349[@ri_462])) with false at 3720
    - Remove branch 2 in find at 3698
    - Replaced ((@19_y_345[@ri_464] = @19_pkgen2(k_389)) && (@19_m_393 = @19_m2_344[@ri_464])) with false at 3702
    - Remove branch 1 in find at 3698
    - Replaced (@19_y_375 = @19_pkgen2(k_389)) with false at 2263
    - Remove branch 1 in find at 2262
    - Replaced ((@19_y_375[@ri_398] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_374[@ri_398])) with false at 2154
    - Remove branch 7 in find at 2042
    - Replaced ((@19_y_350[@ri_408] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_349[@ri_408])) with false at 2064
    - Remove branch 2 in find at 2042
    - Replaced ((@19_y_345[@ri_410] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_344[@ri_410])) with false at 2046
    - Remove branch 1 in find at 2042
    - Replaced (@19_y_380 = @19_pkgen2(k_389)) with true at 2814
    - Replaced ((@19_y_375[@ri_416] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_374[@ri_416])) with false at 2705
    - Remove branch 7 in find at 2593
    - Replaced ((@19_y_350[@ri_426] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_349[@ri_426])) with false at 2615
    - Remove branch 2 in find at 2593
    - Replaced ((@19_y_345[@ri_428] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_344[@ri_428])) with false at 2597
    - Remove branch 1 in find at 2593
    - Replaced ((@19_y_375[@ri_434] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_374[@ri_434])) with false at 3260
    - Remove branch 7 in find at 3148
    - Replaced ((@19_y_350[@ri_444] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_349[@ri_444])) with false at 3170
    - Remove branch 2 in find at 3148
    - Replaced ((@19_y_345[@ri_446] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_344[@ri_446])) with false at 3152
    - Remove branch 1 in find at 3148
  - Expand if/find/let
yields

Game 14 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_236: blocksize <- concat1(Na_335, A);
            @19_r3_353 <-R seed;
            r_352 <-R seed;
            @19_x_351: blocksize <- msg_236;
            @19_y_350: pkey <- pkX;
            find             else
              return(enc_r(@19_x_351, @19_y_350, @19_r3_353));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_335, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_348 <-R seed;
              r_347 <-R seed;
              @19_x_346: blocksize <- msg_241;
              @19_y_345: pkey <- pkX;
              find               else
                return(enc_r(@19_x_346, @19_y_345, @19_r3_348));
                OAFinish() :=
                end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, k_244, B, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            msg_236: blocksize <- concat1(Na_338, A);
            @19_r3_363 <-R seed;
            r_362 <-R seed;
            @19_x_361: blocksize <- msg_236;
            @19_y_360: pkey <- pkX;
            if defined(k_389) then
            (
              @19_m2_359: bitstring <- @19_enc2(Z, @19_y_360, r_362);
              return(@19_m2_359);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_338, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_358 <-R seed;
              r_357 <-R seed;
              @19_x_356: blocksize <- msg_241;
              @19_y_355: pkey <- pkX;
              if defined(k_389) then
              (
                @19_m2_354: bitstring <- @19_enc2(Z, @19_y_355, r_357);
                return(@19_m2_354);
                OAFinish() :=
                if defined(B) then
                event endA(A, hostX, Na_338, Nb_240)
              )
              else
                return(enc_r(@19_x_356, @19_y_355, @19_r3_358));
                OAFinish() :=
                if defined(B) then
                event endA(A, hostX, Na_338, Nb_240)
            )
            else
              return(enc_r(@19_x_361, @19_y_360, @19_r3_363));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_338, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_358 <-R seed;
              r_357 <-R seed;
              @19_x_356: blocksize <- msg_241;
              @19_y_355: pkey <- pkX;
              if defined(k_389) then
              (
                @19_m2_354: bitstring <- @19_enc2(Z, @19_y_355, r_357);
                return(@19_m2_354);
                OAFinish() :=
                if defined(B) then
                event endA(A, hostX, Na_338, Nb_240)
              )
              else
                return(enc_r(@19_x_356, @19_y_355, @19_r3_358));
                OAFinish() :=
                if defined(B) then
                event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_341 <-R nonce;
            msg_236: blocksize <- concat1(Na_341, A);
            @19_r3_373 <-R seed;
            r_372 <-R seed;
            @19_x_371: blocksize <- msg_236;
            @19_y_370: pkey <- pkX;
            if defined(k_389) && (@19_y_370 = @19_pkgen2(k_389)) then
            (
              @19_m2_369: bitstring <- @19_enc2(Z, @19_y_370, r_372);
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
              r_367 <-R seed;
              @19_x_366: blocksize <- msg_241;
              @19_y_365: pkey <- pkX;
              if defined(k_389) && (@19_y_365 = @19_pkgen2(k_389)) then
              (
                @19_m2_364: bitstring <- @19_enc2(Z, @19_y_365, r_367);
                return(@19_m2_364);
                OAFinish() :=
                end
              )
              else
                return(enc_r(@19_x_366, @19_y_365, @19_r3_368));
                OAFinish() :=
                end
            )
            else
              return(enc_r(@19_x_371, @19_y_370, @19_r3_373));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
              r_367 <-R seed;
              @19_x_366: blocksize <- msg_241;
              @19_y_365: pkey <- pkX;
              if defined(k_389) && (@19_y_365 = @19_pkgen2(k_389)) then
              (
                @19_m2_364: bitstring <- @19_enc2(Z, @19_y_365, r_367);
                return(@19_m2_364);
                OAFinish() :=
                end
              )
              else
                return(enc_r(@19_x_366, @19_y_365, @19_r3_368));
                OAFinish() :=
                end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          k_244: keyseed <- cst_keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          @19_m_393: bitstring <- m_245;
          find           else
            find @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460], @19_y_355[@ri_460], @19_x_356[@ri_460]) && (@19_y_355[@ri_460] = @19_pkgen2(k_389)) && (@19_m_393 = @19_m2_354[@ri_460]) then
            (
   {642}      let injbot(concat1(Na_246: nonce, hostY: host)) = injbot(@19_x_356[@i_461]) in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                @19_x_376: blocksize <- msg_249;
                @19_y_375: pkey <- pkY;
                find                 else
                  return(enc_r(@19_x_376, @19_y_375, @19_r3_378));
                  OB11(m3: bitstring) :=
                  @19_m_390: bitstring <- m3;
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_354[@ri_406]) then
                    (
   {741}              let injbot(pad(=Nb_329)) = injbot(@19_x_356[@i_407]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404], @19_y_360[@ri_404], @19_x_361[@ri_404]) && (@19_y_360[@ri_404] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_359[@ri_404]) then
                    (
   {782}              let injbot(pad(=Nb_329)) = injbot(@19_x_361[@i_405]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_364[@ri_402]) then
                    (
   {823}              let injbot(pad(=Nb_329)) = injbot(@19_x_366[@i_403]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400], @19_y_370[@ri_400], @19_x_371[@ri_400]) && (@19_y_370[@ri_400] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_369[@ri_400]) then
                    (
   {864}              let injbot(pad(=Nb_329)) = injbot(@19_x_371[@i_401]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_379[@ri_396]) then
                    (
   {905}              let injbot(pad(=Nb_329)) = injbot(@19_x_381[@i_397]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_384[@ri_394]) then
                    (
   {946}              let injbot(pad(=Nb_329)) = injbot(@19_x_386[@i_395]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(@19_m_390, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, @19_y_380, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {1087}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {1114}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {1141}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {1168}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {1195}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {1222}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_381, @19_y_380, @19_r3_383));
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {1281}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {1308}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {1335}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {1362}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {1389}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {1416}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (@19_y_385 = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, @19_y_385, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {1536}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {1563}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {1590}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {1617}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {1644}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {1671}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_386, @19_y_385, @19_r3_388));
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {1730}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {1757}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {1784}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {1811}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {1838}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {1865}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], @19_y_360[@ri_458], @19_x_361[@ri_458]) && (@19_y_360[@ri_458] = @19_pkgen2(k_389)) && (@19_m_393 = @19_m2_359[@ri_458]) then
            (
  {1913}      let injbot(concat1(Na_246: nonce, hostY: host)) = injbot(@19_x_361[@i_459]) in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                @19_x_376: blocksize <- msg_249;
                @19_y_375: pkey <- pkY;
                find                 else
                  return(enc_r(@19_x_376, @19_y_375, @19_r3_378));
                  OB11(m3: bitstring) :=
                  @19_m_390: bitstring <- m3;
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_354[@ri_406]) then
                    (
  {2012}              let injbot(pad(=Nb_329)) = injbot(@19_x_356[@i_407]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404], @19_y_360[@ri_404], @19_x_361[@ri_404]) && (@19_y_360[@ri_404] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_359[@ri_404]) then
                    (
  {2053}              let injbot(pad(=Nb_329)) = injbot(@19_x_361[@i_405]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_364[@ri_402]) then
                    (
  {2094}              let injbot(pad(=Nb_329)) = injbot(@19_x_366[@i_403]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400], @19_y_370[@ri_400], @19_x_371[@ri_400]) && (@19_y_370[@ri_400] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_369[@ri_400]) then
                    (
  {2135}              let injbot(pad(=Nb_329)) = injbot(@19_x_371[@i_401]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_379[@ri_396]) then
                    (
  {2176}              let injbot(pad(=Nb_329)) = injbot(@19_x_381[@i_397]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_384[@ri_394]) then
                    (
  {2217}              let injbot(pad(=Nb_329)) = injbot(@19_x_386[@i_395]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(@19_m_390, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, @19_y_380, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {2358}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {2385}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {2412}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {2439}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {2466}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {2493}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_381, @19_y_380, @19_r3_383));
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {2552}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {2579}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {2606}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {2633}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {2660}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {2687}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (@19_y_385 = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, @19_y_385, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {2807}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {2834}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {2861}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {2888}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {2915}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {2942}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_386, @19_y_385, @19_r3_388));
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {3001}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {3028}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {3055}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {3082}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {3109}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {3136}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456], @19_y_365[@ri_456], @19_x_366[@ri_456]) && (@19_y_365[@ri_456] = @19_pkgen2(k_389)) && (@19_m_393 = @19_m2_364[@ri_456]) then
            (
  {3184}      let injbot(concat1(Na_246: nonce, hostY: host)) = injbot(@19_x_366[@i_457]) in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                @19_x_376: blocksize <- msg_249;
                @19_y_375: pkey <- pkY;
                find                 else
                  return(enc_r(@19_x_376, @19_y_375, @19_r3_378));
                  OB11(m3: bitstring) :=
                  @19_m_390: bitstring <- m3;
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_354[@ri_406]) then
                    (
  {3283}              let injbot(pad(=Nb_329)) = injbot(@19_x_356[@i_407]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404], @19_y_360[@ri_404], @19_x_361[@ri_404]) && (@19_y_360[@ri_404] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_359[@ri_404]) then
                    (
  {3324}              let injbot(pad(=Nb_329)) = injbot(@19_x_361[@i_405]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_364[@ri_402]) then
                    (
  {3365}              let injbot(pad(=Nb_329)) = injbot(@19_x_366[@i_403]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400], @19_y_370[@ri_400], @19_x_371[@ri_400]) && (@19_y_370[@ri_400] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_369[@ri_400]) then
                    (
  {3406}              let injbot(pad(=Nb_329)) = injbot(@19_x_371[@i_401]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_379[@ri_396]) then
                    (
  {3447}              let injbot(pad(=Nb_329)) = injbot(@19_x_381[@i_397]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_384[@ri_394]) then
                    (
  {3488}              let injbot(pad(=Nb_329)) = injbot(@19_x_386[@i_395]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(@19_m_390, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, @19_y_380, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {3629}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {3656}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {3683}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {3710}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {3737}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {3764}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_381, @19_y_380, @19_r3_383));
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {3823}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {3850}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {3877}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {3904}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {3931}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {3958}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (@19_y_385 = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, @19_y_385, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {4078}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {4105}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {4132}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {4159}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {4186}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {4213}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_386, @19_y_385, @19_r3_388));
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {4272}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {4299}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {4326}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {4353}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {4380}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {4407}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], @19_y_370[@ri_454], @19_x_371[@ri_454]) && (@19_y_370[@ri_454] = @19_pkgen2(k_389)) && (@19_m_393 = @19_m2_369[@ri_454]) then
            (
  {4455}      let injbot(concat1(Na_246: nonce, hostY: host)) = injbot(@19_x_371[@i_455]) in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                @19_x_376: blocksize <- msg_249;
                @19_y_375: pkey <- pkY;
                find                 else
                  return(enc_r(@19_x_376, @19_y_375, @19_r3_378));
                  OB11(m3: bitstring) :=
                  @19_m_390: bitstring <- m3;
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_354[@ri_406]) then
                    (
  {4554}              let injbot(pad(=Nb_329)) = injbot(@19_x_356[@i_407]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404], @19_y_360[@ri_404], @19_x_361[@ri_404]) && (@19_y_360[@ri_404] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_359[@ri_404]) then
                    (
  {4595}              let injbot(pad(=Nb_329)) = injbot(@19_x_361[@i_405]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_364[@ri_402]) then
                    (
  {4636}              let injbot(pad(=Nb_329)) = injbot(@19_x_366[@i_403]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400], @19_y_370[@ri_400], @19_x_371[@ri_400]) && (@19_y_370[@ri_400] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_369[@ri_400]) then
                    (
  {4677}              let injbot(pad(=Nb_329)) = injbot(@19_x_371[@i_401]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_379[@ri_396]) then
                    (
  {4718}              let injbot(pad(=Nb_329)) = injbot(@19_x_381[@i_397]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_384[@ri_394]) then
                    (
  {4759}              let injbot(pad(=Nb_329)) = injbot(@19_x_386[@i_395]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(@19_m_390, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, @19_y_380, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {4900}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {4927}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {4954}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {4981}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {5008}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {5035}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_381, @19_y_380, @19_r3_383));
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {5094}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {5121}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {5148}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {5175}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {5202}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {5229}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (@19_y_385 = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, @19_y_385, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {5349}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {5376}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {5403}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {5430}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {5457}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {5484}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_386, @19_y_385, @19_r3_388));
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {5543}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {5570}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {5597}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {5624}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {5651}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {5678}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450], @19_y_380[@ri_450], @19_x_381[@ri_450]) && (@19_y_380[@ri_450] = @19_pkgen2(k_389)) && (@19_m_393 = @19_m2_379[@ri_450]) then
            (
  {5726}      let injbot(concat1(Na_246: nonce, hostY: host)) = injbot(@19_x_381[@i_451]) in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                @19_x_376: blocksize <- msg_249;
                @19_y_375: pkey <- pkY;
                find                 else
                  return(enc_r(@19_x_376, @19_y_375, @19_r3_378));
                  OB11(m3: bitstring) :=
                  @19_m_390: bitstring <- m3;
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_354[@ri_406]) then
                    (
  {5825}              let injbot(pad(=Nb_329)) = injbot(@19_x_356[@i_407]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404], @19_y_360[@ri_404], @19_x_361[@ri_404]) && (@19_y_360[@ri_404] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_359[@ri_404]) then
                    (
  {5866}              let injbot(pad(=Nb_329)) = injbot(@19_x_361[@i_405]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_364[@ri_402]) then
                    (
  {5907}              let injbot(pad(=Nb_329)) = injbot(@19_x_366[@i_403]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400], @19_y_370[@ri_400], @19_x_371[@ri_400]) && (@19_y_370[@ri_400] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_369[@ri_400]) then
                    (
  {5948}              let injbot(pad(=Nb_329)) = injbot(@19_x_371[@i_401]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_379[@ri_396]) then
                    (
  {5989}              let injbot(pad(=Nb_329)) = injbot(@19_x_381[@i_397]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_384[@ri_394]) then
                    (
  {6030}              let injbot(pad(=Nb_329)) = injbot(@19_x_386[@i_395]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(@19_m_390, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, @19_y_380, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {6171}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {6198}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {6225}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {6252}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {6279}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {6306}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_381, @19_y_380, @19_r3_383));
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {6365}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {6392}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {6419}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {6446}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {6473}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {6500}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (@19_y_385 = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, @19_y_385, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {6620}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {6647}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {6674}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {6701}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {6728}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {6755}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_386, @19_y_385, @19_r3_388));
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {6814}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {6841}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {6868}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {6895}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {6922}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {6949}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            orfind @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448], @19_y_385[@ri_448], @19_x_386[@ri_448]) && (@19_y_385[@ri_448] = @19_pkgen2(k_389)) && (@19_m_393 = @19_m2_384[@ri_448]) then
            (
  {6997}      let injbot(concat1(Na_246: nonce, hostY: host)) = injbot(@19_x_386[@i_449]) in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                @19_x_376: blocksize <- msg_249;
                @19_y_375: pkey <- pkY;
                find                 else
                  return(enc_r(@19_x_376, @19_y_375, @19_r3_378));
                  OB11(m3: bitstring) :=
                  @19_m_390: bitstring <- m3;
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_354[@ri_406]) then
                    (
  {7096}              let injbot(pad(=Nb_329)) = injbot(@19_x_356[@i_407]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404], @19_y_360[@ri_404], @19_x_361[@ri_404]) && (@19_y_360[@ri_404] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_359[@ri_404]) then
                    (
  {7137}              let injbot(pad(=Nb_329)) = injbot(@19_x_361[@i_405]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_364[@ri_402]) then
                    (
  {7178}              let injbot(pad(=Nb_329)) = injbot(@19_x_366[@i_403]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400], @19_y_370[@ri_400], @19_x_371[@ri_400]) && (@19_y_370[@ri_400] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_369[@ri_400]) then
                    (
  {7219}              let injbot(pad(=Nb_329)) = injbot(@19_x_371[@i_401]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_379[@ri_396]) then
                    (
  {7260}              let injbot(pad(=Nb_329)) = injbot(@19_x_381[@i_397]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_384[@ri_394]) then
                    (
  {7301}              let injbot(pad(=Nb_329)) = injbot(@19_x_386[@i_395]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(@19_m_390, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, @19_y_380, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {7442}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {7469}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {7496}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {7523}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {7550}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {7577}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_381, @19_y_380, @19_r3_383));
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {7636}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {7663}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {7690}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {7717}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {7744}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {7771}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (@19_y_385 = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, @19_y_385, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {7891}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {7918}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {7945}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {7972}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {7999}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {8026}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_386, @19_y_385, @19_r3_388));
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {8085}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {8112}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {8139}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {8166}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {8193}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {8220}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            else
              let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(@19_m_393, @19_skgen2(k_389)) in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                @19_x_376: blocksize <- msg_249;
                @19_y_375: pkey <- pkY;
                find                 else
                  return(enc_r(@19_x_376, @19_y_375, @19_r3_378));
                  OB11(m3: bitstring) :=
                  @19_m_390: bitstring <- m3;
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_354[@ri_406]) then
                    (
  {8354}              let injbot(pad(=Nb_329)) = injbot(@19_x_356[@i_407]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404], @19_y_360[@ri_404], @19_x_361[@ri_404]) && (@19_y_360[@ri_404] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_359[@ri_404]) then
                    (
  {8395}              let injbot(pad(=Nb_329)) = injbot(@19_x_361[@i_405]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_364[@ri_402]) then
                    (
  {8436}              let injbot(pad(=Nb_329)) = injbot(@19_x_366[@i_403]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400], @19_y_370[@ri_400], @19_x_371[@ri_400]) && (@19_y_370[@ri_400] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_369[@ri_400]) then
                    (
  {8477}              let injbot(pad(=Nb_329)) = injbot(@19_x_371[@i_401]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_379[@ri_396]) then
                    (
  {8518}              let injbot(pad(=Nb_329)) = injbot(@19_x_381[@i_397]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (@19_m_390 = @19_m2_384[@ri_394]) then
                    (
  {8559}              let injbot(pad(=Nb_329)) = injbot(@19_x_386[@i_395]) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(@19_m_390, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, @19_y_380, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {8700}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {8727}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {8754}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {8781}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {8808}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {8835}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_381, @19_y_380, @19_r3_383));
                  OB11(m3: bitstring) :=
                  @19_m_391: bitstring <- m3;
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_354[@ri_424]) then
                    (
  {8894}              let injbot(pad(=Nb_331)) = injbot(@19_x_356[@i_425]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422], @19_y_360[@ri_422], @19_x_361[@ri_422]) && (@19_y_360[@ri_422] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_359[@ri_422]) then
                    (
  {8921}              let injbot(pad(=Nb_331)) = injbot(@19_x_361[@i_423]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_364[@ri_420]) then
                    (
  {8948}              let injbot(pad(=Nb_331)) = injbot(@19_x_366[@i_421]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418], @19_y_370[@ri_418], @19_x_371[@ri_418]) && (@19_y_370[@ri_418] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_369[@ri_418]) then
                    (
  {8975}              let injbot(pad(=Nb_331)) = injbot(@19_x_371[@i_419]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_379[@ri_414]) then
                    (
  {9002}              let injbot(pad(=Nb_331)) = injbot(@19_x_381[@i_415]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (@19_m_391 = @19_m2_384[@ri_412]) then
                    (
  {9029}              let injbot(pad(=Nb_331)) = injbot(@19_x_386[@i_413]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(@19_m_391, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (@19_y_385 = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, @19_y_385, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {9149}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {9176}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {9203}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {9230}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {9257}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {9284}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(@19_x_386, @19_y_385, @19_r3_388));
                  OB11(m3: bitstring) :=
                  @19_m_392: bitstring <- m3;
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_354[@ri_442]) then
                    (
  {9343}              let injbot(pad(=Nb_333)) = injbot(@19_x_356[@i_443]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440], @19_y_360[@ri_440], @19_x_361[@ri_440]) && (@19_y_360[@ri_440] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_359[@ri_440]) then
                    (
  {9370}              let injbot(pad(=Nb_333)) = injbot(@19_x_361[@i_441]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_364[@ri_438]) then
                    (
  {9397}              let injbot(pad(=Nb_333)) = injbot(@19_x_366[@i_439]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436], @19_y_370[@ri_436], @19_x_371[@ri_436]) && (@19_y_370[@ri_436] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_369[@ri_436]) then
                    (
  {9424}              let injbot(pad(=Nb_333)) = injbot(@19_x_371[@i_437]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_379[@ri_432]) then
                    (
  {9451}              let injbot(pad(=Nb_333)) = injbot(@19_x_381[@i_433]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (@19_m_392 = @19_m2_384[@ri_430]) then
                    (
  {9478}              let injbot(pad(=Nb_333)) = injbot(@19_x_386[@i_431]) in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(@19_m_392, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(k_389, k_244, B, B) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(k_389, k_244, B, A, B, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of useless
  - Remove assignments on k_244 (definition removed, all usages removed)
  - Remove assignments on @19_m_393 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_329)) at 8354 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 8395 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 8436 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 8477 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 8518 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 8559 (tuple expanded)
  - Remove assignments on @19_m_390 (definition removed, all usages removed)
  - Remove assignments on @19_y_375 (definition removed, all usages removed)
  - Remove assignments on @19_x_376 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 8894 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 8921 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 8948 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 8975 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 9002 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 9029 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 8700 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 8727 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 8754 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 8781 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 8808 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 8835 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Remove assignments on @19_y_380 (definition kept, array references kept)
  - Remove assignments on @19_x_381 (definition kept, array references kept)
  - Simplify pattern injbot(pad(=Nb_333)) at 9343 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 9370 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 9397 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 9424 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 9451 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 9478 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_333)) at 9149 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 9176 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 9203 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 9230 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 9257 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 9284 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Remove assignments on @19_y_385 (definition kept, array references kept)
  - Remove assignments on @19_x_386 (definition kept, array references kept)
  - Simplify pattern injbot(pad(=Nb_329)) at 741 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 782 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 823 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 864 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 905 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 946 (tuple expanded)
  - Remove assignments on @19_m_390 (definition removed, all usages removed)
  - Remove assignments on @19_y_375 (definition removed, all usages removed)
  - Remove assignments on @19_x_376 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 1281 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 1308 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 1335 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 1362 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 1389 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 1416 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 1087 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 1114 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 1141 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 1168 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 1195 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 1222 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Remove assignments on @19_y_380 (definition kept, array references kept)
  - Remove assignments on @19_x_381 (definition kept, array references kept)
  - Simplify pattern injbot(pad(=Nb_333)) at 1730 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 1757 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 1784 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 1811 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 1838 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 1865 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_333)) at 1536 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 1563 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 1590 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 1617 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 1644 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 1671 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Remove assignments on @19_y_385 (definition kept, array references kept)
  - Remove assignments on @19_x_386 (definition kept, array references kept)
  - Simplify pattern injbot(concat1(Na_246: nonce, hostY: host)) at 642 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 2012 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 2053 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 2094 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 2135 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 2176 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 2217 (tuple expanded)
  - Remove assignments on @19_m_390 (definition removed, all usages removed)
  - Remove assignments on @19_y_375 (definition removed, all usages removed)
  - Remove assignments on @19_x_376 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 2552 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 2579 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 2606 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 2633 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 2660 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 2687 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 2358 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 2385 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 2412 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 2439 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 2466 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 2493 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Remove assignments on @19_y_380 (definition kept, array references kept)
  - Remove assignments on @19_x_381 (definition kept, array references kept)
  - Simplify pattern injbot(pad(=Nb_333)) at 3001 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 3028 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 3055 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 3082 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 3109 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 3136 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_333)) at 2807 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 2834 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 2861 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 2888 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 2915 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 2942 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Remove assignments on @19_y_385 (definition kept, array references kept)
  - Remove assignments on @19_x_386 (definition kept, array references kept)
  - Simplify pattern injbot(concat1(Na_246: nonce, hostY: host)) at 1913 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 3283 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 3324 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 3365 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 3406 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 3447 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 3488 (tuple expanded)
  - Remove assignments on @19_m_390 (definition removed, all usages removed)
  - Remove assignments on @19_y_375 (definition removed, all usages removed)
  - Remove assignments on @19_x_376 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 3823 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 3850 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 3877 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 3904 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 3931 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 3958 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 3629 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 3656 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 3683 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 3710 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 3737 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 3764 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Remove assignments on @19_y_380 (definition kept, array references kept)
  - Remove assignments on @19_x_381 (definition kept, array references kept)
  - Simplify pattern injbot(pad(=Nb_333)) at 4272 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 4299 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 4326 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 4353 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 4380 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 4407 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_333)) at 4078 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 4105 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 4132 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 4159 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 4186 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 4213 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Remove assignments on @19_y_385 (definition kept, array references kept)
  - Remove assignments on @19_x_386 (definition kept, array references kept)
  - Simplify pattern injbot(concat1(Na_246: nonce, hostY: host)) at 3184 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 4554 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 4595 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 4636 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 4677 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 4718 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 4759 (tuple expanded)
  - Remove assignments on @19_m_390 (definition removed, all usages removed)
  - Remove assignments on @19_y_375 (definition removed, all usages removed)
  - Remove assignments on @19_x_376 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 5094 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 5121 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 5148 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 5175 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 5202 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 5229 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 4900 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 4927 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 4954 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 4981 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 5008 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 5035 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Remove assignments on @19_y_380 (definition kept, array references kept)
  - Remove assignments on @19_x_381 (definition kept, array references kept)
  - Simplify pattern injbot(pad(=Nb_333)) at 5543 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 5570 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 5597 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 5624 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 5651 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 5678 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_333)) at 5349 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 5376 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 5403 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 5430 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 5457 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 5484 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Remove assignments on @19_y_385 (definition kept, array references kept)
  - Remove assignments on @19_x_386 (definition kept, array references kept)
  - Simplify pattern injbot(concat1(Na_246: nonce, hostY: host)) at 4455 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 5825 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 5866 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 5907 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 5948 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 5989 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 6030 (tuple expanded)
  - Remove assignments on @19_m_390 (definition removed, all usages removed)
  - Remove assignments on @19_y_375 (definition removed, all usages removed)
  - Remove assignments on @19_x_376 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 6365 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 6392 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 6419 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 6446 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 6473 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 6500 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 6171 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 6198 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 6225 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 6252 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 6279 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 6306 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Remove assignments on @19_y_380 (definition kept, array references kept)
  - Remove assignments on @19_x_381 (definition kept, array references kept)
  - Simplify pattern injbot(pad(=Nb_333)) at 6814 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 6841 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 6868 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 6895 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 6922 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 6949 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_333)) at 6620 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 6647 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 6674 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 6701 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 6728 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 6755 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Remove assignments on @19_y_385 (definition kept, array references kept)
  - Remove assignments on @19_x_386 (definition kept, array references kept)
  - Simplify pattern injbot(concat1(Na_246: nonce, hostY: host)) at 5726 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 7096 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 7137 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 7178 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 7219 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 7260 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_329)) at 7301 (tuple expanded)
  - Remove assignments on @19_m_390 (definition removed, all usages removed)
  - Remove assignments on @19_y_375 (definition removed, all usages removed)
  - Remove assignments on @19_x_376 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 7636 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 7663 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 7690 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 7717 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 7744 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 7771 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_331)) at 7442 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 7469 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 7496 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 7523 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 7550 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_331)) at 7577 (tuple expanded)
  - Remove assignments on @19_m_391 (definition removed, all usages removed)
  - Remove assignments on @19_y_380 (definition kept, array references kept)
  - Remove assignments on @19_x_381 (definition kept, array references kept)
  - Simplify pattern injbot(pad(=Nb_333)) at 8085 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 8112 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 8139 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 8166 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 8193 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 8220 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Simplify pattern injbot(pad(=Nb_333)) at 7891 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 7918 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 7945 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 7972 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 7999 (tuple expanded)
  - Simplify pattern injbot(pad(=Nb_333)) at 8026 (tuple expanded)
  - Remove assignments on @19_m_392 (definition removed, all usages removed)
  - Remove assignments on @19_y_385 (definition kept, array references kept)
  - Remove assignments on @19_x_386 (definition kept, array references kept)
  - Simplify pattern injbot(concat1(Na_246: nonce, hostY: host)) at 6997 (tuple expanded)
  - Remove assignments on @19_x_351 (definition removed, all usages removed)
  - Remove assignments on @19_y_350 (definition removed, all usages removed)
  - Remove assignments on @19_x_346 (definition removed, all usages removed)
  - Remove assignments on @19_y_345 (definition removed, all usages removed)
  - Remove assignments on @19_x_361 (definition removed, all usages removed)
  - Remove assignments on @19_y_360 (definition removed, all usages removed)
  - Remove assignments on @19_y_355 (definition kept, array references kept)
  - Remove assignments on @19_x_356 (definition kept, array references kept)
  - Remove assignments on @19_y_355 (definition kept, array references kept)
  - Remove assignments on @19_x_356 (definition kept, array references kept)
  - Remove assignments on @19_x_371 (definition removed, all usages removed)
  - Remove assignments on @19_y_370 (definition removed, all usages removed)
  - Remove assignments on @19_y_365 (definition kept, array references kept)
  - Remove assignments on @19_x_366 (definition kept, array references kept)
  - Remove assignments on @19_y_365 (definition kept, array references kept)
  - Remove assignments on @19_x_366 (definition kept, array references kept)
yields

Game 15 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
    {43}  find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_236: blocksize <- concat1(Na_335, A);
            @19_r3_353 <-R seed;
    {71}    r_352 <-R seed;
            find             else
              return(enc_r(msg_236, pkX, @19_r3_353));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_335, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_348 <-R seed;
   {109}      r_347 <-R seed;
              find               else
                return(enc_r(msg_241, pkX, @19_r3_348));
                OAFinish() :=
                end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, B, B, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            msg_236: blocksize <- concat1(Na_338, A);
   {153}    @19_r3_363 <-R seed;
            r_362 <-R seed;
   {155}    if defined(k_389) then
            (
              @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
              return(@19_m2_359);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_338, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
   {194}      @19_r3_358 <-R seed;
              r_357 <-R seed;
              @19_x_356: blocksize <- msg_241;
              @19_y_355: pkey <- pkX;
   {202}      if defined(k_389) then
              (
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
   {217}        if defined(B) then
                event endA(A, hostX, Na_338, Nb_240)
              )
              else
                return(enc_r(msg_241, pkX, @19_r3_358));
                OAFinish() :=
                if defined(B) then
                event endA(A, hostX, Na_338, Nb_240)
            )
            else
              return(enc_r(msg_236, pkX, @19_r3_363));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_338, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_358 <-R seed;
              r_357 <-R seed;
              @19_x_356: blocksize <- msg_241;
              @19_y_355: pkey <- pkX;
              if defined(k_389) then
              (
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                if defined(B) then
                event endA(A, hostX, Na_338, Nb_240)
              )
              else
                return(enc_r(msg_241, pkX, @19_r3_358));
                OAFinish() :=
                if defined(B) then
                event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_341 <-R nonce;
            msg_236: blocksize <- concat1(Na_341, A);
            @19_r3_373 <-R seed;
            r_372 <-R seed;
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
   {444}      @19_r3_368 <-R seed;
              r_367 <-R seed;
              @19_x_366: blocksize <- msg_241;
              @19_y_365: pkey <- pkX;
   {452}      if defined(k_389) && {453}(pkX = @19_pkgen2(k_389)) then
              (
                @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                return(@19_m2_364);
                OAFinish() :=
                end
              )
              else
                return(enc_r(msg_241, pkX, @19_r3_368));
                OAFinish() :=
                end
            )
            else
              return(enc_r(msg_236, pkX, @19_r3_373));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
   {526}      r_367 <-R seed;
              @19_x_366: blocksize <- msg_241;
              @19_y_365: pkey <- pkX;
   {533}      if defined(k_389) && {534}(pkX = @19_pkgen2(k_389)) then
              (
                @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                return(@19_m2_364);
                OAFinish() :=
                end
              )
              else
                return(enc_r(msg_241, pkX, @19_r3_368));
                OAFinish() :=
                end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find           else
   {590}    find @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460], @19_y_355[@ri_460], @19_x_356[@ri_460]) && (@19_y_355[@ri_460] = @19_pkgen2(k_389)) && (m_245 = @19_m2_354[@ri_460]) then
            (
   {605}      let concat1(Na_246: nonce, hostY: host) = {606}@19_x_356[@i_461] in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                find                 else
                  return(enc_r(msg_249, pkY, @19_r3_378));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_406]) then
                    (
                      let pad(=Nb_329) = @19_x_356[@i_407] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(pkX[@ri_404], msg_236[@ri_404], Na_338[@ri_404], Na_338[@ri_404], @19_m2_359[@ri_404]) && (pkX[@ri_404] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_404]) then
                    (
                      let pad(=Nb_329) = msg_236[@i_405] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_402]) then
                    (
                      let pad(=Nb_329) = @19_x_366[@i_403] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(pkX[@ri_400], msg_236[@ri_400], Na_341[@ri_400], Na_341[@ri_400], @19_m2_369[@ri_400]) && (pkX[@ri_400] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_400]) then
                    (
                      let pad(=Nb_329) = msg_236[@i_401] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_396]) then
                    (
                      let pad(=Nb_329) = @19_x_381[@i_397] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_394]) then
                    (
                      let pad(=Nb_329) = @19_x_386[@i_395] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_383));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (pkY = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_388));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            orfind @i_459 = @ri_458 <= N suchthat defined(pkX[@ri_458], msg_236[@ri_458], Na_338[@ri_458], Na_338[@ri_458], @19_m2_359[@ri_458]) && (pkX[@ri_458] = @19_pkgen2(k_389)) && (m_245 = @19_m2_359[@ri_458]) then
            (
  {1839}      let concat1(Na_246: nonce, hostY: host) = {1840}msg_236[@i_459] in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
  {1858}      find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
  {1899}        r_377 <-R seed;
                find                 else
                  return(enc_r(msg_249, pkY, @19_r3_378));
                  OB11(m3: bitstring) :=
                  find                   else
  {1913}            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_406]) then
                    (
  {1928}              let pad(=Nb_329) = {1931}@19_x_356[@i_407] in
                      return();
                      OBFinish() :=
  {1938}              if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(pkX[@ri_404], msg_236[@ri_404], Na_338[@ri_404], Na_338[@ri_404], @19_m2_359[@ri_404]) && (pkX[@ri_404] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_404]) then
                    (
  {1970}              let pad(=Nb_329) = {1973}msg_236[@i_405] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_402]) then
                    (
  {2010}              let pad(=Nb_329) = {2013}@19_x_366[@i_403] in
                      return();
                      OBFinish() :=
  {2020}              if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(pkX[@ri_400], msg_236[@ri_400], Na_341[@ri_400], Na_341[@ri_400], @19_m2_369[@ri_400]) && (pkX[@ri_400] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_400]) then
                    (
  {2052}              let pad(=Nb_329) = {2055}msg_236[@i_401] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_396]) then
                    (
  {2092}              let pad(=Nb_329) = {2095}@19_x_381[@i_397] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_394]) then
                    (
  {2132}              let pad(=Nb_329) = {2135}@19_x_386[@i_395] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
  {2170}              if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_383));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (pkY = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_388));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456], @19_y_365[@ri_456], @19_x_366[@ri_456]) && (@19_y_365[@ri_456] = @19_pkgen2(k_389)) && (m_245 = @19_m2_364[@ri_456]) then
            (
  {3071}      let concat1(Na_246: nonce, hostY: host) = {3072}@19_x_366[@i_457] in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                find                 else
                  return(enc_r(msg_249, pkY, @19_r3_378));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_406]) then
                    (
                      let pad(=Nb_329) = @19_x_356[@i_407] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(pkX[@ri_404], msg_236[@ri_404], Na_338[@ri_404], Na_338[@ri_404], @19_m2_359[@ri_404]) && (pkX[@ri_404] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_404]) then
                    (
                      let pad(=Nb_329) = msg_236[@i_405] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_402]) then
                    (
                      let pad(=Nb_329) = @19_x_366[@i_403] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(pkX[@ri_400], msg_236[@ri_400], Na_341[@ri_400], Na_341[@ri_400], @19_m2_369[@ri_400]) && (pkX[@ri_400] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_400]) then
                    (
                      let pad(=Nb_329) = msg_236[@i_401] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_396]) then
                    (
                      let pad(=Nb_329) = @19_x_381[@i_397] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_394]) then
                    (
                      let pad(=Nb_329) = @19_x_386[@i_395] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_383));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (pkY = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_388));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            orfind @i_455 = @ri_454 <= N suchthat defined(pkX[@ri_454], msg_236[@ri_454], Na_341[@ri_454], Na_341[@ri_454], @19_m2_369[@ri_454]) && (pkX[@ri_454] = @19_pkgen2(k_389)) && (m_245 = @19_m2_369[@ri_454]) then
            (
  {4305}      let concat1(Na_246: nonce, hostY: host) = {4306}msg_236[@i_455] in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
  {4324}      find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
  {4365}        r_377 <-R seed;
                find                 else
                  return(enc_r(msg_249, pkY, @19_r3_378));
                  OB11(m3: bitstring) :=
                  find                   else
  {4379}            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_406]) then
                    (
  {4394}              let pad(=Nb_329) = {4397}@19_x_356[@i_407] in
                      return();
                      OBFinish() :=
  {4404}              if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(pkX[@ri_404], msg_236[@ri_404], Na_338[@ri_404], Na_338[@ri_404], @19_m2_359[@ri_404]) && (pkX[@ri_404] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_404]) then
                    (
  {4436}              let pad(=Nb_329) = {4439}msg_236[@i_405] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_402]) then
                    (
  {4476}              let pad(=Nb_329) = {4479}@19_x_366[@i_403] in
                      return();
                      OBFinish() :=
  {4486}              if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(pkX[@ri_400], msg_236[@ri_400], Na_341[@ri_400], Na_341[@ri_400], @19_m2_369[@ri_400]) && (pkX[@ri_400] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_400]) then
                    (
  {4518}              let pad(=Nb_329) = {4521}msg_236[@i_401] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_396]) then
                    (
  {4558}              let pad(=Nb_329) = {4561}@19_x_381[@i_397] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_394]) then
                    (
  {4598}              let pad(=Nb_329) = {4601}@19_x_386[@i_395] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
  {4636}              if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_383));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (pkY = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_388));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450], @19_y_380[@ri_450], @19_x_381[@ri_450]) && (@19_y_380[@ri_450] = @19_pkgen2(k_389)) && (m_245 = @19_m2_379[@ri_450]) then
            (
  {5537}      let concat1(Na_246: nonce, hostY: host) = {5538}@19_x_381[@i_451] in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                find                 else
                  return(enc_r(msg_249, pkY, @19_r3_378));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_406]) then
                    (
                      let pad(=Nb_329) = @19_x_356[@i_407] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(pkX[@ri_404], msg_236[@ri_404], Na_338[@ri_404], Na_338[@ri_404], @19_m2_359[@ri_404]) && (pkX[@ri_404] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_404]) then
                    (
                      let pad(=Nb_329) = msg_236[@i_405] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_402]) then
                    (
                      let pad(=Nb_329) = @19_x_366[@i_403] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(pkX[@ri_400], msg_236[@ri_400], Na_341[@ri_400], Na_341[@ri_400], @19_m2_369[@ri_400]) && (pkX[@ri_400] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_400]) then
                    (
                      let pad(=Nb_329) = msg_236[@i_401] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_396]) then
                    (
                      let pad(=Nb_329) = @19_x_381[@i_397] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_394]) then
                    (
                      let pad(=Nb_329) = @19_x_386[@i_395] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_383));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (pkY = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_388));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            orfind @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448], @19_y_385[@ri_448], @19_x_386[@ri_448]) && (@19_y_385[@ri_448] = @19_pkgen2(k_389)) && (m_245 = @19_m2_384[@ri_448]) then
            (
  {6769}      let concat1(Na_246: nonce, hostY: host) = {6770}@19_x_386[@i_449] in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
                r_377 <-R seed;
                find                 else
                  return(enc_r(msg_249, pkY, @19_r3_378));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_406]) then
                    (
                      let pad(=Nb_329) = @19_x_356[@i_407] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(pkX[@ri_404], msg_236[@ri_404], Na_338[@ri_404], Na_338[@ri_404], @19_m2_359[@ri_404]) && (pkX[@ri_404] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_404]) then
                    (
                      let pad(=Nb_329) = msg_236[@i_405] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_402]) then
                    (
                      let pad(=Nb_329) = @19_x_366[@i_403] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(pkX[@ri_400], msg_236[@ri_400], Na_341[@ri_400], Na_341[@ri_400], @19_m2_369[@ri_400]) && (pkX[@ri_400] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_400]) then
                    (
                      let pad(=Nb_329) = msg_236[@i_401] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_396]) then
                    (
                      let pad(=Nb_329) = @19_x_381[@i_397] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_394]) then
                    (
                      let pad(=Nb_329) = @19_x_386[@i_395] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
                @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
                if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_383));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
                if defined(k_389) && (pkY = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_388));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
                      let pad(=Nb_333) = @19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
                      let pad(=Nb_333) = @19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
                      let pad(=Nb_333) = msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
                      let pad(=Nb_333) = @19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
                      let pad(=Nb_333) = @19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
            )
            else
              let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
              return(B, hostY);
              OB9(pkY: pkey, =hostY, ms_247: signature) :=
              @20_m1_313: sblocksize <- concat3(pkY, hostY);
              find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_329 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_329);
                msg_249: blocksize <- concat2(Na_246, Nb_329, B);
                @19_r3_378 <-R seed;
  {8049}        r_377 <-R seed;
                find                 else
                  return(enc_r(msg_249, pkY, @19_r3_378));
                  OB11(m3: bitstring) :=
                  find                   else
  {8063}            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406]) && (@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_406]) then
                    (
  {8078}              let pad(=Nb_329) = {8081}@19_x_356[@i_407] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_405 = @ri_404 <= N suchthat defined(pkX[@ri_404], msg_236[@ri_404], Na_338[@ri_404], Na_338[@ri_404], @19_m2_359[@ri_404]) && (pkX[@ri_404] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_404]) then
                    (
  {8120}              let pad(=Nb_329) = {8123}msg_236[@i_405] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402]) && (@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_402]) then
                    (
  {8160}              let pad(=Nb_329) = {8163}@19_x_366[@i_403] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_401 = @ri_400 <= N suchthat defined(pkX[@ri_400], msg_236[@ri_400], Na_341[@ri_400], Na_341[@ri_400], @19_m2_369[@ri_400]) && (pkX[@ri_400] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_400]) then
                    (
  {8202}              let pad(=Nb_329) = {8205}msg_236[@i_401] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396]) && (@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_396]) then
                    (
  {8242}              let pad(=Nb_329) = {8245}@19_x_381[@i_397] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394]) && (@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_394]) then
                    (
  {8282}              let pad(=Nb_329) = {8285}@19_x_386[@i_395] in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
                    )
                    else
                      let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      if defined(A) then
                      event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_331 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_331);
                msg_249: blocksize <- concat2(Na_246, Nb_331, B);
  {8377}        @19_r3_383 <-R seed;
                r_382 <-R seed;
                @19_x_381: blocksize <- msg_249;
                @19_y_380: pkey <- pkY;
  {8385}        if defined(k_389) then
                (
                  @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
                  return(@19_m2_379);
                  OB11(m3: bitstring) :=
                  find                   else
  {8401}            find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
  {8416}              let pad(=Nb_331) = {8419}@19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
  {8444}              let pad(=Nb_331) = {8447}msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
  {8470}              let pad(=Nb_331) = {8473}@19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
  {8498}              let pad(=Nb_331) = {8501}msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
  {8524}              let pad(=Nb_331) = {8527}@19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
  {8550}              let pad(=Nb_331) = {8553}@19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_383));
                  OB11(m3: bitstring) :=
                  find                   else
                    find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424]) && (@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424]) then
                    (
                      let pad(=Nb_331) = @19_x_356[@i_425] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_423 = @ri_422 <= N suchthat defined(pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422]) && (pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_423] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420]) && (@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420]) then
                    (
                      let pad(=Nb_331) = @19_x_366[@i_421] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_419 = @ri_418 <= N suchthat defined(pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418]) && (pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418]) then
                    (
                      let pad(=Nb_331) = msg_236[@i_419] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414]) && (@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414]) then
                    (
                      let pad(=Nb_331) = @19_x_381[@i_415] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412]) && (@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412]) then
                    (
                      let pad(=Nb_331) = @19_x_386[@i_413] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
              orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
              (
                Nb_333 <-R nonce;
                event beginB(hostY, B, Na_246, Nb_333);
                msg_249: blocksize <- concat2(Na_246, Nb_333, B);
                @19_r3_388 <-R seed;
                r_387 <-R seed;
                @19_x_386: blocksize <- msg_249;
                @19_y_385: pkey <- pkY;
  {8818}        if defined(k_389) && (pkY = @19_pkgen2(k_389)) then
                (
                  @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                  return(@19_m2_384);
                  OB11(m3: bitstring) :=
                  find                   else
  {8838}            find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
  {8853}              let pad(=Nb_333) = {8856}@19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
  {8881}              let pad(=Nb_333) = {8884}msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
  {8907}              let pad(=Nb_333) = {8910}@19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
  {8935}              let pad(=Nb_333) = {8938}msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
  {8961}              let pad(=Nb_333) = {8964}@19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
  {8987}              let pad(=Nb_333) = {8990}@19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
                )
                else
                  return(enc_r(msg_249, pkY, @19_r3_388));
                  OB11(m3: bitstring) :=
                  find                   else
  {9026}            find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442]) && (@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442]) then
                    (
  {9041}              let pad(=Nb_333) = {9044}@19_x_356[@i_443] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_441 = @ri_440 <= N suchthat defined(pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440]) && (pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440]) then
                    (
  {9069}              let pad(=Nb_333) = {9072}msg_236[@i_441] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438]) && (@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438]) then
                    (
  {9095}              let pad(=Nb_333) = {9098}@19_x_366[@i_439] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_437 = @ri_436 <= N suchthat defined(pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436]) && (pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436]) then
                    (
  {9123}              let pad(=Nb_333) = {9126}msg_236[@i_437] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432]) && (@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432]) then
                    (
  {9149}              let pad(=Nb_333) = {9152}@19_x_381[@i_433] in
                      return();
                      OBFinish() :=
                      end
                    )
                    orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430]) && (@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430]) then
                    (
  {9175}              let pad(=Nb_333) = {9178}@19_x_386[@i_431] in
                      return();
                      OBFinish() :=
                      end
                    )
                    else
                      let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                      return();
                      OBFinish() :=
                      end
              )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
  {9211}  find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(k_389, B, B, B) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
  {9298}  if defined(k_389, B, B, A, B, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying simplify
  - Simplification pass
    - Replaced defined condition k_389, B, B, A, B, pkA with k_389, pkA, B, A in find at 9298
    - Replaced defined condition k_389, B, B, B with k_389, B in find at 9211
    - Transformed find at 8818 into a test
    - Replaced ((@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430])) with (m3 = @19_m2_384[@ri_430]) at 24147
    - Replaced @19_x_386[@i_431] with concat2(Na_246[@i_431], Nb_333[@i_431], B) at 9178
    - Remove let at 9175
    - Replaced defined condition @19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430] with @19_m2_384[@ri_430] in find at 9026
    - Replaced ((@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432])) with (m3 = @19_m2_379[@ri_432]) at 24158
    - Replaced @19_x_381[@i_433] with concat2(Na_246[@i_433], Nb_331[@i_433], B) at 9152
    - Remove let at 9149
    - Replaced defined condition @19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432] with @19_m2_379[@ri_432] in find at 9026
    - Replaced ((pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436])) with (m3 = @19_m2_369[@ri_436]) at 24169
    - Replaced msg_236[@i_437] with concat1(Na_341[@i_437], A) at 9126
    - Remove let at 9123
    - Replaced defined condition pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436] with @19_m2_369[@ri_436] in find at 9026
    - Replaced ((@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438])) with (m3 = @19_m2_364[@ri_438]) at 24180
    - Replaced @19_x_366[@i_439] with pad(Nb_240[@i_439]) at 9098
    - Simplify pattern =Nb_333 at 27071 (equality test)
    - Simplify pattern pad(=Nb_333) at 9095 (tuple expanded)
    - Replaced defined condition @19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438] with Nb_240[@ri_438], @19_m2_364[@ri_438] in find at 9026
    - Replaced ((pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440])) with (m3 = @19_m2_359[@ri_440]) at 24191
    - Replaced msg_236[@i_441] with concat1(Na_338[@i_441], A) at 9072
    - Remove let at 9069
    - Replaced defined condition pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440] with @19_m2_359[@ri_440] in find at 9026
    - Replaced ((@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442])) with (m3 = @19_m2_354[@ri_442]) at 24202
    - Replaced @19_x_356[@i_443] with pad(Nb_240[@i_443]) at 9044
    - Simplify pattern =Nb_333 at 27793 (equality test)
    - Simplify pattern pad(=Nb_333) at 9041 (tuple expanded)
    - Replaced defined condition @19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442] with Nb_240[@ri_442], @19_m2_354[@ri_442] in find at 9026
    - Replaced ((@19_y_385[@ri_430] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_430])) with (m3 = @19_m2_384[@ri_430]) at 27881
    - Replaced @19_x_386[@i_431] with concat2(Na_246[@i_431], Nb_333[@i_431], B) at 8990
    - Remove let at 8987
    - Replaced defined condition @19_m2_384[@ri_430], @19_y_385[@ri_430], @19_x_386[@ri_430] with @19_m2_384[@ri_430] in find at 8838
    - Replaced ((@19_y_380[@ri_432] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_432])) with (m3 = @19_m2_379[@ri_432]) at 27892
    - Replaced @19_x_381[@i_433] with concat2(Na_246[@i_433], Nb_331[@i_433], B) at 8964
    - Remove let at 8961
    - Replaced defined condition @19_m2_379[@ri_432], @19_y_380[@ri_432], @19_x_381[@ri_432] with @19_m2_379[@ri_432] in find at 8838
    - Replaced ((pkX[@ri_436] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_436])) with (m3 = @19_m2_369[@ri_436]) at 27903
    - Replaced msg_236[@i_437] with concat1(Na_341[@i_437], A) at 8938
    - Remove let at 8935
    - Replaced defined condition pkX[@ri_436], msg_236[@ri_436], Na_341[@ri_436], Na_341[@ri_436], @19_m2_369[@ri_436] with @19_m2_369[@ri_436] in find at 8838
    - Replaced ((@19_y_365[@ri_438] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_438])) with (m3 = @19_m2_364[@ri_438]) at 27914
    - Replaced @19_x_366[@i_439] with pad(Nb_240[@i_439]) at 8910
    - Simplify pattern =Nb_333 at 30061 (equality test)
    - Simplify pattern pad(=Nb_333) at 8907 (tuple expanded)
    - Replaced defined condition @19_m2_364[@ri_438], @19_y_365[@ri_438], @19_x_366[@ri_438] with Nb_240[@ri_438], @19_m2_364[@ri_438] in find at 8838
    - Replaced ((pkX[@ri_440] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_440])) with (m3 = @19_m2_359[@ri_440]) at 27925
    - Replaced msg_236[@i_441] with concat1(Na_338[@i_441], A) at 8884
    - Remove let at 8881
    - Replaced defined condition pkX[@ri_440], msg_236[@ri_440], Na_338[@ri_440], Na_338[@ri_440], @19_m2_359[@ri_440] with @19_m2_359[@ri_440] in find at 8838
    - Replaced ((@19_y_355[@ri_442] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_442])) with (m3 = @19_m2_354[@ri_442]) at 27936
    - Replaced @19_x_356[@i_443] with pad(Nb_240[@i_443]) at 8856
    - Simplify pattern =Nb_333 at 30703 (equality test)
    - Simplify pattern pad(=Nb_333) at 8853 (tuple expanded)
    - Replaced defined condition @19_m2_354[@ri_442], @19_y_355[@ri_442], @19_x_356[@ri_442] with Nb_240[@ri_442], @19_m2_354[@ri_442] in find at 8838
    - Transformed find at 8385 into a test
    - Test at 8385 always true
    - Replaced ((@19_y_385[@ri_412] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_412])) with (m3 = @19_m2_384[@ri_412]) at 30945
    - Replaced @19_x_386[@i_413] with concat2(Na_246[@i_413], Nb_333[@i_413], B) at 8553
    - Remove let at 8550
    - Replaced defined condition @19_m2_384[@ri_412], @19_y_385[@ri_412], @19_x_386[@ri_412] with @19_m2_384[@ri_412] in find at 8401
    - Replaced ((@19_y_380[@ri_414] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_414])) with (m3 = @19_m2_379[@ri_414]) at 30956
    - Replaced @19_x_381[@i_415] with concat2(Na_246[@i_415], Nb_331[@i_415], B) at 8527
    - Remove let at 8524
    - Replaced defined condition @19_m2_379[@ri_414], @19_y_380[@ri_414], @19_x_381[@ri_414] with @19_m2_379[@ri_414] in find at 8401
    - Replaced ((pkX[@ri_418] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_418])) with (m3 = @19_m2_369[@ri_418]) at 30967
    - Replaced msg_236[@i_419] with concat1(Na_341[@i_419], A) at 8501
    - Remove let at 8498
    - Replaced defined condition pkX[@ri_418], msg_236[@ri_418], Na_341[@ri_418], Na_341[@ri_418], @19_m2_369[@ri_418] with @19_m2_369[@ri_418] in find at 8401
    - Replaced ((@19_y_365[@ri_420] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_420])) with (m3 = @19_m2_364[@ri_420]) at 30978
    - Replaced @19_x_366[@i_421] with pad(Nb_240[@i_421]) at 8473
    - Simplify pattern =Nb_331 at 33512 (equality test)
    - Simplify pattern pad(=Nb_331) at 8470 (tuple expanded)
    - Replaced defined condition @19_m2_364[@ri_420], @19_y_365[@ri_420], @19_x_366[@ri_420] with Nb_240[@ri_420], @19_m2_364[@ri_420] in find at 8401
    - Replaced ((pkX[@ri_422] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_422])) with (m3 = @19_m2_359[@ri_422]) at 30989
    - Replaced msg_236[@i_423] with concat1(Na_338[@i_423], A) at 8447
    - Remove let at 8444
    - Replaced defined condition pkX[@ri_422], msg_236[@ri_422], Na_338[@ri_422], Na_338[@ri_422], @19_m2_359[@ri_422] with @19_m2_359[@ri_422] in find at 8401
    - Replaced ((@19_y_355[@ri_424] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_424])) with (m3 = @19_m2_354[@ri_424]) at 31000
    - Replaced @19_x_356[@i_425] with pad(Nb_240[@i_425]) at 8419
    - Simplify pattern =Nb_331 at 34142 (equality test)
    - Simplify pattern pad(=Nb_331) at 8416 (tuple expanded)
    - Replaced defined condition @19_m2_354[@ri_424], @19_y_355[@ri_424], @19_x_356[@ri_424] with Nb_240[@ri_424], @19_m2_354[@ri_424] in find at 8401
    - Replaced ((@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_394])) with (m3 = @19_m2_384[@ri_394]) at 34338
    - Replaced @19_x_386[@i_395] with concat2(Na_246[@i_395], Nb_333[@i_395], B) at 8285
    - Remove let at 8282
    - Replaced defined condition @19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394] with @19_m2_384[@ri_394] in find at 8063
    - Replaced ((@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_396])) with (m3 = @19_m2_379[@ri_396]) at 34349
    - Replaced @19_x_381[@i_397] with concat2(Na_246[@i_397], Nb_331[@i_397], B) at 8245
    - Remove let at 8242
    - Replaced defined condition @19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396] with @19_m2_379[@ri_396] in find at 8063
    - Replaced ((pkX[@ri_400] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_400])) with (m3 = @19_m2_369[@ri_400]) at 34360
    - Replaced msg_236[@i_401] with concat1(Na_341[@i_401], A) at 8205
    - Remove let at 8202
    - Replaced defined condition pkX[@ri_400], msg_236[@ri_400], Na_341[@ri_400], Na_341[@ri_400], @19_m2_369[@ri_400] with @19_m2_369[@ri_400] in find at 8063
    - Replaced ((@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_402])) with (m3 = @19_m2_364[@ri_402]) at 34371
    - Replaced @19_x_366[@i_403] with pad(Nb_240[@i_403]) at 8163
    - Simplify pattern =Nb_329 at 36831 (equality test)
    - Simplify pattern pad(=Nb_329) at 8160 (tuple expanded)
    - Replaced defined condition @19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402] with Nb_240[@ri_402], @19_m2_364[@ri_402] in find at 8063
    - Replaced ((pkX[@ri_404] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_404])) with (m3 = @19_m2_359[@ri_404]) at 34382
    - Replaced msg_236[@i_405] with concat1(Na_338[@i_405], A) at 8123
    - Remove let at 8120
    - Replaced defined condition pkX[@ri_404], msg_236[@ri_404], Na_338[@ri_404], Na_338[@ri_404], @19_m2_359[@ri_404] with @19_m2_359[@ri_404] in find at 8063
    - Replaced ((@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_406])) with (m3 = @19_m2_354[@ri_406]) at 34393
    - Replaced @19_x_356[@i_407] with pad(Nb_240[@i_407]) at 8081
    - Simplify pattern =Nb_329 at 37568 (equality test)
    - Simplify pattern pad(=Nb_329) at 8078 (tuple expanded)
    - Replaced defined condition @19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406] with Nb_240[@ri_406], @19_m2_354[@ri_406] in find at 8063
    - Remove random number generation at 8049
    - Replaced ((@19_y_385[@ri_448] = @19_pkgen2(k_389)) && (m_245 = @19_m2_384[@ri_448])) with (m_245 = @19_m2_384[@ri_448]) at 23270
    - Replaced @19_x_386[@i_449] with concat2(Na_246[@i_449], Nb_333[@i_449], B) at 6770
    - Remove let at 6769
    - Replaced defined condition @19_m2_384[@ri_448], @19_y_385[@ri_448], @19_x_386[@ri_448] with @19_m2_384[@ri_448] in find at 590
    - Replaced ((@19_y_380[@ri_450] = @19_pkgen2(k_389)) && (m_245 = @19_m2_379[@ri_450])) with (m_245 = @19_m2_379[@ri_450]) at 23277
    - Replaced @19_x_381[@i_451] with concat2(Na_246[@i_451], Nb_331[@i_451], B) at 5538
    - Remove let at 5537
    - Replaced defined condition @19_m2_379[@ri_450], @19_y_380[@ri_450], @19_x_381[@ri_450] with @19_m2_379[@ri_450] in find at 590
    - Replaced ((pkX[@ri_454] = @19_pkgen2(k_389)) && (m_245 = @19_m2_369[@ri_454])) with (m_245 = @19_m2_369[@ri_454]) at 23284
    - Replaced msg_236[@i_455] with concat1(Na_341[@i_455], A) at 4306
    - Replaced ((pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) with false at 38792
    - Remove branch 3 in find at 4324
    - Replaced ((pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) with false at 38799
    - Remove branch 2 in find at 4324
    - Replaced ((pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) with ((pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) at 38806
    - Replaced ((@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_394])) with (m3 = @19_m2_384[@ri_394]) at 39181
    - Replaced @19_x_386[@i_395] with concat2(Na_246[@i_395], Nb_333[@i_395], B) at 4601
    - Remove let at 4598
    - Replaced defined condition @19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394] with @19_m2_384[@ri_394] in find at 4379
    - Replaced ((@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_396])) with (m3 = @19_m2_379[@ri_396]) at 39192
    - Replaced @19_x_381[@i_397] with concat2(Na_246[@i_397], Nb_331[@i_397], B) at 4561
    - Remove let at 4558
    - Replaced defined condition @19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396] with @19_m2_379[@ri_396] in find at 4379
    - Replaced ((pkX[@ri_400] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_400])) with (m3 = @19_m2_369[@ri_400]) at 39203
    - Replaced msg_236[@i_401] with concat1(Na_341[@i_401], A) at 4521
    - Remove let at 4518
    - Replaced defined condition pkX[@ri_400], msg_236[@ri_400], Na_341[@ri_400], Na_341[@ri_400], @19_m2_369[@ri_400] with @19_m2_369[@ri_400] in find at 4379
    - Replaced ((@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_402])) with (m3 = @19_m2_364[@ri_402]) at 39214
    - Replaced @19_x_366[@i_403] with pad(Nb_240[@i_403]) at 4479
    - Simplify pattern =Nb_329 at 41459 (equality test)
    - Simplify pattern pad(=Nb_329) at 4476 (tuple expanded)
    - Replaced defined condition @19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402] with Nb_240[@ri_402], @19_m2_364[@ri_402] in find at 4379
    - Replaced ((pkX[@ri_404] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_404])) with (m3 = @19_m2_359[@ri_404]) at 39225
    - Replaced msg_236[@i_405] with concat1(Na_338[@i_405], A) at 4439
    - Remove let at 4436
    - Replaced defined condition pkX[@ri_404], msg_236[@ri_404], Na_338[@ri_404], Na_338[@ri_404], @19_m2_359[@ri_404] with @19_m2_359[@ri_404] in find at 4379
    - Replaced ((@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_406])) with (m3 = @19_m2_354[@ri_406]) at 39236
    - Replaced @19_x_356[@i_407] with pad(Nb_240[@i_407]) at 4397
    - Simplify pattern =Nb_329 at 42226 (equality test)
    - Simplify pattern pad(=Nb_329) at 4394 (tuple expanded)
    - Replaced defined condition @19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406] with Nb_240[@ri_406], @19_m2_354[@ri_406] in find at 4379
    - Remove random number generation at 4365
    - Replaced defined condition pkA, h2[@ri_321], r_307[@ri_321] with r_307[@ri_321], pkA in find at 4324
    - Simplify pattern concat1(Na_246: nonce, hostY: host) at 4305 (tuple expanded)
    - Replaced defined condition pkX[@ri_454], msg_236[@ri_454], Na_341[@ri_454], Na_341[@ri_454], @19_m2_369[@ri_454] with pkA, A, Na_341[@ri_454], @19_m2_369[@ri_454] in find at 590
    - Replaced ((@19_y_365[@ri_456] = @19_pkgen2(k_389)) && (m_245 = @19_m2_364[@ri_456])) with (m_245 = @19_m2_364[@ri_456]) at 23291
    - Replaced @19_x_366[@i_457] with pad(Nb_240[@i_457]) at 3072
    - Remove let at 3071
    - Replaced defined condition @19_m2_364[@ri_456], @19_y_365[@ri_456], @19_x_366[@ri_456] with @19_m2_364[@ri_456] in find at 590
    - Replaced ((pkX[@ri_458] = @19_pkgen2(k_389)) && (m_245 = @19_m2_359[@ri_458])) with (m_245 = @19_m2_359[@ri_458]) at 23298
    - Replaced msg_236[@i_459] with concat1(Na_338[@i_459], A) at 1840
    - Replaced ((pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) with false at 43135
    - Remove branch 3 in find at 1858
    - Replaced ((pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) with false at 43142
    - Remove branch 2 in find at 1858
    - Replaced ((pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) with ((pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247)) at 43149
    - Replaced ((@19_y_385[@ri_394] = @19_pkgen2(k_389)) && (m3 = @19_m2_384[@ri_394])) with (m3 = @19_m2_384[@ri_394]) at 43488
    - Replaced @19_x_386[@i_395] with concat2(Na_246[@i_395], Nb_333[@i_395], B) at 2135
    - Remove let at 2132
    - Replaced defined condition @19_m2_384[@ri_394], @19_y_385[@ri_394], @19_x_386[@ri_394] with @19_m2_384[@ri_394] in find at 1913
    - Replaced ((@19_y_380[@ri_396] = @19_pkgen2(k_389)) && (m3 = @19_m2_379[@ri_396])) with (m3 = @19_m2_379[@ri_396]) at 43499
    - Replaced @19_x_381[@i_397] with concat2(Na_246[@i_397], Nb_331[@i_397], B) at 2095
    - Remove let at 2092
    - Replaced defined condition @19_m2_379[@ri_396], @19_y_380[@ri_396], @19_x_381[@ri_396] with @19_m2_379[@ri_396] in find at 1913
    - Replaced ((pkX[@ri_400] = @19_pkgen2(k_389)) && (m3 = @19_m2_369[@ri_400])) with (m3 = @19_m2_369[@ri_400]) at 43510
    - Replaced msg_236[@i_401] with concat1(Na_341[@i_401], A) at 2055
    - Remove let at 2052
    - Replaced defined condition pkX[@ri_400], msg_236[@ri_400], Na_341[@ri_400], Na_341[@ri_400], @19_m2_369[@ri_400] with @19_m2_369[@ri_400] in find at 1913
    - Replaced ((@19_y_365[@ri_402] = @19_pkgen2(k_389)) && (m3 = @19_m2_364[@ri_402])) with (m3 = @19_m2_364[@ri_402]) at 43521
    - Replaced @19_x_366[@i_403] with pad(Nb_240[@i_403]) at 2013
    - Simplify pattern =Nb_329 at 45730 (equality test)
    - Simplify pattern pad(=Nb_329) at 2010 (tuple expanded)
    - Replaced defined condition @19_m2_364[@ri_402], @19_y_365[@ri_402], @19_x_366[@ri_402] with Nb_240[@ri_402], @19_m2_364[@ri_402] in find at 1913
    - Replaced ((pkX[@ri_404] = @19_pkgen2(k_389)) && (m3 = @19_m2_359[@ri_404])) with (m3 = @19_m2_359[@ri_404]) at 43532
    - Replaced msg_236[@i_405] with concat1(Na_338[@i_405], A) at 1973
    - Remove let at 1970
    - Replaced defined condition pkX[@ri_404], msg_236[@ri_404], Na_338[@ri_404], Na_338[@ri_404], @19_m2_359[@ri_404] with @19_m2_359[@ri_404] in find at 1913
    - Replaced ((@19_y_355[@ri_406] = @19_pkgen2(k_389)) && (m3 = @19_m2_354[@ri_406])) with (m3 = @19_m2_354[@ri_406]) at 43543
    - Replaced @19_x_356[@i_407] with pad(Nb_240[@i_407]) at 1931
    - Simplify pattern =Nb_329 at 46485 (equality test)
    - Simplify pattern pad(=Nb_329) at 1928 (tuple expanded)
    - Replaced defined condition @19_m2_354[@ri_406], @19_y_355[@ri_406], @19_x_356[@ri_406] with Nb_240[@ri_406], @19_m2_354[@ri_406] in find at 1913
    - Remove random number generation at 1899
    - Replaced defined condition pkA, h2[@ri_321], r_307[@ri_321] with r_307[@ri_321], pkA in find at 1858
    - Simplify pattern concat1(Na_246: nonce, hostY: host) at 1839 (tuple expanded)
    - Replaced defined condition pkX[@ri_458], msg_236[@ri_458], Na_338[@ri_458], Na_338[@ri_458], @19_m2_359[@ri_458] with pkA, A, Na_338[@ri_458], @19_m2_359[@ri_458] in find at 590
    - Replaced ((@19_y_355[@ri_460] = @19_pkgen2(k_389)) && (m_245 = @19_m2_354[@ri_460])) with (m_245 = @19_m2_354[@ri_460]) at 23305
    - Replaced @19_x_356[@i_461] with pad(Nb_240[@i_461]) at 606
    - Remove let at 605
    - Replaced defined condition @19_m2_354[@ri_460], @19_y_355[@ri_460], @19_x_356[@ri_460] with @19_m2_354[@ri_460] in find at 590
    - Replaced (pkX = @19_pkgen2(k_389)) with false at 534
    - Remove branch 1 in find at 533
    - Find at 533 removed (else branch kept if any)
    - Transformed find at 452 into a test
    - Replaced (pkX = @19_pkgen2(k_389)) with true at 453
    - Test at 452 always true
    - Transformed find at 155 into a test
    - Test at 155 always true
    - Transformed find at 202 into a test
    - Test at 202 always true
    - Transformed find at 217 into a test
    - Test at 217 always true
    - Replaced defined condition k_389, B, B, h2[@ri_325], r_308[@ri_325] with r_308[@ri_325], h2[@ri_325], k_389 in find at 43
    - Remove random number generation at 109
    - Remove random number generation at 71
  - Simplification pass
    - Remove random number generation at 8377
    - Transformed find at 4636 into a test
    - Test at 4636 always true
    - Transformed find at 4486 into a test
    - Test at 4486 always true
    - Transformed find at 4404 into a test
    - Test at 4404 always true
    - Replaced defined condition pkA, r_307[@ri_321] with r_307[@ri_321] in find at 4324
    - Transformed find at 2170 into a test
    - Test at 2170 always true
    - Transformed find at 2020 into a test
    - Test at 2020 always true
    - Transformed find at 1938 into a test
    - Test at 1938 always true
    - Replaced defined condition pkA, r_307[@ri_321] with r_307[@ri_321] in find at 1858
    - Remove random number generation at 526
    - Remove random number generation at 444
    - Remove random number generation at 194
    - Remove random number generation at 153
yields

Game 16 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_236: blocksize <- concat1(Na_335, A);
            @19_r3_353 <-R seed;
            return(enc_r(msg_236, pkX, @19_r3_353));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            @19_r3_348 <-R seed;
            return(enc_r(msg_241, pkX, @19_r3_348));
            OAFinish() :=
            end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            msg_236: blocksize <- concat1(Na_338, A);
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_338, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_357 <-R seed;
            @19_x_356: blocksize <- msg_241;
            @19_y_355: pkey <- pkX;
            @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
            return(@19_m2_354);
            OAFinish() :=
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_341 <-R nonce;
            msg_236: blocksize <- concat1(Na_341, A);
            @19_r3_373 <-R seed;
            r_372 <-R seed;
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              r_367 <-R seed;
              @19_x_366: blocksize <- msg_241;
              @19_y_365: pkey <- pkX;
              @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
              return(@19_m2_364);
              OAFinish() :=
              end
            )
            else
              return(enc_r(msg_236, pkX, @19_r3_373));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
              @19_x_366: blocksize <- msg_241;
              @19_y_365: pkey <- pkX;
              return(enc_r(msg_241, pkX, @19_r3_368));
              OAFinish() :=
              end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], Na_338[@ri_458], A, pkA) && (m_245 = @19_m2_359[@ri_458]) then
          (
            Na_246: nonce <- Na_338[@i_459];
            hostY: host <- A;
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_329 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_329);
            msg_249: blocksize <- concat2(Na_246, Nb_329, B);
            @19_r3_378 <-R seed;
            return(enc_r(msg_249, pkY, @19_r3_378));
            OB11(m3: bitstring) :=
            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_329 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_329 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
            )
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            else
              let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], Na_341[@ri_454], A, pkA) && (m_245 = @19_m2_369[@ri_454]) then
          (
            Na_246: nonce <- Na_341[@i_455];
            hostY: host <- A;
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_329 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_329);
            msg_249: blocksize <- concat2(Na_246, Nb_329, B);
            @19_r3_378 <-R seed;
            return(enc_r(msg_249, pkY, @19_r3_378));
            OB11(m3: bitstring) :=
            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_329 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_329 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
            )
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            else
              let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
          )
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_329 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_329);
              msg_249: blocksize <- concat2(Na_246, Nb_329, B);
              @19_r3_378 <-R seed;
              return(enc_r(msg_249, pkY, @19_r3_378));
              OB11(m3: bitstring) :=
              find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_329 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_329 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              else
                let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_329)
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              msg_249: blocksize <- concat2(Na_246, Nb_331, B);
              r_382 <-R seed;
              @19_x_381: blocksize <- msg_249;
              @19_y_380: pkey <- pkY;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], Nb_240[@ri_424]) && (m3 = @19_m2_354[@ri_424]) then
              (
                if (Nb_331 = Nb_240[@i_425]) then
                return();
                OBFinish() :=
                end
              )
              orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422]) && (m3 = @19_m2_359[@ri_422]) then
                end
              orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], Nb_240[@ri_420]) && (m3 = @19_m2_364[@ri_420]) then
              (
                if (Nb_331 = Nb_240[@i_421]) then
                return();
                OBFinish() :=
                end
              )
              orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418]) && (m3 = @19_m2_369[@ri_418]) then
                end
              orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414]) && (m3 = @19_m2_379[@ri_414]) then
                end
              orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412]) && (m3 = @19_m2_384[@ri_412]) then
                end
              else
                let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                end
            )
            orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              msg_249: blocksize <- concat2(Na_246, Nb_333, B);
              @19_r3_388 <-R seed;
              r_387 <-R seed;
              @19_x_386: blocksize <- msg_249;
              @19_y_385: pkey <- pkY;
              if (pkY = @19_pkgen2(k_389)) then
              (
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                return(enc_r(msg_249, pkY, @19_r3_388));
                OB11(m3: bitstring) :=
                find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, k_389, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying SA rename msg_236
  - Rename variable msg_236 into msg_468, msg_467, msg_466
yields

Game 17 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_353 <-R seed;
            return(enc_r(msg_466, pkX, @19_r3_353));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            @19_r3_348 <-R seed;
            return(enc_r(msg_241, pkX, @19_r3_348));
            OAFinish() :=
            end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            msg_467: blocksize <- concat1(Na_338, A);
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_338, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            r_357 <-R seed;
            @19_x_356: blocksize <- msg_241;
            @19_y_355: pkey <- pkX;
            @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
            return(@19_m2_354);
            OAFinish() :=
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_341 <-R nonce;
            msg_468: blocksize <- concat1(Na_341, A);
            @19_r3_373 <-R seed;
            r_372 <-R seed;
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              r_367 <-R seed;
              @19_x_366: blocksize <- msg_241;
              @19_y_365: pkey <- pkX;
              @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
              return(@19_m2_364);
              OAFinish() :=
              end
            )
            else
              return(enc_r(msg_468, pkX, @19_r3_373));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
              @19_x_366: blocksize <- msg_241;
              @19_y_365: pkey <- pkX;
              return(enc_r(msg_241, pkX, @19_r3_368));
              OAFinish() :=
              end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], Na_338[@ri_458], A, pkA) && (m_245 = @19_m2_359[@ri_458]) then
          (
            Na_246: nonce <- Na_338[@i_459];
            hostY: host <- A;
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_329 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_329);
            msg_249: blocksize <- concat2(Na_246, Nb_329, B);
            @19_r3_378 <-R seed;
            return(enc_r(msg_249, pkY, @19_r3_378));
            OB11(m3: bitstring) :=
            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_329 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_329 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
            )
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            else
              let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], Na_341[@ri_454], A, pkA) && (m_245 = @19_m2_369[@ri_454]) then
          (
            Na_246: nonce <- Na_341[@i_455];
            hostY: host <- A;
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_329 <-R nonce;
            event beginB(hostY, B, Na_246, Nb_329);
            msg_249: blocksize <- concat2(Na_246, Nb_329, B);
            @19_r3_378 <-R seed;
            return(enc_r(msg_249, pkY, @19_r3_378));
            OB11(m3: bitstring) :=
            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_329 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_329 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
            )
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            else
              let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(hostY, B, Na_246, Nb_329)
          )
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_329 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_329);
              msg_249: blocksize <- concat2(Na_246, Nb_329, B);
              @19_r3_378 <-R seed;
              return(enc_r(msg_249, pkY, @19_r3_378));
              OB11(m3: bitstring) :=
              find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_329 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_329 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_329)
              )
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              else
                let injbot(pad(=Nb_329)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_329)
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              msg_249: blocksize <- concat2(Na_246, Nb_331, B);
              r_382 <-R seed;
              @19_x_381: blocksize <- msg_249;
              @19_y_380: pkey <- pkY;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], Nb_240[@ri_424]) && (m3 = @19_m2_354[@ri_424]) then
              (
                if (Nb_331 = Nb_240[@i_425]) then
                return();
                OBFinish() :=
                end
              )
              orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422]) && (m3 = @19_m2_359[@ri_422]) then
                end
              orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], Nb_240[@ri_420]) && (m3 = @19_m2_364[@ri_420]) then
              (
                if (Nb_331 = Nb_240[@i_421]) then
                return();
                OBFinish() :=
                end
              )
              orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418]) && (m3 = @19_m2_369[@ri_418]) then
                end
              orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414]) && (m3 = @19_m2_379[@ri_414]) then
                end
              orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412]) && (m3 = @19_m2_384[@ri_412]) then
                end
              else
                let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                end
            )
            orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              msg_249: blocksize <- concat2(Na_246, Nb_333, B);
              @19_r3_388 <-R seed;
              r_387 <-R seed;
              @19_x_386: blocksize <- msg_249;
              @19_y_385: pkey <- pkY;
              if (pkY = @19_pkgen2(k_389)) then
              (
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                return(enc_r(msg_249, pkY, @19_r3_388));
                OB11(m3: bitstring) :=
                find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, k_389, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of useless
  - Remove assignments on @19_x_381 (definition removed, all usages removed)
  - Remove assignments on @19_y_380 (definition removed, all usages removed)
  - Remove assignments on @19_x_386 (definition removed, all usages removed)
  - Remove assignments on @19_y_385 (definition removed, all usages removed)
  - Remove assignments on hostY (definition removed, all usages removed)
  - Remove assignments on Na_246 (definition removed, all usages removed)
  - Remove assignments on hostY (definition removed, all usages removed)
  - Remove assignments on Na_246 (definition removed, all usages removed)
  - Remove assignments on msg_467 (definition removed, all usages removed)
  - Remove assignments on @19_x_356 (definition removed, all usages removed)
  - Remove assignments on @19_y_355 (definition removed, all usages removed)
  - Remove assignments on @19_x_366 (definition removed, all usages removed)
  - Remove assignments on @19_y_365 (definition removed, all usages removed)
  - Remove assignments on @19_x_366 (definition removed, all usages removed)
  - Remove assignments on @19_y_365 (definition removed, all usages removed)
  - Remove assignments on msg_249 (definition removed, all usages removed)
  - Remove assignments on msg_241 (definition removed, all usages removed)
  - Remove assignments on msg_241 (definition removed, all usages removed)
  - Rename variable Nb_329 into Nb_473, Nb_471, Nb_469
  - Rename variable @19_r3_378 into @19_r3_474, @19_r3_472, @19_r3_470
yields

Game 18 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_353 <-R seed;
            return(enc_r(msg_466, pkX, @19_r3_353));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            @19_r3_348 <-R seed;
            return(enc_r(msg_241, pkX, @19_r3_348));
            OAFinish() :=
            end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_338, Nb_240);
            r_357 <-R seed;
            @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
            return(@19_m2_354);
            OAFinish() :=
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_341 <-R nonce;
            msg_468: blocksize <- concat1(Na_341, A);
            @19_r3_373 <-R seed;
            r_372 <-R seed;
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              r_367 <-R seed;
              @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
              return(@19_m2_364);
              OAFinish() :=
              end
            )
            else
              return(enc_r(msg_468, pkX, @19_r3_373));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
              return(enc_r(msg_241, pkX, @19_r3_368));
              OAFinish() :=
              end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], Na_338[@ri_458], A, pkA) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            msg_249: blocksize <- concat2(Na_338[@i_459], Nb_471, B);
            @19_r3_472 <-R seed;
            return(enc_r(msg_249, pkY, @19_r3_472));
            OB11(m3: bitstring) :=
            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_471 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_471 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            else
              let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], Na_341[@ri_454], A, pkA) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            msg_249: blocksize <- concat2(Na_341[@i_455], Nb_473, B);
            @19_r3_474 <-R seed;
            return(enc_r(msg_249, pkY, @19_r3_474));
            OB11(m3: bitstring) :=
            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_473 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_473 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            else
              let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              msg_249: blocksize <- concat2(Na_246, Nb_469, B);
              @19_r3_470 <-R seed;
              return(enc_r(msg_249, pkY, @19_r3_470));
              OB11(m3: bitstring) :=
              find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_469 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_469 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              else
                let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              find @i_425 = @ri_424 <= N suchthat defined(@19_m2_354[@ri_424], Nb_240[@ri_424]) && (m3 = @19_m2_354[@ri_424]) then
              (
                if (Nb_331 = Nb_240[@i_425]) then
                return();
                OBFinish() :=
                end
              )
              orfind @i_423 = @ri_422 <= N suchthat defined(@19_m2_359[@ri_422]) && (m3 = @19_m2_359[@ri_422]) then
                end
              orfind @i_421 = @ri_420 <= N suchthat defined(@19_m2_364[@ri_420], Nb_240[@ri_420]) && (m3 = @19_m2_364[@ri_420]) then
              (
                if (Nb_331 = Nb_240[@i_421]) then
                return();
                OBFinish() :=
                end
              )
              orfind @i_419 = @ri_418 <= N suchthat defined(@19_m2_369[@ri_418]) && (m3 = @19_m2_369[@ri_418]) then
                end
              orfind @i_415 = @ri_414 <= N suchthat defined(@19_m2_379[@ri_414]) && (m3 = @19_m2_379[@ri_414]) then
                end
              orfind @i_413 = @ri_412 <= N suchthat defined(@19_m2_384[@ri_412]) && (m3 = @19_m2_384[@ri_412]) then
                end
              else
                let injbot(pad(=Nb_331)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                end
            )
            orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              msg_249: blocksize <- concat2(Na_246, Nb_333, B);
              @19_r3_388 <-R seed;
              r_387 <-R seed;
              if (pkY = @19_pkgen2(k_389)) then
              (
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                return(enc_r(msg_249, pkY, @19_r3_388));
                OB11(m3: bitstring) :=
                find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, k_389, pkA) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying simplify [probability 3. * N / |nonce|]
  - Global dependency analysis on Nb_331
  - Simplification pass
    - Merge all branches of find at 11636
yields

Game 19 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_341 <-R nonce;
            msg_468: blocksize <- concat1(Na_341, A);
            @19_r3_373 <-R seed;
            r_372 <-R seed;
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              r_367 <-R seed;
              @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
              return(@19_m2_364);
              OAFinish() :=
              end
            )
            else
              return(enc_r(msg_468, pkX, @19_r3_373));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
              return(enc_r(msg_241, pkX, @19_r3_368));
              OAFinish() :=
              end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_338, Nb_240);
            r_357 <-R seed;
            @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
            return(@19_m2_354);
            OAFinish() :=
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_353 <-R seed;
            return(enc_r(msg_466, pkX, @19_r3_353));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            @19_r3_348 <-R seed;
            return(enc_r(msg_241, pkX, @19_r3_348));
            OAFinish() :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], A, pkA, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            msg_249: blocksize <- concat2(Na_341[@i_455], Nb_473, B);
            @19_r3_474 <-R seed;
            return(enc_r(msg_249, pkY, @19_r3_474));
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_473 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_473 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            else
              let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], A, pkA, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            msg_249: blocksize <- concat2(Na_338[@i_459], Nb_471, B);
            @19_r3_472 <-R seed;
            return(enc_r(msg_249, pkY, @19_r3_472));
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_471 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_471 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            else
              let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              msg_249: blocksize <- concat2(Na_246, Nb_333, B);
              @19_r3_388 <-R seed;
              r_387 <-R seed;
              if (pkY = @19_pkgen2(k_389)) then
              (
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                return(enc_r(msg_249, pkY, @19_r3_388));
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              msg_249: blocksize <- concat2(Na_246, Nb_469, B);
              @19_r3_470 <-R seed;
              return(enc_r(msg_249, pkY, @19_r3_470));
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_469 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_469 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              else
                let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkA, k_389) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying SA rename msg_249
  - Rename variable msg_249 into msg_518, msg_517, msg_516, msg_515
yields

Game 20 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_341 <-R nonce;
            msg_468: blocksize <- concat1(Na_341, A);
            @19_r3_373 <-R seed;
            r_372 <-R seed;
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              r_367 <-R seed;
              @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
              return(@19_m2_364);
              OAFinish() :=
              end
            )
            else
              return(enc_r(msg_468, pkX, @19_r3_373));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
              return(enc_r(msg_241, pkX, @19_r3_368));
              OAFinish() :=
              end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_338, Nb_240);
            r_357 <-R seed;
            @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
            return(@19_m2_354);
            OAFinish() :=
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_353 <-R seed;
            return(enc_r(msg_466, pkX, @19_r3_353));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            @19_r3_348 <-R seed;
            return(enc_r(msg_241, pkX, @19_r3_348));
            OAFinish() :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], A, pkA, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            msg_515: blocksize <- concat2(Na_341[@i_455], Nb_473, B);
            @19_r3_474 <-R seed;
            return(enc_r(msg_515, pkY, @19_r3_474));
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_473 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_473 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            else
              let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], A, pkA, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            msg_516: blocksize <- concat2(Na_338[@i_459], Nb_471, B);
            @19_r3_472 <-R seed;
            return(enc_r(msg_516, pkY, @19_r3_472));
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_471 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_471 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            else
              let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              msg_517: blocksize <- concat2(Na_246, Nb_333, B);
              @19_r3_388 <-R seed;
              r_387 <-R seed;
              if (pkY = @19_pkgen2(k_389)) then
              (
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                return(enc_r(msg_517, pkY, @19_r3_388));
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              msg_518: blocksize <- concat2(Na_246, Nb_469, B);
              @19_r3_470 <-R seed;
              return(enc_r(msg_518, pkY, @19_r3_470));
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_469 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_469 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              else
                let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkA, k_389) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying move all binders
  - Move random number generation r_387
  - Move random number generation @19_r3_388
  - Move assignment to msg_517
  - Move random number generation r_372
  - Move random number generation @19_r3_373
  - Move assignment to msg_468
  - Move random number generation Na_341
yields

Game 21 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          pkA: pkey <- pkgen(k_233);
          skA: skey <- skgen(k_233);
          return(pkA);
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              r_372 <-R seed;
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              Na_341 <-R nonce;
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              r_367 <-R seed;
              @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
              return(@19_m2_364);
              OAFinish() :=
              end
            )
            else
              @19_r3_373 <-R seed;
              Na_341 <-R nonce;
              msg_468: blocksize <- concat1(Na_341, A);
              return(enc_r(msg_468, pkX, @19_r3_373));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
              return(enc_r(msg_241, pkX, @19_r3_368));
              OAFinish() :=
              end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_338, Nb_240);
            r_357 <-R seed;
            @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
            return(@19_m2_354);
            OAFinish() :=
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkA) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_353 <-R seed;
            return(enc_r(msg_466, pkX, @19_r3_353));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            @19_r3_348 <-R seed;
            return(enc_r(msg_241, pkX, @19_r3_348));
            OAFinish() :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], A, pkA, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            msg_515: blocksize <- concat2(Na_341[@i_455], Nb_473, B);
            @19_r3_474 <-R seed;
            return(enc_r(msg_515, pkY, @19_r3_474));
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_473 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_473 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            else
              let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], A, pkA, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkA) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            msg_516: blocksize <- concat2(Na_338[@i_459], Nb_471, B);
            @19_r3_472 <-R seed;
            return(enc_r(msg_516, pkY, @19_r3_472));
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_471 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_471 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            else
              let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              if (pkY = @19_pkgen2(k_389)) then
              (
                r_387 <-R seed;
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                @19_r3_388 <-R seed;
                msg_517: blocksize <- concat2(Na_246, Nb_333, B);
                return(enc_r(msg_517, pkY, @19_r3_388));
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_322 = @ri_321 <= N suchthat defined(pkA, h2[@ri_321], r_307[@ri_321]) && (pkY = pkA) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              msg_518: blocksize <- concat2(Na_246, Nb_469, B);
              @19_r3_470 <-R seed;
              return(enc_r(msg_518, pkY, @19_r3_470));
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_469 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_469 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              else
                let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind  suchthat defined(A, pkA) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkA, h2);
            r_307 <-R sseed;
            return(pkA, h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, pkA, k_389) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of binder pkA
  - Remove assignments on pkA (definition removed, all usages removed)
yields

Game 22 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          skA: skey <- skgen(k_233);
          return(pkgen(k_233));
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              r_372 <-R seed;
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              Na_341 <-R nonce;
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              r_367 <-R seed;
              @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
              return(@19_m2_364);
              OAFinish() :=
              end
            )
            else
              @19_r3_373 <-R seed;
              Na_341 <-R nonce;
              msg_468: blocksize <- concat1(Na_341, A);
              return(enc_r(msg_468, pkX, @19_r3_373));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
              return(enc_r(msg_241, pkX, @19_r3_368));
              OAFinish() :=
              end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_338, Nb_240);
            r_357 <-R seed;
            @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
            return(@19_m2_354);
            OAFinish() :=
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkgen(k_233)) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_353 <-R seed;
            return(enc_r(msg_466, pkX, @19_r3_353));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skA) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            @19_r3_348 <-R seed;
            return(enc_r(msg_241, pkX, @19_r3_348));
            OAFinish() :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(k_233, A, @19_m2_369[@ri_454], A, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkgen(k_233)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            msg_515: blocksize <- concat2(Na_341[@i_455], Nb_473, B);
            @19_r3_474 <-R seed;
            return(enc_r(msg_515, pkY, @19_r3_474));
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_473 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_473 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            else
              let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(k_233, A, @19_m2_359[@ri_458], A, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkgen(k_233)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            msg_516: blocksize <- concat2(Na_338[@i_459], Nb_471, B);
            @19_r3_472 <-R seed;
            return(enc_r(msg_516, pkY, @19_r3_472));
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_471 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_471 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            else
              let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              if (pkY = @19_pkgen2(k_389)) then
              (
                r_387 <-R seed;
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                @19_r3_388 <-R seed;
                msg_517: blocksize <- concat2(Na_246, Nb_333, B);
                return(enc_r(msg_517, pkY, @19_r3_388));
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_322 = @ri_321 <= N suchthat defined(k_233, A, h2[@ri_321], r_307[@ri_321]) && (pkY = pkgen(k_233)) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              msg_518: blocksize <- concat2(Na_246, Nb_469, B);
              @19_r3_470 <-R seed;
              return(enc_r(msg_518, pkY, @19_r3_470));
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_469 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_469 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              else
                let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind  suchthat defined(k_233, A, A) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkgen(k_233), h2);
            r_307 <-R sseed;
            return(pkgen(k_233), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(k_233, A, A, B, k_389) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of binder skA
  - Remove assignments on skA (definition removed, all usages removed)
yields

Game 23 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_233 <-R keyseed;
          return(pkgen(k_233));
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              r_372 <-R seed;
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              Na_341 <-R nonce;
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skgen(k_233)) in
              event beginA(A, hostX, Na_341, Nb_240);
              r_367 <-R seed;
              @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
              return(@19_m2_364);
              OAFinish() :=
              end
            )
            else
              @19_r3_373 <-R seed;
              Na_341 <-R nonce;
              msg_468: blocksize <- concat1(Na_341, A);
              return(enc_r(msg_468, pkX, @19_r3_373));
              OA5(m_239: bitstring) :=
              let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = dec(m_239, skgen(k_233)) in
              event beginA(A, hostX, Na_341, Nb_240);
              msg_241: blocksize <- pad(Nb_240);
              @19_r3_368 <-R seed;
              return(enc_r(msg_241, pkX, @19_r3_368));
              OAFinish() :=
              end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = dec(m_239, skgen(k_233)) in
            event beginA(A, hostX, Na_338, Nb_240);
            r_357 <-R seed;
            @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
            return(@19_m2_354);
            OAFinish() :=
            event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = pkgen(k_233)) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_353 <-R seed;
            return(enc_r(msg_466, pkX, @19_r3_353));
            OA5(m_239: bitstring) :=
            let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = dec(m_239, skgen(k_233)) in
            event beginA(A, hostX, Na_335, Nb_240);
            msg_241: blocksize <- pad(Nb_240);
            @19_r3_348 <-R seed;
            return(enc_r(msg_241, pkX, @19_r3_348));
            OAFinish() :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(k_233, A, @19_m2_369[@ri_454], A, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkgen(k_233)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            msg_515: blocksize <- concat2(Na_341[@i_455], Nb_473, B);
            @19_r3_474 <-R seed;
            return(enc_r(msg_515, pkY, @19_r3_474));
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_473 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_473 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            else
              let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(k_233, A, @19_m2_359[@ri_458], A, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = pkgen(k_233)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            msg_516: blocksize <- concat2(Na_338[@i_459], Nb_471, B);
            @19_r3_472 <-R seed;
            return(enc_r(msg_516, pkY, @19_r3_472));
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_471 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (Nb_471 = Nb_240[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            else
              let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              if (pkY = @19_pkgen2(k_389)) then
              (
                r_387 <-R seed;
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                @19_r3_388 <-R seed;
                msg_517: blocksize <- concat2(Na_246, Nb_333, B);
                return(enc_r(msg_517, pkY, @19_r3_388));
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_322 = @ri_321 <= N suchthat defined(k_233, A, h2[@ri_321], r_307[@ri_321]) && (pkY = pkgen(k_233)) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              msg_518: blocksize <- concat2(Na_246, Nb_469, B);
              @19_r3_470 <-R seed;
              return(enc_r(msg_518, pkY, @19_r3_470));
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_469 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_469 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
              )
              else
                let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                if defined(A) then
                event endB(hostY, B, Na_246, Nb_469)
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind  suchthat defined(k_233, A, A) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(pkgen(k_233), h2);
            r_307 <-R sseed;
            return(pkgen(k_233), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(k_233, A, A, B, k_389) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying equivalence ind_cca2(enc_r) with k_233, @19_r3_368, @19_r3_373, @19_r3_348, @19_r3_353, @19_r3_388, @19_r3_470, @19_r3_474, @19_r3_472 [probability 3. * N * Penc(time(context for game 23) + time + (-1. + 3. * N) * time(enc_r), N)]
  - Equivalence ind_cca2(enc_r) with k_233, @19_r3_474, @19_r3_470, @19_r3_388, @19_r3_353, @19_r3_348, @19_r3_373, @19_r3_368, @19_r3_472
  - Simplification pass
    - Replaced (@19_y_537 = @19_pkgen2(k_562)) with true at 6904
    - Replaced (@19_y_532 = @19_pkgen2(k_562)) with true at 6409
    - Replaced (@19_y_552 = @19_pkgen2(k_562)) with true at 4754
    - Replaced (@19_y_557 = @19_pkgen2(k_562)) with true at 4866
    - Replaced (@19_y_547 = @19_pkgen2(k_562)) with true at 4640
  - Expand if/find/let
yields

Game 24 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_562 <-R keyseed;
          k_233: keyseed <- cst_keyseed;
          return(@19_pkgen2(k_562));
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              r_372 <-R seed;
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              Na_341 <-R nonce;
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              @19_m_563: bitstring <- m_239;
              find               else
                find @i_597 = @ri_596 <= N suchthat defined(@19_m2_521[@ri_596], @19_y_522[@ri_596], @19_x_523[@ri_596]) && (@19_y_522[@ri_596] = @19_pkgen2(k_562)) && (@19_m_563 = @19_m2_521[@ri_596]) then
                (
   {105}          let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_523[@i_597]) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_595 = @ri_594 <= N suchthat defined(@19_m2_526[@ri_594], @19_y_527[@ri_594], @19_x_528[@ri_594]) && (@19_y_527[@ri_594] = @19_pkgen2(k_562)) && (@19_m_563 = @19_m2_526[@ri_594]) then
                (
   {156}          let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_528[@i_595]) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_593 = @ri_592 <= N suchthat defined(@19_m2_531[@ri_592], @19_y_532[@ri_592], @19_x_533[@ri_592]) && (@19_y_532[@ri_592] = @19_pkgen2(k_562)) && (@19_m_563 = @19_m2_531[@ri_592]) then
                (
   {207}          let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_533[@i_593]) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_591 = @ri_590 <= N suchthat defined(@19_m2_536[@ri_590], @19_y_537[@ri_590], @19_x_538[@ri_590]) && (@19_y_537[@ri_590] = @19_pkgen2(k_562)) && (@19_m_563 = @19_m2_536[@ri_590]) then
                (
   {258}          let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_538[@i_591]) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_589 = @ri_588 <= N suchthat defined(@19_m2_541[@ri_588], @19_y_542[@ri_588], @19_x_543[@ri_588]) && (@19_y_542[@ri_588] = @19_pkgen2(k_562)) && (@19_m_563 = @19_m2_541[@ri_588]) then
                (
   {309}          let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_543[@i_589]) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_587 = @ri_586 <= N suchthat defined(@19_m2_546[@ri_586], @19_y_547[@ri_586], @19_x_548[@ri_586]) && (@19_y_547[@ri_586] = @19_pkgen2(k_562)) && (@19_m_563 = @19_m2_546[@ri_586]) then
                (
   {360}          let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_548[@i_587]) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_585 = @ri_584 <= N suchthat defined(@19_m2_551[@ri_584], @19_y_552[@ri_584], @19_x_553[@ri_584]) && (@19_y_552[@ri_584] = @19_pkgen2(k_562)) && (@19_m_563 = @19_m2_551[@ri_584]) then
                (
   {411}          let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_553[@i_585]) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_583 = @ri_582 <= N suchthat defined(@19_m2_556[@ri_582], @19_y_557[@ri_582], @19_x_558[@ri_582]) && (@19_y_557[@ri_582] = @19_pkgen2(k_562)) && (@19_m_563 = @19_m2_556[@ri_582]) then
                (
   {462}          let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_558[@i_583]) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                else
                  let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = @19_dec2(@19_m_563, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
            )
            else
              @19_r3_530 <-R seed;
              @19_r3_529 <-R seed;
              Na_341 <-R nonce;
              msg_468: blocksize <- concat1(Na_341, A);
              @19_x_528: blocksize <- msg_468;
              @19_y_527: pkey <- pkX;
              if defined(k_562) && (@19_y_527 = @19_pkgen2(k_562)) then
              (
                @19_m2_526: bitstring <- @19_enc2(Z, @19_y_527, @19_r3_529);
                return(@19_m2_526);
                OA5(m_239: bitstring) :=
                @19_m_561: bitstring <- m_239;
                find                 else
                  find @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580], @19_y_522[@ri_580], @19_x_523[@ri_580]) && (@19_y_522[@ri_580] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_521[@ri_580]) then
                  (
   {591}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_523[@i_581]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578], @19_y_527[@ri_578], @19_x_528[@ri_578]) && (@19_y_527[@ri_578] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_526[@ri_578]) then
                  (
   {674}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_528[@i_579]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_577 = @ri_576 <= N suchthat defined(@19_m2_531[@ri_576], @19_y_532[@ri_576], @19_x_533[@ri_576]) && (@19_y_532[@ri_576] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_531[@ri_576]) then
                  (
   {757}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_533[@i_577]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574], @19_y_537[@ri_574], @19_x_538[@ri_574]) && (@19_y_537[@ri_574] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_536[@ri_574]) then
                  (
   {840}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_538[@i_575]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572], @19_y_542[@ri_572], @19_x_543[@ri_572]) && (@19_y_542[@ri_572] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_541[@ri_572]) then
                  (
   {923}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_543[@i_573]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570], @19_y_547[@ri_570], @19_x_548[@ri_570]) && (@19_y_547[@ri_570] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_546[@ri_570]) then
                  (
  {1006}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_548[@i_571]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568], @19_y_552[@ri_568], @19_x_553[@ri_568]) && (@19_y_552[@ri_568] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_551[@ri_568]) then
                  (
  {1089}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_553[@i_569]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566], @19_y_557[@ri_566], @19_x_558[@ri_566]) && (@19_y_557[@ri_566] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_556[@ri_566]) then
                  (
  {1172}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_558[@i_567]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  else
                    let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = @19_dec2(@19_m_561, @19_skgen2(k_562)) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
              )
              else
                return(enc_r(@19_x_528, @19_y_527, @19_r3_530));
                OA5(m_239: bitstring) :=
                @19_m_561: bitstring <- m_239;
                find                 else
                  find @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580], @19_y_522[@ri_580], @19_x_523[@ri_580]) && (@19_y_522[@ri_580] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_521[@ri_580]) then
                  (
  {1343}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_523[@i_581]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578], @19_y_527[@ri_578], @19_x_528[@ri_578]) && (@19_y_527[@ri_578] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_526[@ri_578]) then
                  (
  {1426}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_528[@i_579]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_577 = @ri_576 <= N suchthat defined(@19_m2_531[@ri_576], @19_y_532[@ri_576], @19_x_533[@ri_576]) && (@19_y_532[@ri_576] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_531[@ri_576]) then
                  (
  {1509}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_533[@i_577]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574], @19_y_537[@ri_574], @19_x_538[@ri_574]) && (@19_y_537[@ri_574] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_536[@ri_574]) then
                  (
  {1592}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_538[@i_575]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572], @19_y_542[@ri_572], @19_x_543[@ri_572]) && (@19_y_542[@ri_572] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_541[@ri_572]) then
                  (
  {1675}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_543[@i_573]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570], @19_y_547[@ri_570], @19_x_548[@ri_570]) && (@19_y_547[@ri_570] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_546[@ri_570]) then
                  (
  {1758}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_548[@i_571]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568], @19_y_552[@ri_568], @19_x_553[@ri_568]) && (@19_y_552[@ri_568] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_551[@ri_568]) then
                  (
  {1841}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_553[@i_569]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566], @19_y_557[@ri_566], @19_x_558[@ri_566]) && (@19_y_557[@ri_566] = @19_pkgen2(k_562)) && (@19_m_561 = @19_m2_556[@ri_566]) then
                  (
  {1924}            let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = injbot(@19_x_558[@i_567]) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  else
                    let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = @19_dec2(@19_m_561, @19_skgen2(k_562)) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (@19_y_522 = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, @19_y_522, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(@19_x_523, @19_y_522, @19_r3_525));
                      OAFinish() :=
                      end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            @19_m_564: bitstring <- m_239;
            find             else
              find @i_613 = @ri_612 <= N suchthat defined(@19_m2_521[@ri_612], @19_y_522[@ri_612], @19_x_523[@ri_612]) && (@19_y_522[@ri_612] = @19_pkgen2(k_562)) && (@19_m_564 = @19_m2_521[@ri_612]) then
              (
  {2122}        let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = injbot(@19_x_523[@i_613]) in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_611 = @ri_610 <= N suchthat defined(@19_m2_526[@ri_610], @19_y_527[@ri_610], @19_x_528[@ri_610]) && (@19_y_527[@ri_610] = @19_pkgen2(k_562)) && (@19_m_564 = @19_m2_526[@ri_610]) then
              (
  {2184}        let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = injbot(@19_x_528[@i_611]) in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_609 = @ri_608 <= N suchthat defined(@19_m2_531[@ri_608], @19_y_532[@ri_608], @19_x_533[@ri_608]) && (@19_y_532[@ri_608] = @19_pkgen2(k_562)) && (@19_m_564 = @19_m2_531[@ri_608]) then
              (
  {2246}        let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = injbot(@19_x_533[@i_609]) in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_607 = @ri_606 <= N suchthat defined(@19_m2_536[@ri_606], @19_y_537[@ri_606], @19_x_538[@ri_606]) && (@19_y_537[@ri_606] = @19_pkgen2(k_562)) && (@19_m_564 = @19_m2_536[@ri_606]) then
              (
  {2308}        let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = injbot(@19_x_538[@i_607]) in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_605 = @ri_604 <= N suchthat defined(@19_m2_541[@ri_604], @19_y_542[@ri_604], @19_x_543[@ri_604]) && (@19_y_542[@ri_604] = @19_pkgen2(k_562)) && (@19_m_564 = @19_m2_541[@ri_604]) then
              (
  {2370}        let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = injbot(@19_x_543[@i_605]) in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_603 = @ri_602 <= N suchthat defined(@19_m2_546[@ri_602], @19_y_547[@ri_602], @19_x_548[@ri_602]) && (@19_y_547[@ri_602] = @19_pkgen2(k_562)) && (@19_m_564 = @19_m2_546[@ri_602]) then
              (
  {2432}        let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = injbot(@19_x_548[@i_603]) in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_601 = @ri_600 <= N suchthat defined(@19_m2_551[@ri_600], @19_y_552[@ri_600], @19_x_553[@ri_600]) && (@19_y_552[@ri_600] = @19_pkgen2(k_562)) && (@19_m_564 = @19_m2_551[@ri_600]) then
              (
  {2494}        let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = injbot(@19_x_553[@i_601]) in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_599 = @ri_598 <= N suchthat defined(@19_m2_556[@ri_598], @19_y_557[@ri_598], @19_x_558[@ri_598]) && (@19_y_557[@ri_598] = @19_pkgen2(k_562)) && (@19_m_564 = @19_m2_556[@ri_598]) then
              (
  {2556}        let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = injbot(@19_x_558[@i_599]) in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              else
                let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = @19_dec2(@19_m_564, @19_skgen2(k_562)) in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = @19_pkgen2(k_562)) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_540 <-R seed;
            @19_r3_539 <-R seed;
            @19_x_538: blocksize <- msg_466;
            @19_y_537: pkey <- pkX;
            if defined(k_562) then
            (
              @19_m2_536: bitstring <- @19_enc2(Z, @19_y_537, @19_r3_539);
              return(@19_m2_536);
              OA5(m_239: bitstring) :=
              @19_m_565: bitstring <- m_239;
              find               else
                find @i_629 = @ri_628 <= N suchthat defined(@19_m2_521[@ri_628], @19_y_522[@ri_628], @19_x_523[@ri_628]) && (@19_y_522[@ri_628] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_521[@ri_628]) then
                (
  {2724}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_523[@i_629]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_627 = @ri_626 <= N suchthat defined(@19_m2_526[@ri_626], @19_y_527[@ri_626], @19_x_528[@ri_626]) && (@19_y_527[@ri_626] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_526[@ri_626]) then
                (
  {2803}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_528[@i_627]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_625 = @ri_624 <= N suchthat defined(@19_m2_531[@ri_624], @19_y_532[@ri_624], @19_x_533[@ri_624]) && (@19_y_532[@ri_624] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_531[@ri_624]) then
                (
  {2882}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_533[@i_625]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_623 = @ri_622 <= N suchthat defined(@19_m2_536[@ri_622], @19_y_537[@ri_622], @19_x_538[@ri_622]) && (@19_y_537[@ri_622] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_536[@ri_622]) then
                (
  {2961}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_538[@i_623]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_621 = @ri_620 <= N suchthat defined(@19_m2_541[@ri_620], @19_y_542[@ri_620], @19_x_543[@ri_620]) && (@19_y_542[@ri_620] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_541[@ri_620]) then
                (
  {3040}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_543[@i_621]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_619 = @ri_618 <= N suchthat defined(@19_m2_546[@ri_618], @19_y_547[@ri_618], @19_x_548[@ri_618]) && (@19_y_547[@ri_618] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_546[@ri_618]) then
                (
  {3119}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_548[@i_619]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_617 = @ri_616 <= N suchthat defined(@19_m2_551[@ri_616], @19_y_552[@ri_616], @19_x_553[@ri_616]) && (@19_y_552[@ri_616] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_551[@ri_616]) then
                (
  {3198}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_553[@i_617]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_615 = @ri_614 <= N suchthat defined(@19_m2_556[@ri_614], @19_y_557[@ri_614], @19_x_558[@ri_614]) && (@19_y_557[@ri_614] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_556[@ri_614]) then
                (
  {3277}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_558[@i_615]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                else
                  let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = @19_dec2(@19_m_565, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
            )
            else
              return(enc_r(@19_x_538, @19_y_537, @19_r3_540));
              OA5(m_239: bitstring) :=
              @19_m_565: bitstring <- m_239;
              find               else
                find @i_629 = @ri_628 <= N suchthat defined(@19_m2_521[@ri_628], @19_y_522[@ri_628], @19_x_523[@ri_628]) && (@19_y_522[@ri_628] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_521[@ri_628]) then
                (
  {3440}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_523[@i_629]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_627 = @ri_626 <= N suchthat defined(@19_m2_526[@ri_626], @19_y_527[@ri_626], @19_x_528[@ri_626]) && (@19_y_527[@ri_626] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_526[@ri_626]) then
                (
  {3519}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_528[@i_627]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_625 = @ri_624 <= N suchthat defined(@19_m2_531[@ri_624], @19_y_532[@ri_624], @19_x_533[@ri_624]) && (@19_y_532[@ri_624] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_531[@ri_624]) then
                (
  {3598}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_533[@i_625]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_623 = @ri_622 <= N suchthat defined(@19_m2_536[@ri_622], @19_y_537[@ri_622], @19_x_538[@ri_622]) && (@19_y_537[@ri_622] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_536[@ri_622]) then
                (
  {3677}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_538[@i_623]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_621 = @ri_620 <= N suchthat defined(@19_m2_541[@ri_620], @19_y_542[@ri_620], @19_x_543[@ri_620]) && (@19_y_542[@ri_620] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_541[@ri_620]) then
                (
  {3756}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_543[@i_621]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_619 = @ri_618 <= N suchthat defined(@19_m2_546[@ri_618], @19_y_547[@ri_618], @19_x_548[@ri_618]) && (@19_y_547[@ri_618] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_546[@ri_618]) then
                (
  {3835}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_548[@i_619]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_617 = @ri_616 <= N suchthat defined(@19_m2_551[@ri_616], @19_y_552[@ri_616], @19_x_553[@ri_616]) && (@19_y_552[@ri_616] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_551[@ri_616]) then
                (
  {3914}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_553[@i_617]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_615 = @ri_614 <= N suchthat defined(@19_m2_556[@ri_614], @19_y_557[@ri_614], @19_x_558[@ri_614]) && (@19_y_557[@ri_614] = @19_pkgen2(k_562)) && (@19_m_565 = @19_m2_556[@ri_614]) then
                (
  {3993}          let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = injbot(@19_x_558[@i_615]) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
                )
                else
                  let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = @19_dec2(@19_m_565, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, @19_y_532, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(@19_x_533, @19_y_532, @19_r3_535));
                    OAFinish() :=
                    end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(k_562, k_233, A, @19_m2_369[@ri_454], A, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            msg_515: blocksize <- concat2(Na_341[@i_455], Nb_473, B);
            @19_r3_555 <-R seed;
            @19_r3_554 <-R seed;
            @19_x_553: blocksize <- msg_515;
            @19_y_552: pkey <- pkY;
            if defined(k_562) then
            (
              @19_m2_551: bitstring <- @19_enc2(Z, @19_y_552, @19_r3_554);
              return(@19_m2_551);
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_473 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_473 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
              )
              else
                let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
            )
            else
              return(enc_r(@19_x_553, @19_y_552, @19_r3_555));
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_473 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_473 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
              )
              else
                let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(k_562, k_233, A, @19_m2_359[@ri_458], A, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            msg_516: blocksize <- concat2(Na_338[@i_459], Nb_471, B);
            @19_r3_560 <-R seed;
            @19_r3_559 <-R seed;
            @19_x_558: blocksize <- msg_516;
            @19_y_557: pkey <- pkY;
            if defined(k_562) then
            (
              @19_m2_556: bitstring <- @19_enc2(Z, @19_y_557, @19_r3_559);
              return(@19_m2_556);
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_471 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_471 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
              )
              else
                let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
            )
            else
              return(enc_r(@19_x_558, @19_y_557, @19_r3_560));
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_471 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_471 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
              )
              else
                let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              if (pkY = @19_pkgen2(k_389)) then
              (
                r_387 <-R seed;
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if (Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                @19_r3_545 <-R seed;
                @19_r3_544 <-R seed;
                msg_517: blocksize <- concat2(Na_246, Nb_333, B);
                @19_x_543: blocksize <- msg_517;
                @19_y_542: pkey <- pkY;
                if defined(k_562) && (@19_y_542 = @19_pkgen2(k_562)) then
                (
                  @19_m2_541: bitstring <- @19_enc2(Z, @19_y_542, @19_r3_544);
                  return(@19_m2_541);
                  OB11(m3: bitstring) :=
                  find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_240[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                  (
                    if (Nb_333 = Nb_240[@i_443]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
                )
                else
                  return(enc_r(@19_x_543, @19_y_542, @19_r3_545));
                  OB11(m3: bitstring) :=
                  find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_240[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                  (
                    if (Nb_333 = Nb_240[@i_443]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_322 = @ri_321 <= N suchthat defined(k_562, k_233, A, h2[@ri_321], r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              msg_518: blocksize <- concat2(Na_246, Nb_469, B);
              @19_r3_550 <-R seed;
              @19_r3_549 <-R seed;
              @19_x_548: blocksize <- msg_518;
              @19_y_547: pkey <- pkY;
              if defined(k_562) then
              (
                @19_m2_546: bitstring <- @19_enc2(Z, @19_y_547, @19_r3_549);
                return(@19_m2_546);
                OB11(m3: bitstring) :=
                find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                  end
                orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                  end
                orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                  end
                orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
                (
                  if (Nb_469 = Nb_240[@i_403]) then
                  return();
                  OBFinish() :=
                  if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
                )
                orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                  end
                orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
                (
                  if (Nb_469 = Nb_240[@i_407]) then
                  return();
                  OBFinish() :=
                  if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
                )
                else
                  let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
              )
              else
                return(enc_r(@19_x_548, @19_y_547, @19_r3_550));
                OB11(m3: bitstring) :=
                find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                  end
                orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                  end
                orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                  end
                orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
                (
                  if (Nb_469 = Nb_240[@i_403]) then
                  return();
                  OBFinish() :=
                  if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
                )
                orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                  end
                orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
                (
                  if (Nb_469 = Nb_240[@i_407]) then
                  return();
                  OBFinish() :=
                  if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
                )
                else
                  let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind  suchthat defined(k_562, k_233, A, A) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_562), h2);
            r_307 <-R sseed;
            return(@19_pkgen2(k_562), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(k_562, k_233, A, A, B, k_389) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of useless
  - Remove assignments on @19_x_543 (definition removed, all usages removed)
  - Remove assignments on @19_y_542 (definition removed, all usages removed)
  - Remove assignments on @19_x_548 (definition removed, all usages removed)
  - Remove assignments on @19_y_547 (definition removed, all usages removed)
  - Remove assignments on @19_x_553 (definition removed, all usages removed)
  - Remove assignments on @19_y_552 (definition removed, all usages removed)
  - Remove assignments on @19_x_558 (definition removed, all usages removed)
  - Remove assignments on @19_y_557 (definition removed, all usages removed)
  - Remove assignments on k_233 (definition removed, all usages removed)
  - Remove assignments on @19_x_528 (definition removed, all usages removed)
  - Remove assignments on @19_y_527 (definition removed, all usages removed)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1343 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1426 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1509 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1592 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1675 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1758 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1841 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1924 (tuple expanded)
  - Remove assignments on @19_m_561 (definition removed, all usages removed)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 591 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 674 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 757 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 840 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 923 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1006 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1089 (tuple expanded)
  - Remove assignments on @19_y_522 (definition kept, array references kept)
  - Remove assignments on @19_x_523 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 1172 (tuple expanded)
  - Remove assignments on @19_m_561 (definition removed, all usages removed)
  - Remove assignments on @19_m_563 (definition removed, all usages removed)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 105 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 156 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 207 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 258 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 309 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 360 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 411 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) at 462 (tuple expanded)
  - Remove assignments on @19_m_564 (definition removed, all usages removed)
  - Simplify pattern injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) at 2122 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) at 2184 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) at 2246 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) at 2308 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) at 2370 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) at 2432 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) at 2494 (tuple expanded)
  - Simplify pattern injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) at 2556 (tuple expanded)
  - Remove assignments on @19_x_538 (definition removed, all usages removed)
  - Remove assignments on @19_y_537 (definition removed, all usages removed)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3440 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3519 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3598 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3677 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3756 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3835 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3914 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3993 (tuple expanded)
  - Remove assignments on @19_m_565 (definition removed, all usages removed)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 2724 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 2803 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 2882 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 2961 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3040 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3119 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3198 (tuple expanded)
  - Remove assignments on @19_y_532 (definition kept, array references kept)
  - Remove assignments on @19_x_533 (definition kept, array references kept)
  - Simplify pattern injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) at 3277 (tuple expanded)
  - Remove assignments on @19_m_565 (definition removed, all usages removed)
yields

Game 25 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_562 <-R keyseed;
          return(@19_pkgen2(k_562));
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              r_372 <-R seed;
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              Na_341 <-R nonce;
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              find               else
    {85}        find @i_597 = @ri_596 <= N suchthat defined(@19_m2_521[@ri_596], @19_y_522[@ri_596], @19_x_523[@ri_596]) && (@19_y_522[@ri_596] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_596]) then
                (
   {100}          let concat2(=Na_341, Nb_240: nonce, =hostX) = {105}@19_x_523[@i_597] in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_595 = @ri_594 <= N suchthat defined(pkX[@ri_594], msg_468[@ri_594], @19_r3_530[@ri_594], @19_r3_530[@ri_594], @19_m2_526[@ri_594]) && (pkX[@ri_594] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_594]) then
                (
   {152}          let concat2(=Na_341, Nb_240: nonce, =hostX) = {157}msg_468[@i_595] in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_593 = @ri_592 <= N suchthat defined(@19_m2_531[@ri_592], @19_y_532[@ri_592], @19_x_533[@ri_592]) && (@19_y_532[@ri_592] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_592]) then
                (
   {202}          let concat2(=Na_341, Nb_240: nonce, =hostX) = {207}@19_x_533[@i_593] in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_591 = @ri_590 <= N suchthat defined(pkX[@ri_590], msg_466[@ri_590], Na_335[@ri_590], Na_335[@ri_590], @19_m2_536[@ri_590]) && (pkX[@ri_590] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_590]) then
                (
   {254}          let concat2(=Na_341, Nb_240: nonce, =hostX) = {259}msg_466[@i_591] in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_589 = @ri_588 <= N suchthat defined(pkY[@ri_588], msg_517[@ri_588], @19_r3_545[@ri_588], @19_r3_545[@ri_588], @19_m2_541[@ri_588]) && (pkY[@ri_588] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_588]) then
                (
   {306}          let concat2(=Na_341, Nb_240: nonce, =hostX) = {311}msg_517[@i_589] in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_587 = @ri_586 <= N suchthat defined(pkY[@ri_586], msg_518[@ri_586], Nb_469[@ri_586], Nb_469[@ri_586], @19_m2_546[@ri_586]) && (pkY[@ri_586] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_586]) then
                (
   {358}          let concat2(=Na_341, Nb_240: nonce, =hostX) = {363}msg_518[@i_587] in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_585 = @ri_584 <= N suchthat defined(pkY[@ri_584], msg_515[@ri_584], Nb_473[@ri_584], Nb_473[@ri_584], @19_m2_551[@ri_584]) && (pkY[@ri_584] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_584]) then
                (
   {410}          let concat2(=Na_341, Nb_240: nonce, =hostX) = {415}msg_515[@i_585] in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                orfind @i_583 = @ri_582 <= N suchthat defined(pkY[@ri_582], msg_516[@ri_582], Nb_471[@ri_582], Nb_471[@ri_582], @19_m2_556[@ri_582]) && (pkY[@ri_582] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_582]) then
                (
   {462}          let concat2(=Na_341, Nb_240: nonce, =hostX) = {467}msg_516[@i_583] in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
                )
                else
                  let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  r_367 <-R seed;
                  @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                  return(@19_m2_364);
                  OAFinish() :=
                  end
            )
            else
              @19_r3_530 <-R seed;
              @19_r3_529 <-R seed;
              Na_341 <-R nonce;
              msg_468: blocksize <- concat1(Na_341, A);
   {545}      if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
              (
                @19_m2_526: bitstring <- @19_enc2(Z, pkX, @19_r3_529);
                return(@19_m2_526);
                OA5(m_239: bitstring) :=
                find                 else
   {565}          find @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580], @19_y_522[@ri_580], @19_x_523[@ri_580]) && (@19_y_522[@ri_580] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_580]) then
                  (
   {580}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {585}@19_x_523[@i_581] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_579 = @ri_578 <= N suchthat defined(pkX[@ri_578], msg_468[@ri_578], @19_r3_530[@ri_578], @19_r3_530[@ri_578], @19_m2_526[@ri_578]) && (pkX[@ri_578] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_578]) then
                  (
   {664}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {669}msg_468[@i_579] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_577 = @ri_576 <= N suchthat defined(@19_m2_531[@ri_576], @19_y_532[@ri_576], @19_x_533[@ri_576]) && (@19_y_532[@ri_576] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_576]) then
                  (
   {746}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {751}@19_x_533[@i_577] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_575 = @ri_574 <= N suchthat defined(pkX[@ri_574], msg_466[@ri_574], Na_335[@ri_574], Na_335[@ri_574], @19_m2_536[@ri_574]) && (pkX[@ri_574] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_574]) then
                  (
   {830}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {835}msg_466[@i_575] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_573 = @ri_572 <= N suchthat defined(pkY[@ri_572], msg_517[@ri_572], @19_r3_545[@ri_572], @19_r3_545[@ri_572], @19_m2_541[@ri_572]) && (pkY[@ri_572] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_572]) then
                  (
   {914}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {919}msg_517[@i_573] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_571 = @ri_570 <= N suchthat defined(pkY[@ri_570], msg_518[@ri_570], Nb_469[@ri_570], Nb_469[@ri_570], @19_m2_546[@ri_570]) && (pkY[@ri_570] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_570]) then
                  (
   {998}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1003}msg_518[@i_571] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_569 = @ri_568 <= N suchthat defined(pkY[@ri_568], msg_515[@ri_568], Nb_473[@ri_568], Nb_473[@ri_568], @19_m2_551[@ri_568]) && (pkY[@ri_568] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_568]) then
                  (
  {1082}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1087}msg_515[@i_569] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_567 = @ri_566 <= N suchthat defined(pkY[@ri_566], msg_516[@ri_566], Nb_471[@ri_566], Nb_471[@ri_566], @19_m2_556[@ri_566]) && (pkY[@ri_566] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_566]) then
                  (
  {1166}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1171}msg_516[@i_567] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  else
                    let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
  {1267}            if defined(k_562) && {1268}(pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
              )
              else
                return(enc_r(msg_468, pkX, @19_r3_530));
                OA5(m_239: bitstring) :=
                find                 else
  {1317}          find @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580], @19_y_522[@ri_580], @19_x_523[@ri_580]) && (@19_y_522[@ri_580] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_580]) then
                  (
  {1332}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1337}@19_x_523[@i_581] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_579 = @ri_578 <= N suchthat defined(pkX[@ri_578], msg_468[@ri_578], @19_r3_530[@ri_578], @19_r3_530[@ri_578], @19_m2_526[@ri_578]) && (pkX[@ri_578] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_578]) then
                  (
  {1416}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1421}msg_468[@i_579] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_577 = @ri_576 <= N suchthat defined(@19_m2_531[@ri_576], @19_y_532[@ri_576], @19_x_533[@ri_576]) && (@19_y_532[@ri_576] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_576]) then
                  (
  {1498}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1503}@19_x_533[@i_577] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_575 = @ri_574 <= N suchthat defined(pkX[@ri_574], msg_466[@ri_574], Na_335[@ri_574], Na_335[@ri_574], @19_m2_536[@ri_574]) && (pkX[@ri_574] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_574]) then
                  (
  {1582}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1587}msg_466[@i_575] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_573 = @ri_572 <= N suchthat defined(pkY[@ri_572], msg_517[@ri_572], @19_r3_545[@ri_572], @19_r3_545[@ri_572], @19_m2_541[@ri_572]) && (pkY[@ri_572] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_572]) then
                  (
  {1666}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1671}msg_517[@i_573] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_571 = @ri_570 <= N suchthat defined(pkY[@ri_570], msg_518[@ri_570], Nb_469[@ri_570], Nb_469[@ri_570], @19_m2_546[@ri_570]) && (pkY[@ri_570] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_570]) then
                  (
  {1750}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1755}msg_518[@i_571] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_569 = @ri_568 <= N suchthat defined(pkY[@ri_568], msg_515[@ri_568], Nb_473[@ri_568], Nb_473[@ri_568], @19_m2_551[@ri_568]) && (pkY[@ri_568] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_568]) then
                  (
  {1834}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1839}msg_515[@i_569] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  orfind @i_567 = @ri_566 <= N suchthat defined(pkY[@ri_566], msg_516[@ri_566], Nb_471[@ri_566], Nb_471[@ri_566], @19_m2_556[@ri_566]) && (pkY[@ri_566] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_566]) then
                  (
  {1918}            let concat2(=Na_341, Nb_240: nonce, =hostX) = {1923}msg_516[@i_567] in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
                    if defined(k_562) && (pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
                  )
                  else
                    let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                    event beginA(A, hostX, Na_341, Nb_240);
                    msg_241: blocksize <- pad(Nb_240);
                    @19_r3_525 <-R seed;
                    @19_r3_524 <-R seed;
                    @19_x_523: blocksize <- msg_241;
                    @19_y_522: pkey <- pkX;
  {2019}            if defined(k_562) && {2020}(pkX = @19_pkgen2(k_562)) then
                    (
                      @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                      return(@19_m2_521);
                      OAFinish() :=
                      end
                    )
                    else
                      return(enc_r(msg_241, pkX, @19_r3_525));
                      OAFinish() :=
                      end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            find             else
  {2094}      find @i_613 = @ri_612 <= N suchthat defined(@19_m2_521[@ri_612], @19_y_522[@ri_612], @19_x_523[@ri_612]) && (@19_y_522[@ri_612] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_612]) then
              (
  {2109}        let concat2(=Na_338, Nb_240: nonce, =hostX) = {2114}@19_x_523[@i_613] in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_611 = @ri_610 <= N suchthat defined(pkX[@ri_610], msg_468[@ri_610], @19_r3_530[@ri_610], @19_r3_530[@ri_610], @19_m2_526[@ri_610]) && (pkX[@ri_610] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_610]) then
              (
  {2172}        let concat2(=Na_338, Nb_240: nonce, =hostX) = {2177}msg_468[@i_611] in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_609 = @ri_608 <= N suchthat defined(@19_m2_531[@ri_608], @19_y_532[@ri_608], @19_x_533[@ri_608]) && (@19_y_532[@ri_608] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_608]) then
              (
  {2233}        let concat2(=Na_338, Nb_240: nonce, =hostX) = {2238}@19_x_533[@i_609] in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_607 = @ri_606 <= N suchthat defined(pkX[@ri_606], msg_466[@ri_606], Na_335[@ri_606], Na_335[@ri_606], @19_m2_536[@ri_606]) && (pkX[@ri_606] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_606]) then
              (
  {2296}        let concat2(=Na_338, Nb_240: nonce, =hostX) = {2301}msg_466[@i_607] in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_605 = @ri_604 <= N suchthat defined(pkY[@ri_604], msg_517[@ri_604], @19_r3_545[@ri_604], @19_r3_545[@ri_604], @19_m2_541[@ri_604]) && (pkY[@ri_604] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_604]) then
              (
  {2359}        let concat2(=Na_338, Nb_240: nonce, =hostX) = {2364}msg_517[@i_605] in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_603 = @ri_602 <= N suchthat defined(pkY[@ri_602], msg_518[@ri_602], Nb_469[@ri_602], Nb_469[@ri_602], @19_m2_546[@ri_602]) && (pkY[@ri_602] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_602]) then
              (
  {2422}        let concat2(=Na_338, Nb_240: nonce, =hostX) = {2427}msg_518[@i_603] in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_601 = @ri_600 <= N suchthat defined(pkY[@ri_600], msg_515[@ri_600], Nb_473[@ri_600], Nb_473[@ri_600], @19_m2_551[@ri_600]) && (pkY[@ri_600] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_600]) then
              (
  {2485}        let concat2(=Na_338, Nb_240: nonce, =hostX) = {2490}msg_515[@i_601] in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              orfind @i_599 = @ri_598 <= N suchthat defined(pkY[@ri_598], msg_516[@ri_598], Nb_471[@ri_598], Nb_471[@ri_598], @19_m2_556[@ri_598]) && (pkY[@ri_598] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_598]) then
              (
  {2548}        let concat2(=Na_338, Nb_240: nonce, =hostX) = {2553}msg_516[@i_599] in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
              )
              else
                let injbot(concat2(=Na_338, Nb_240: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                event beginA(A, hostX, Na_338, Nb_240);
                r_357 <-R seed;
                @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
                return(@19_m2_354);
                OAFinish() :=
                event endA(A, hostX, Na_338, Nb_240)
          )
          orfind @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = @19_pkgen2(k_562)) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_540 <-R seed;
            @19_r3_539 <-R seed;
  {2674}    if defined(k_562) then
            (
              @19_m2_536: bitstring <- @19_enc2(Z, pkX, @19_r3_539);
              return(@19_m2_536);
              OA5(m_239: bitstring) :=
              find               else
  {2690}        find @i_629 = @ri_628 <= N suchthat defined(@19_m2_521[@ri_628], @19_y_522[@ri_628], @19_x_523[@ri_628]) && (@19_y_522[@ri_628] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_628]) then
                (
  {2705}          let concat2(=Na_335, Nb_240: nonce, =hostX) = {2710}@19_x_523[@i_629] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_627 = @ri_626 <= N suchthat defined(pkX[@ri_626], msg_468[@ri_626], @19_r3_530[@ri_626], @19_r3_530[@ri_626], @19_m2_526[@ri_626]) && (pkX[@ri_626] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_626]) then
                (
  {2785}          let concat2(=Na_335, Nb_240: nonce, =hostX) = {2790}msg_468[@i_627] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_625 = @ri_624 <= N suchthat defined(@19_m2_531[@ri_624], @19_y_532[@ri_624], @19_x_533[@ri_624]) && (@19_y_532[@ri_624] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_624]) then
                (
  {2863}          let concat2(=Na_335, Nb_240: nonce, =hostX) = {2868}@19_x_533[@i_625] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_623 = @ri_622 <= N suchthat defined(pkX[@ri_622], msg_466[@ri_622], Na_335[@ri_622], Na_335[@ri_622], @19_m2_536[@ri_622]) && (pkX[@ri_622] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_622]) then
                (
  {2943}          let concat2(=Na_335, Nb_240: nonce, =hostX) = {2948}msg_466[@i_623] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_621 = @ri_620 <= N suchthat defined(pkY[@ri_620], msg_517[@ri_620], @19_r3_545[@ri_620], @19_r3_545[@ri_620], @19_m2_541[@ri_620]) && (pkY[@ri_620] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_620]) then
                (
  {3023}          let concat2(=Na_335, Nb_240: nonce, =hostX) = {3028}msg_517[@i_621] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_619 = @ri_618 <= N suchthat defined(pkY[@ri_618], msg_518[@ri_618], Nb_469[@ri_618], Nb_469[@ri_618], @19_m2_546[@ri_618]) && (pkY[@ri_618] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_618]) then
                (
  {3103}          let concat2(=Na_335, Nb_240: nonce, =hostX) = {3108}msg_518[@i_619] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_617 = @ri_616 <= N suchthat defined(pkY[@ri_616], msg_515[@ri_616], Nb_473[@ri_616], Nb_473[@ri_616], @19_m2_551[@ri_616]) && (pkY[@ri_616] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_616]) then
                (
  {3183}          let concat2(=Na_335, Nb_240: nonce, =hostX) = {3188}msg_515[@i_617] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_615 = @ri_614 <= N suchthat defined(pkY[@ri_614], msg_516[@ri_614], Nb_471[@ri_614], Nb_471[@ri_614], @19_m2_556[@ri_614]) && (pkY[@ri_614] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_614]) then
                (
  {3263}          let concat2(=Na_335, Nb_240: nonce, =hostX) = {3268}msg_516[@i_615] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                else
                  let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
  {3360}          if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
            )
            else
              return(enc_r(msg_466, pkX, @19_r3_540));
              OA5(m_239: bitstring) :=
              find               else
                find @i_629 = @ri_628 <= N suchthat defined(@19_m2_521[@ri_628], @19_y_522[@ri_628], @19_x_523[@ri_628]) && (@19_y_522[@ri_628] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_628]) then
                (
                  let concat2(=Na_335, Nb_240: nonce, =hostX) = @19_x_523[@i_629] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_627 = @ri_626 <= N suchthat defined(pkX[@ri_626], msg_468[@ri_626], @19_r3_530[@ri_626], @19_r3_530[@ri_626], @19_m2_526[@ri_626]) && (pkX[@ri_626] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_626]) then
                (
                  let concat2(=Na_335, Nb_240: nonce, =hostX) = msg_468[@i_627] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_625 = @ri_624 <= N suchthat defined(@19_m2_531[@ri_624], @19_y_532[@ri_624], @19_x_533[@ri_624]) && (@19_y_532[@ri_624] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_624]) then
                (
                  let concat2(=Na_335, Nb_240: nonce, =hostX) = @19_x_533[@i_625] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_623 = @ri_622 <= N suchthat defined(pkX[@ri_622], msg_466[@ri_622], Na_335[@ri_622], Na_335[@ri_622], @19_m2_536[@ri_622]) && (pkX[@ri_622] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_622]) then
                (
                  let concat2(=Na_335, Nb_240: nonce, =hostX) = msg_466[@i_623] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_621 = @ri_620 <= N suchthat defined(pkY[@ri_620], msg_517[@ri_620], @19_r3_545[@ri_620], @19_r3_545[@ri_620], @19_m2_541[@ri_620]) && (pkY[@ri_620] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_620]) then
                (
                  let concat2(=Na_335, Nb_240: nonce, =hostX) = msg_517[@i_621] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_619 = @ri_618 <= N suchthat defined(pkY[@ri_618], msg_518[@ri_618], Nb_469[@ri_618], Nb_469[@ri_618], @19_m2_546[@ri_618]) && (pkY[@ri_618] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_618]) then
                (
                  let concat2(=Na_335, Nb_240: nonce, =hostX) = msg_518[@i_619] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_617 = @ri_616 <= N suchthat defined(pkY[@ri_616], msg_515[@ri_616], Nb_473[@ri_616], Nb_473[@ri_616], @19_m2_551[@ri_616]) && (pkY[@ri_616] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_616]) then
                (
                  let concat2(=Na_335, Nb_240: nonce, =hostX) = msg_515[@i_617] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                orfind @i_615 = @ri_614 <= N suchthat defined(pkY[@ri_614], msg_516[@ri_614], Nb_471[@ri_614], Nb_471[@ri_614], @19_m2_556[@ri_614]) && (pkY[@ri_614] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_614]) then
                (
                  let concat2(=Na_335, Nb_240: nonce, =hostX) = msg_516[@i_615] in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
                )
                else
                  let injbot(concat2(=Na_335, Nb_240: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_335, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_535 <-R seed;
                  @19_r3_534 <-R seed;
                  @19_x_533: blocksize <- msg_241;
                  @19_y_532: pkey <- pkX;
                  if defined(k_562) then
                  (
                    @19_m2_531: bitstring <- @19_enc2(Z, pkX, @19_r3_534);
                    return(@19_m2_531);
                    OAFinish() :=
                    end
                  )
                  else
                    return(enc_r(msg_241, pkX, @19_r3_535));
                    OAFinish() :=
                    end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
  {4126}  find @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(k_562, A, A, @19_m2_369[@ri_454], A, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            msg_515: blocksize <- concat2(Na_341[@i_455], Nb_473, B);
            @19_r3_555 <-R seed;
            @19_r3_554 <-R seed;
  {4197}    if defined(k_562) then
            (
              @19_m2_551: bitstring <- @19_enc2(Z, pkY, @19_r3_554);
              return(@19_m2_551);
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_473 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if {4280}(Nb_473 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
              )
              else
                let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
            )
            else
              return(enc_r(msg_515, pkY, @19_r3_555));
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_473 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_473 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
              )
              else
                let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(k_562, A, A, @19_m2_359[@ri_458], A, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            msg_516: blocksize <- concat2(Na_338[@i_459], Nb_471, B);
            @19_r3_560 <-R seed;
            @19_r3_559 <-R seed;
  {4522}    if defined(k_562) then
            (
              @19_m2_556: bitstring <- @19_enc2(Z, pkY, @19_r3_559);
              return(@19_m2_556);
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_471 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if {4605}(Nb_471 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
              )
              else
                let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
            )
            else
              return(enc_r(msg_516, pkY, @19_r3_560));
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_471 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              (
                if (Nb_471 = Nb_240[@i_407]) then
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
              )
              else
                let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
  {4812}    find @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              if (pkY = @19_pkgen2(k_389)) then
              (
                r_387 <-R seed;
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                (
                  if {4926}(Nb_333 = Nb_240[@i_443]) then
                  return();
                  OBFinish() :=
                  end
                )
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                @19_r3_545 <-R seed;
                @19_r3_544 <-R seed;
                msg_517: blocksize <- concat2(Na_246, Nb_333, B);
                if defined(k_562) && (pkY = @19_pkgen2(k_562)) then
                (
                  @19_m2_541: bitstring <- @19_enc2(Z, pkY, @19_r3_544);
                  return(@19_m2_541);
                  OB11(m3: bitstring) :=
                  find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_240[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                  (
                    if {5038}(Nb_333 = Nb_240[@i_443]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
                )
                else
                  return(enc_r(msg_517, pkY, @19_r3_545));
                  OB11(m3: bitstring) :=
                  find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_240[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442], Nb_240[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                  (
                    if {5133}(Nb_333 = Nb_240[@i_443]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_322 = @ri_321 <= N suchthat defined(k_562, A, A, h2[@ri_321], r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              msg_518: blocksize <- concat2(Na_246, Nb_469, B);
              @19_r3_550 <-R seed;
              @19_r3_549 <-R seed;
  {5251}      if defined(k_562) then
              (
                @19_m2_546: bitstring <- @19_enc2(Z, pkY, @19_r3_549);
                return(@19_m2_546);
                OB11(m3: bitstring) :=
                find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                  end
                orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                  end
                orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                  end
                orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
                (
                  if (Nb_469 = Nb_240[@i_403]) then
                  return();
                  OBFinish() :=
  {5306}          if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
                )
                orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                  end
                orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
                (
                  if {5337}(Nb_469 = Nb_240[@i_407]) then
                  return();
                  OBFinish() :=
  {5347}          if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
                )
                else
                  let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
  {5375}          if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
              )
              else
                return(enc_r(msg_518, pkY, @19_r3_550));
                OB11(m3: bitstring) :=
                find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                  end
                orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                  end
                orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                  end
                orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
                (
                  if (Nb_469 = Nb_240[@i_403]) then
                  return();
                  OBFinish() :=
                  if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
                )
                orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                  end
                orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], Nb_240[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
                (
                  if (Nb_469 = Nb_240[@i_407]) then
                  return();
                  OBFinish() :=
                  if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
                )
                else
                  let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  if defined(A) then
                  event endB(hostY, B, Na_246, Nb_469)
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
  {5536}  find u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind  suchthat defined(k_562, A, A, A) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_562), h2);
            r_307 <-R sseed;
            return(@19_pkgen2(k_562), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
  {5625}  if defined(k_562, A, A, A, B, k_389) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying simplify [probability Penccoll + (6. * N + 8.5 * N * N) / |nonce|]
  - Simplification pass
    - Replaced defined condition k_562, A, A, A, B, k_389 with k_562, k_389, B, A in find at 5625
    - Replaced defined condition k_562, A, A, A with k_562, A in find at 5536
    - Transformed find at 5251 into a test
    - Test at 5251 always true
    - Transformed find at 5375 into a test
    - Test at 5375 always true
    - Transformed find at 5347 into a test
    - Test at 5347 always true
    - Transformed find at 5306 into a test
    - Test at 5306 always true
    - Replaced defined condition k_562, A, A, h2[@ri_321], r_307[@ri_321] with r_307[@ri_321], h2[@ri_321], k_562 in find at 4812
    - Transformed find at 4522 into a test
    - Test at 4522 always true
    - Replaced defined condition k_562, A, A, @19_m2_359[@ri_458], A, Na_338[@ri_458] with Na_338[@ri_458], k_562, A, @19_m2_359[@ri_458] in find at 4126
    - Transformed find at 4197 into a test
    - Test at 4197 always true
    - Replaced defined condition k_562, A, A, @19_m2_369[@ri_454], A, Na_341[@ri_454] with Na_341[@ri_454], k_562, A, @19_m2_369[@ri_454] in find at 4126
    - Transformed find at 2674 into a test
    - Test at 2674 always true
    - Transformed find at 3360 into a test
    - Test at 3360 always true
    - Replaced ((pkY[@ri_614] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_614])) with (m_239 = @19_m2_556[@ri_614]) at 39239
    - Replaced msg_516[@i_615] with concat2(Na_338[@i_459[@i_615]], Nb_471[@i_615], B) at 3268
    - Remove let at 41474
    - Simplify pattern concat2(=Na_335, Nb_240: nonce, =hostX) at 3263 (tuple expanded)
    - Replaced defined condition pkY[@ri_614], msg_516[@ri_614], Nb_471[@ri_614], Nb_471[@ri_614], @19_m2_556[@ri_614] with @19_m2_556[@ri_614] in find at 2690
    - Replaced ((pkY[@ri_616] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_616])) with (m_239 = @19_m2_551[@ri_616]) at 39250
    - Replaced msg_515[@i_617] with concat2(Na_341[@i_455[@i_617]], Nb_473[@i_617], B) at 3188
    - Remove let at 42109
    - Simplify pattern concat2(=Na_335, Nb_240: nonce, =hostX) at 3183 (tuple expanded)
    - Replaced defined condition pkY[@ri_616], msg_515[@ri_616], Nb_473[@ri_616], Nb_473[@ri_616], @19_m2_551[@ri_616] with @19_m2_551[@ri_616] in find at 2690
    - Replaced ((pkY[@ri_618] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_618])) with (m_239 = @19_m2_546[@ri_618]) at 39261
    - Replaced msg_518[@i_619] with concat2(Na_246[@i_619], Nb_469[@i_619], B) at 3108
    - Simplify pattern =Na_335 at 42631 (equality test)
    - Simplify pattern =hostX at 42629 (equality test)
    - Replaced (hostX = B) with false at 42676
    - Test at 42629 always false
    - Simplify pattern concat2(=Na_335, Nb_240: nonce, =hostX) at 3103 (tuple expanded)
    - Replaced defined condition pkY[@ri_618], msg_518[@ri_618], Nb_469[@ri_618], Nb_469[@ri_618], @19_m2_546[@ri_618] with Nb_469[@ri_618], Na_246[@ri_618], @19_m2_546[@ri_618] in find at 2690
    - Replaced ((pkY[@ri_620] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_620])) with (m_239 = @19_m2_541[@ri_620]) at 39272
    - Replaced msg_517[@i_621] with concat2(Na_246[@i_621], Nb_333[@i_621], B) at 3028
    - Simplify pattern =Na_335 at 43317 (equality test)
    - Simplify pattern =hostX at 43315 (equality test)
    - Replaced (hostX = B) with false at 43362
    - Test at 43315 always false
    - Simplify pattern concat2(=Na_335, Nb_240: nonce, =hostX) at 3023 (tuple expanded)
    - Replaced defined condition pkY[@ri_620], msg_517[@ri_620], @19_r3_545[@ri_620], @19_r3_545[@ri_620], @19_m2_541[@ri_620] with Nb_333[@ri_620], Na_246[@ri_620], @19_m2_541[@ri_620] in find at 2690
    - Replaced ((pkX[@ri_622] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_622])) with (m_239 = @19_m2_536[@ri_622]) at 39283
    - Replaced msg_466[@i_623] with concat1(Na_335[@i_623], A) at 2948
    - Remove let at 2943
    - Replaced defined condition pkX[@ri_622], msg_466[@ri_622], Na_335[@ri_622], Na_335[@ri_622], @19_m2_536[@ri_622] with @19_m2_536[@ri_622] in find at 2690
    - Replaced ((@19_y_532[@ri_624] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_624])) with (m_239 = @19_m2_531[@ri_624]) at 39294
    - Replaced @19_x_533[@i_625] with pad(Nb_240[@i_625]) at 2868
    - Remove let at 2863
    - Replaced defined condition @19_m2_531[@ri_624], @19_y_532[@ri_624], @19_x_533[@ri_624] with @19_m2_531[@ri_624] in find at 2690
    - Replaced ((pkX[@ri_626] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_626])) with (m_239 = @19_m2_526[@ri_626]) at 39305
    - Replaced msg_468[@i_627] with concat1(Na_341[@i_627], A) at 2790
    - Remove let at 2785
    - Replaced defined condition pkX[@ri_626], msg_468[@ri_626], @19_r3_530[@ri_626], @19_r3_530[@ri_626], @19_m2_526[@ri_626] with @19_m2_526[@ri_626] in find at 2690
    - Replaced ((@19_y_522[@ri_628] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_628])) with (m_239 = @19_m2_521[@ri_628]) at 39316
    - Replaced @19_x_523[@i_629] with pad(Nb_240[@i_629]) at 2710
    - Remove let at 2705
    - Replaced defined condition @19_m2_521[@ri_628], @19_y_522[@ri_628], @19_x_523[@ri_628] with @19_m2_521[@ri_628] in find at 2690
    - Replaced ((pkY[@ri_598] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_598])) with (m_239 = @19_m2_556[@ri_598]) at 44981
    - Replaced msg_516[@i_599] with concat2(Na_338[@i_459[@i_599]], Nb_471[@i_599], B) at 2553
    - Simplify pattern =Na_338 at 47765 (equality test)
    - Replaced (Na_338 = Na_338[@i_459[@i_599]]) with (i_228 = @i_459[@i_599]) at 47776
    - Simplify pattern =hostX at 47763 (equality test)
    - Replaced (hostX = B) with true at 47841
    - Test at 47763 always true
    - Simplify pattern concat2(=Na_338, Nb_240: nonce, =hostX) at 2548 (tuple expanded)
    - Replaced defined condition pkY[@ri_598], msg_516[@ri_598], Nb_471[@ri_598], Nb_471[@ri_598], @19_m2_556[@ri_598] with Nb_471[@ri_598], @i_459[@ri_598], @19_m2_556[@ri_598] in find at 2094
    - Replaced ((pkY[@ri_600] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_600])) with (m_239 = @19_m2_551[@ri_600]) at 44992
    - Replaced msg_515[@i_601] with concat2(Na_341[@i_455[@i_601]], Nb_473[@i_601], B) at 2490
    - Remove let at 48489
    - Simplify pattern concat2(=Na_338, Nb_240: nonce, =hostX) at 2485 (tuple expanded)
    - Replaced defined condition pkY[@ri_600], msg_515[@ri_600], Nb_473[@ri_600], Nb_473[@ri_600], @19_m2_551[@ri_600] with @19_m2_551[@ri_600] in find at 2094
    - Replaced ((pkY[@ri_602] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_602])) with (m_239 = @19_m2_546[@ri_602]) at 45003
    - Replaced msg_518[@i_603] with concat2(Na_246[@i_603], Nb_469[@i_603], B) at 2427
    - Simplify pattern =Na_338 at 49061 (equality test)
    - Simplify pattern =hostX at 49059 (equality test)
    - Replaced (hostX = B) with true at 49108
    - Test at 49059 always true
    - Simplify pattern concat2(=Na_338, Nb_240: nonce, =hostX) at 2422 (tuple expanded)
    - Replaced defined condition pkY[@ri_602], msg_518[@ri_602], Nb_469[@ri_602], Nb_469[@ri_602], @19_m2_546[@ri_602] with Nb_469[@ri_602], Na_246[@ri_602], @19_m2_546[@ri_602] in find at 2094
    - Replaced ((pkY[@ri_604] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_604])) with (m_239 = @19_m2_541[@ri_604]) at 45014
    - Replaced msg_517[@i_605] with concat2(Na_246[@i_605], Nb_333[@i_605], B) at 2364
    - Simplify pattern =Na_338 at 49807 (equality test)
    - Simplify pattern =hostX at 49805 (equality test)
    - Replaced (hostX = B) with true at 49854
    - Test at 49805 always true
    - Simplify pattern concat2(=Na_338, Nb_240: nonce, =hostX) at 2359 (tuple expanded)
    - Replaced defined condition pkY[@ri_604], msg_517[@ri_604], @19_r3_545[@ri_604], @19_r3_545[@ri_604], @19_m2_541[@ri_604] with Nb_333[@ri_604], Na_246[@ri_604], @19_m2_541[@ri_604] in find at 2094
    - Replaced ((pkX[@ri_606] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_606])) with (m_239 = @19_m2_536[@ri_606]) at 45025
    - Replaced msg_466[@i_607] with concat1(Na_335[@i_607], A) at 2301
    - Remove let at 2296
    - Replaced defined condition pkX[@ri_606], msg_466[@ri_606], Na_335[@ri_606], Na_335[@ri_606], @19_m2_536[@ri_606] with @19_m2_536[@ri_606] in find at 2094
    - Replaced ((@19_y_532[@ri_608] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_608])) with (m_239 = @19_m2_531[@ri_608]) at 45036
    - Replaced @19_x_533[@i_609] with pad(Nb_240[@i_609]) at 2238
    - Remove let at 2233
    - Replaced defined condition @19_m2_531[@ri_608], @19_y_532[@ri_608], @19_x_533[@ri_608] with @19_m2_531[@ri_608] in find at 2094
    - Replaced ((pkX[@ri_610] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_610])) with (m_239 = @19_m2_526[@ri_610]) at 45047
    - Replaced msg_468[@i_611] with concat1(Na_341[@i_611], A) at 2177
    - Remove let at 2172
    - Replaced defined condition pkX[@ri_610], msg_468[@ri_610], @19_r3_530[@ri_610], @19_r3_530[@ri_610], @19_m2_526[@ri_610] with @19_m2_526[@ri_610] in find at 2094
    - Replaced ((@19_y_522[@ri_612] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_612])) with (m_239 = @19_m2_521[@ri_612]) at 45058
    - Replaced @19_x_523[@i_613] with pad(Nb_240[@i_613]) at 2114
    - Remove let at 2109
    - Replaced defined condition @19_m2_521[@ri_612], @19_y_522[@ri_612], @19_x_523[@ri_612] with @19_m2_521[@ri_612] in find at 2094
    - Transformed find at 545 into a test
    - Transformed find at 2019 into a test
    - Replaced (pkX = @19_pkgen2(k_562)) with false at 2020
    - Test at 2019 always false
    - Replaced ((pkY[@ri_566] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_566])) with (m_239 = @19_m2_556[@ri_566]) at 51580
    - Replaced msg_516[@i_567] with concat2(Na_338[@i_459[@i_567]], Nb_471[@i_567], B) at 1923
    - Remove let at 52996
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 1918 (tuple expanded)
    - Replaced defined condition pkY[@ri_566], msg_516[@ri_566], Nb_471[@ri_566], Nb_471[@ri_566], @19_m2_556[@ri_566] with @19_m2_556[@ri_566] in find at 1317
    - Replaced ((pkY[@ri_568] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_568])) with (m_239 = @19_m2_551[@ri_568]) at 51591
    - Replaced msg_515[@i_569] with concat2(Na_341[@i_455[@i_569]], Nb_473[@i_569], B) at 1839
    - Simplify pattern =Na_341 at 53631 (equality test)
    - Replaced (Na_341 = Na_341[@i_455[@i_569]]) with false at 53642
    - Test at 53631 always false
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 1834 (tuple expanded)
    - Replaced defined condition pkY[@ri_568], msg_515[@ri_568], Nb_473[@ri_568], Nb_473[@ri_568], @19_m2_551[@ri_568] with @19_m2_551[@ri_568] in find at 1317
    - Replaced ((pkY[@ri_570] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_570])) with (m_239 = @19_m2_546[@ri_570]) at 51602
    - Replaced msg_518[@i_571] with concat2(Na_246[@i_571], Nb_469[@i_571], B) at 1755
    - Simplify pattern =Na_341 at 54202 (equality test)
    - Simplify pattern =hostX at 54200 (equality test)
    - Replaced (hostX = B) with false at 54245
    - Test at 54200 always false
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 1750 (tuple expanded)
    - Replaced defined condition pkY[@ri_570], msg_518[@ri_570], Nb_469[@ri_570], Nb_469[@ri_570], @19_m2_546[@ri_570] with Nb_469[@ri_570], Na_246[@ri_570], @19_m2_546[@ri_570] in find at 1317
    - Replaced ((pkY[@ri_572] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_572])) with (m_239 = @19_m2_541[@ri_572]) at 51613
    - Replaced msg_517[@i_573] with concat2(Na_246[@i_573], Nb_333[@i_573], B) at 1671
    - Simplify pattern =Na_341 at 54891 (equality test)
    - Simplify pattern =hostX at 54889 (equality test)
    - Replaced (hostX = B) with false at 54934
    - Test at 54889 always false
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 1666 (tuple expanded)
    - Replaced defined condition pkY[@ri_572], msg_517[@ri_572], @19_r3_545[@ri_572], @19_r3_545[@ri_572], @19_m2_541[@ri_572] with Nb_333[@ri_572], Na_246[@ri_572], @19_m2_541[@ri_572] in find at 1317
    - Replaced ((pkX[@ri_574] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_574])) with (m_239 = @19_m2_536[@ri_574]) at 51624
    - Replaced msg_466[@i_575] with concat1(Na_335[@i_575], A) at 1587
    - Remove let at 1582
    - Replaced defined condition pkX[@ri_574], msg_466[@ri_574], Na_335[@ri_574], Na_335[@ri_574], @19_m2_536[@ri_574] with @19_m2_536[@ri_574] in find at 1317
    - Replaced ((@19_y_532[@ri_576] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_576])) with (m_239 = @19_m2_531[@ri_576]) at 51635
    - Replaced @19_x_533[@i_577] with pad(Nb_240[@i_577]) at 1503
    - Remove let at 1498
    - Replaced defined condition @19_m2_531[@ri_576], @19_y_532[@ri_576], @19_x_533[@ri_576] with @19_m2_531[@ri_576] in find at 1317
    - Replaced ((pkX[@ri_578] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_578])) with (m_239 = @19_m2_526[@ri_578]) at 51646
    - Replaced msg_468[@i_579] with concat1(Na_341[@i_579], A) at 1421
    - Remove let at 1416
    - Replaced defined condition pkX[@ri_578], msg_468[@ri_578], @19_r3_530[@ri_578], @19_r3_530[@ri_578], @19_m2_526[@ri_578] with @19_m2_526[@ri_578] in find at 1317
    - Replaced ((@19_y_522[@ri_580] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_580])) with (m_239 = @19_m2_521[@ri_580]) at 51657
    - Replaced @19_x_523[@i_581] with pad(Nb_240[@i_581]) at 1337
    - Remove let at 1332
    - Replaced defined condition @19_m2_521[@ri_580], @19_y_522[@ri_580], @19_x_523[@ri_580] with @19_m2_521[@ri_580] in find at 1317
    - Transformed find at 1267 into a test
    - Replaced (pkX = @19_pkgen2(k_562)) with true at 1268
    - Test at 1267 always true
    - Replaced ((pkY[@ri_566] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_566])) with (m_239 = @19_m2_556[@ri_566]) at 56461
    - Replaced msg_516[@i_567] with concat2(Na_338[@i_459[@i_567]], Nb_471[@i_567], B) at 1171
    - Remove let at 57771
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 1166 (tuple expanded)
    - Replaced defined condition pkY[@ri_566], msg_516[@ri_566], Nb_471[@ri_566], Nb_471[@ri_566], @19_m2_556[@ri_566] with @19_m2_556[@ri_566] in find at 565
    - Replaced ((pkY[@ri_568] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_568])) with (m_239 = @19_m2_551[@ri_568]) at 56472
    - Replaced msg_515[@i_569] with concat2(Na_341[@i_455[@i_569]], Nb_473[@i_569], B) at 1087
    - Simplify pattern =Na_341 at 58408 (equality test)
    - Replaced (Na_341 = Na_341[@i_455[@i_569]]) with false at 58419
    - Test at 58408 always false
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 1082 (tuple expanded)
    - Replaced defined condition pkY[@ri_568], msg_515[@ri_568], Nb_473[@ri_568], Nb_473[@ri_568], @19_m2_551[@ri_568] with @19_m2_551[@ri_568] in find at 565
    - Replaced ((pkY[@ri_570] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_570])) with (m_239 = @19_m2_546[@ri_570]) at 56483
    - Replaced msg_518[@i_571] with concat2(Na_246[@i_571], Nb_469[@i_571], B) at 1003
    - Simplify pattern =Na_341 at 58959 (equality test)
    - Simplify pattern =hostX at 58957 (equality test)
    - Replaced (hostX = B) with false at 59002
    - Test at 58957 always false
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 998 (tuple expanded)
    - Replaced defined condition pkY[@ri_570], msg_518[@ri_570], Nb_469[@ri_570], Nb_469[@ri_570], @19_m2_546[@ri_570] with Nb_469[@ri_570], Na_246[@ri_570], @19_m2_546[@ri_570] in find at 565
    - Replaced ((pkY[@ri_572] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_572])) with (m_239 = @19_m2_541[@ri_572]) at 56494
    - Replaced msg_517[@i_573] with concat2(Na_246[@i_573], Nb_333[@i_573], B) at 919
    - Simplify pattern =Na_341 at 59650 (equality test)
    - Simplify pattern =hostX at 59648 (equality test)
    - Replaced (hostX = B) with false at 59693
    - Test at 59648 always false
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 914 (tuple expanded)
    - Replaced defined condition pkY[@ri_572], msg_517[@ri_572], @19_r3_545[@ri_572], @19_r3_545[@ri_572], @19_m2_541[@ri_572] with Nb_333[@ri_572], Na_246[@ri_572], @19_m2_541[@ri_572] in find at 565
    - Replaced ((pkX[@ri_574] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_574])) with (m_239 = @19_m2_536[@ri_574]) at 56505
    - Replaced msg_466[@i_575] with concat1(Na_335[@i_575], A) at 835
    - Remove let at 830
    - Replaced defined condition pkX[@ri_574], msg_466[@ri_574], Na_335[@ri_574], Na_335[@ri_574], @19_m2_536[@ri_574] with @19_m2_536[@ri_574] in find at 565
    - Replaced ((@19_y_532[@ri_576] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_576])) with (m_239 = @19_m2_531[@ri_576]) at 56516
    - Replaced @19_x_533[@i_577] with pad(Nb_240[@i_577]) at 751
    - Remove let at 746
    - Replaced defined condition @19_m2_531[@ri_576], @19_y_532[@ri_576], @19_x_533[@ri_576] with @19_m2_531[@ri_576] in find at 565
    - Replaced ((pkX[@ri_578] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_578])) with (m_239 = @19_m2_526[@ri_578]) at 56527
    - Replaced msg_468[@i_579] with concat1(Na_341[@i_579], A) at 669
    - Remove let at 664
    - Replaced defined condition pkX[@ri_578], msg_468[@ri_578], @19_r3_530[@ri_578], @19_r3_530[@ri_578], @19_m2_526[@ri_578] with @19_m2_526[@ri_578] in find at 565
    - Replaced ((@19_y_522[@ri_580] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_580])) with (m_239 = @19_m2_521[@ri_580]) at 56538
    - Replaced @19_x_523[@i_581] with pad(Nb_240[@i_581]) at 585
    - Remove let at 580
    - Replaced defined condition @19_m2_521[@ri_580], @19_y_522[@ri_580], @19_x_523[@ri_580] with @19_m2_521[@ri_580] in find at 565
    - Replaced ((pkY[@ri_582] = @19_pkgen2(k_562)) && (m_239 = @19_m2_556[@ri_582])) with (m_239 = @19_m2_556[@ri_582]) at 61294
    - Replaced msg_516[@i_583] with concat2(Na_338[@i_459[@i_583]], Nb_471[@i_583], B) at 467
    - Remove let at 62546
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 462 (tuple expanded)
    - Replaced defined condition pkY[@ri_582], msg_516[@ri_582], Nb_471[@ri_582], Nb_471[@ri_582], @19_m2_556[@ri_582] with @19_m2_556[@ri_582] in find at 85
    - Replaced ((pkY[@ri_584] = @19_pkgen2(k_562)) && (m_239 = @19_m2_551[@ri_584])) with (m_239 = @19_m2_551[@ri_584]) at 61305
    - Replaced msg_515[@i_585] with concat2(Na_341[@i_455[@i_585]], Nb_473[@i_585], B) at 415
    - Simplify pattern =Na_341 at 63179 (equality test)
    - Replaced (Na_341 = Na_341[@i_455[@i_585]]) with (i_228 = @i_455[@i_585]) at 63190
    - Simplify pattern =hostX at 63177 (equality test)
    - Replaced (hostX = B) with false at 63261
    - Test at 63177 always false
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 410 (tuple expanded)
    - Replaced defined condition pkY[@ri_584], msg_515[@ri_584], Nb_473[@ri_584], Nb_473[@ri_584], @19_m2_551[@ri_584] with Nb_473[@ri_584], @i_455[@ri_584], @19_m2_551[@ri_584] in find at 85
    - Replaced ((pkY[@ri_586] = @19_pkgen2(k_562)) && (m_239 = @19_m2_546[@ri_586])) with (m_239 = @19_m2_546[@ri_586]) at 61316
    - Replaced msg_518[@i_587] with concat2(Na_246[@i_587], Nb_469[@i_587], B) at 363
    - Simplify pattern =Na_341 at 63850 (equality test)
    - Simplify pattern =hostX at 63848 (equality test)
    - Replaced (hostX = B) with false at 63893
    - Test at 63848 always false
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 358 (tuple expanded)
    - Replaced defined condition pkY[@ri_586], msg_518[@ri_586], Nb_469[@ri_586], Nb_469[@ri_586], @19_m2_546[@ri_586] with Nb_469[@ri_586], Na_246[@ri_586], @19_m2_546[@ri_586] in find at 85
    - Replaced ((pkY[@ri_588] = @19_pkgen2(k_562)) && (m_239 = @19_m2_541[@ri_588])) with (m_239 = @19_m2_541[@ri_588]) at 61327
    - Replaced msg_517[@i_589] with concat2(Na_246[@i_589], Nb_333[@i_589], B) at 311
    - Simplify pattern =Na_341 at 64594 (equality test)
    - Simplify pattern =hostX at 64592 (equality test)
    - Replaced (hostX = B) with false at 64637
    - Test at 64592 always false
    - Simplify pattern concat2(=Na_341, Nb_240: nonce, =hostX) at 306 (tuple expanded)
    - Replaced defined condition pkY[@ri_588], msg_517[@ri_588], @19_r3_545[@ri_588], @19_r3_545[@ri_588], @19_m2_541[@ri_588] with Nb_333[@ri_588], Na_246[@ri_588], @19_m2_541[@ri_588] in find at 85
    - Replaced ((pkX[@ri_590] = @19_pkgen2(k_562)) && (m_239 = @19_m2_536[@ri_590])) with (m_239 = @19_m2_536[@ri_590]) at 61338
    - Replaced msg_466[@i_591] with concat1(Na_335[@i_591], A) at 259
    - Remove let at 254
    - Replaced defined condition pkX[@ri_590], msg_466[@ri_590], Na_335[@ri_590], Na_335[@ri_590], @19_m2_536[@ri_590] with @19_m2_536[@ri_590] in find at 85
    - Replaced ((@19_y_532[@ri_592] = @19_pkgen2(k_562)) && (m_239 = @19_m2_531[@ri_592])) with (m_239 = @19_m2_531[@ri_592]) at 61349
    - Replaced @19_x_533[@i_593] with pad(Nb_240[@i_593]) at 207
    - Remove let at 202
    - Replaced defined condition @19_m2_531[@ri_592], @19_y_532[@ri_592], @19_x_533[@ri_592] with @19_m2_531[@ri_592] in find at 85
    - Replaced ((pkX[@ri_594] = @19_pkgen2(k_562)) && (m_239 = @19_m2_526[@ri_594])) with (m_239 = @19_m2_526[@ri_594]) at 61360
    - Replaced msg_468[@i_595] with concat1(Na_341[@i_595], A) at 157
    - Remove let at 152
    - Replaced defined condition pkX[@ri_594], msg_468[@ri_594], @19_r3_530[@ri_594], @19_r3_530[@ri_594], @19_m2_526[@ri_594] with @19_m2_526[@ri_594] in find at 85
    - Replaced ((@19_y_522[@ri_596] = @19_pkgen2(k_562)) && (m_239 = @19_m2_521[@ri_596])) with (m_239 = @19_m2_521[@ri_596]) at 61371
    - Replaced @19_x_523[@i_597] with pad(Nb_240[@i_597]) at 105
    - Remove let at 100
    - Replaced defined condition @19_m2_521[@ri_596], @19_y_522[@ri_596], @19_x_523[@ri_596] with @19_m2_521[@ri_596] in find at 85
  - Global dependency analysis on Na_335
  - Global dependency analysis on Na_338
  - Simplification pass
    - Replaced (Nb_469 = Nb_240[@i_407]) with false at 5337
    - Test at 134453 always false
    - Replaced defined condition @19_m2_354[@ri_406], Nb_240[@ri_406] with @19_m2_354[@ri_406] in find at 134480
    - Remove random number generation at 134486
    - Replaced (Nb_333 = Nb_240[@i_443]) with false at 5133
    - Test at 134617 always false
    - Replaced defined condition @19_m2_354[@ri_442], Nb_240[@ri_442] with @19_m2_354[@ri_442] in find at 134642
    - Replaced (Nb_333 = Nb_240[@i_443]) with false at 5038
    - Test at 134575 always false
    - Replaced defined condition @19_m2_354[@ri_442], Nb_240[@ri_442] with @19_m2_354[@ri_442] in find at 134600
    - Replaced (Nb_333 = Nb_240[@i_443]) with false at 4926
    - Test at 134528 always false
    - Replaced defined condition @19_m2_354[@ri_442], Nb_240[@ri_442] with @19_m2_354[@ri_442] in find at 134553
    - Replaced (Nb_471 = Nb_240[@i_407]) with (i_229 = @i_599[@i_407]) at 4605
    - Replaced defined condition @19_m2_354[@ri_406], Nb_240[@ri_406] with @i_599[@ri_406], @19_m2_354[@ri_406] in find at 134334
    - Remove random number generation at 134340
    - Replaced (Nb_473 = Nb_240[@i_407]) with false at 4280
    - Test at 134377 always false
    - Replaced defined condition @19_m2_354[@ri_406], Nb_240[@ri_406] with @19_m2_354[@ri_406] in find at 134404
    - Remove random number generation at 134410
    - Merge all branches of find at 134019
    - Remove random number generation at 134025
    - Replaced defined condition @19_m2_546[@ri_602], Na_246[@ri_602], Nb_469[@ri_602] with @19_m2_546[@ri_602] in find at 134075
    - Replaced defined condition @19_m2_541[@ri_604], Na_246[@ri_604], Nb_333[@ri_604] with @19_m2_541[@ri_604] in find at 134075
    - Remove branch 3 in find at 134075
    - Remove random number generation at 134232
    - Remove branch 3 in find at 134239
    - Remove random number generation at 134186
    - Remove branch 3 in find at 134192
    - Remove branch 3 in find at 134133
yields

Game 26 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_562 <-R keyseed;
          return(@19_pkgen2(k_562));
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              r_372 <-R seed;
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              Na_341 <-R nonce;
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              find @i_597 = @ri_596 <= N suchthat defined(@19_m2_521[@ri_596]) && (m_239 = @19_m2_521[@ri_596]) then
                end
              orfind @i_595 = @ri_594 <= N suchthat defined(@19_m2_526[@ri_594]) && (m_239 = @19_m2_526[@ri_594]) then
                end
              orfind @i_591 = @ri_590 <= N suchthat defined(@19_m2_536[@ri_590]) && (m_239 = @19_m2_536[@ri_590]) then
                end
              orfind @i_589 = @ri_588 <= N suchthat defined(@19_m2_541[@ri_588], Na_246[@ri_588], Nb_333[@ri_588]) && (m_239 = @19_m2_541[@ri_588]) then
              (
                if (Na_341 = Na_246[@i_589]) then
                Nb_240: nonce <- Nb_333[@i_589]
              )
              orfind @i_587 = @ri_586 <= N suchthat defined(@19_m2_546[@ri_586], Na_246[@ri_586], Nb_469[@ri_586]) && (m_239 = @19_m2_546[@ri_586]) then
              (
                if (Na_341 = Na_246[@i_587]) then
                Nb_240: nonce <- Nb_469[@i_587]
              )
              orfind @i_585 = @ri_584 <= N suchthat defined(@19_m2_551[@ri_584], @i_455[@ri_584], Nb_473[@ri_584]) && (m_239 = @19_m2_551[@ri_584]) then
              (
                if (i_228 = @i_455[@i_585]) then
                Nb_240: nonce <- Nb_473[@i_585]
              )
              orfind @i_583 = @ri_582 <= N suchthat defined(@19_m2_556[@ri_582]) && (m_239 = @19_m2_556[@ri_582]) then
                end
              else
                let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                event beginA(A, hostX, Na_341, Nb_240);
                r_367 <-R seed;
                @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                return(@19_m2_364);
                OAFinish() :=
                end
            )
            else
              @19_r3_530 <-R seed;
              @19_r3_529 <-R seed;
              Na_341 <-R nonce;
              msg_468: blocksize <- concat1(Na_341, A);
              if (pkX = @19_pkgen2(k_562)) then
              (
                @19_m2_526: bitstring <- @19_enc2(Z, pkX, @19_r3_529);
                return(@19_m2_526);
                OA5(m_239: bitstring) :=
                find @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580]) && (m_239 = @19_m2_521[@ri_580]) then
                  end
                orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578]) && (m_239 = @19_m2_526[@ri_578]) then
                  end
                orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574]) && (m_239 = @19_m2_536[@ri_574]) then
                  end
                orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572], Na_246[@ri_572], Nb_333[@ri_572]) && (m_239 = @19_m2_541[@ri_572]) then
                (
                  if (Na_341 = Na_246[@i_573]) then
                  Nb_240: nonce <- Nb_333[@i_573]
                )
                orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570], Na_246[@ri_570], Nb_469[@ri_570]) && (m_239 = @19_m2_546[@ri_570]) then
                (
                  if (Na_341 = Na_246[@i_571]) then
                  Nb_240: nonce <- Nb_469[@i_571]
                )
                orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568]) && (m_239 = @19_m2_551[@ri_568]) then
                  end
                orfind @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566]) && (m_239 = @19_m2_556[@ri_566]) then
                  end
                else
                  let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_524 <-R seed;
                  @19_x_523: blocksize <- msg_241;
                  @19_y_522: pkey <- pkX;
                  @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                  return(@19_m2_521);
                  OAFinish() :=
                  end
              )
              else
                return(enc_r(msg_468, pkX, @19_r3_530));
                OA5(m_239: bitstring) :=
                find @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580]) && (m_239 = @19_m2_521[@ri_580]) then
                  end
                orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578]) && (m_239 = @19_m2_526[@ri_578]) then
                  end
                orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574]) && (m_239 = @19_m2_536[@ri_574]) then
                  end
                orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572], Na_246[@ri_572], Nb_333[@ri_572]) && (m_239 = @19_m2_541[@ri_572]) then
                (
                  if (Na_341 = Na_246[@i_573]) then
                  Nb_240: nonce <- Nb_333[@i_573]
                )
                orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570], Na_246[@ri_570], Nb_469[@ri_570]) && (m_239 = @19_m2_546[@ri_570]) then
                (
                  if (Na_341 = Na_246[@i_571]) then
                  Nb_240: nonce <- Nb_469[@i_571]
                )
                orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568]) && (m_239 = @19_m2_551[@ri_568]) then
                  end
                orfind @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566]) && (m_239 = @19_m2_556[@ri_566]) then
                  end
                else
                  let injbot(concat2(=Na_341, Nb_240: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_240);
                  msg_241: blocksize <- pad(Nb_240);
                  @19_r3_525 <-R seed;
                  @19_x_523: blocksize <- msg_241;
                  @19_y_522: pkey <- pkX;
                  return(enc_r(msg_241, pkX, @19_r3_525));
                  OAFinish() :=
                  end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            find @i_613 = @ri_612 <= N suchthat defined(@19_m2_521[@ri_612]) && (m_239 = @19_m2_521[@ri_612]) then
              end
            orfind @i_611 = @ri_610 <= N suchthat defined(@19_m2_526[@ri_610]) && (m_239 = @19_m2_526[@ri_610]) then
              end
            orfind @i_607 = @ri_606 <= N suchthat defined(@19_m2_536[@ri_606]) && (m_239 = @19_m2_536[@ri_606]) then
              end
            orfind @i_605 = @ri_604 <= N suchthat defined(@19_m2_541[@ri_604]) && (m_239 = @19_m2_541[@ri_604]) then
              end
            orfind @i_603 = @ri_602 <= N suchthat defined(@19_m2_546[@ri_602]) && (m_239 = @19_m2_546[@ri_602]) then
              end
            orfind @i_601 = @ri_600 <= N suchthat defined(@19_m2_551[@ri_600]) && (m_239 = @19_m2_551[@ri_600]) then
              end
            orfind @i_599 = @ri_598 <= N suchthat defined(@19_m2_556[@ri_598], @i_459[@ri_598], Nb_471[@ri_598]) && (m_239 = @19_m2_556[@ri_598]) then
            (
              if (i_228 = @i_459[@i_599]) then
              Nb_240: nonce <- Nb_471[@i_599];
              event beginA(A, hostX, Na_338, Nb_240);
              r_357 <-R seed;
              @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
              return(@19_m2_354);
              OAFinish() :=
              event endA(A, hostX, Na_338, Nb_240)
            )
          )
          orfind @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = @19_pkgen2(k_562)) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_539 <-R seed;
            @19_m2_536: bitstring <- @19_enc2(Z, pkX, @19_r3_539);
            return(@19_m2_536);
            OA5(m_239: bitstring) :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], A, k_562, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            msg_515: blocksize <- concat2(Na_341[@i_455], Nb_473, B);
            @19_r3_554 <-R seed;
            @19_m2_551: bitstring <- @19_enc2(Z, pkY, @19_r3_554);
            return(@19_m2_551);
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_473 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              end
            else
              let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], A, k_562, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            msg_516: blocksize <- concat2(Na_338[@i_459], Nb_471, B);
            @19_r3_559 <-R seed;
            @19_m2_556: bitstring <- @19_enc2(Z, pkY, @19_r3_559);
            return(@19_m2_556);
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_471 = Nb_240[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @i_599[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (i_229 = @i_599[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            else
              let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              if (pkY = @19_pkgen2(k_389)) then
              (
                r_387 <-R seed;
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_240[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                @19_r3_545 <-R seed;
                @19_r3_544 <-R seed;
                msg_517: blocksize <- concat2(Na_246, Nb_333, B);
                if defined(k_562) && (pkY = @19_pkgen2(k_562)) then
                (
                  @19_m2_541: bitstring <- @19_enc2(Z, pkY, @19_r3_544);
                  return(@19_m2_541);
                  OB11(m3: bitstring) :=
                  find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_240[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                    end
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
                )
                else
                  return(enc_r(msg_517, pkY, @19_r3_545));
                  OB11(m3: bitstring) :=
                  find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_240[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_240[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                    end
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_322 = @ri_321 <= N suchthat defined(k_562, h2[@ri_321], r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              msg_518: blocksize <- concat2(Na_246, Nb_469, B);
              @19_r3_549 <-R seed;
              @19_m2_546: bitstring <- @19_enc2(Z, pkY, @19_r3_549);
              return(@19_m2_546);
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_240[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_469 = Nb_240[@i_403]) then
                return();
                OBFinish() :=
                event endB(hostY, B, Na_246, Nb_469)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
                end
              else
                let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(hostY, B, Na_246, Nb_469)
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind  suchthat defined(A, k_562) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_562), h2);
            r_307 <-R sseed;
            return(@19_pkgen2(k_562), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, k_562, k_389) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying SA rename Nb_240
  - Rename variable Nb_240 into Nb_826, Nb_825, Nb_824, Nb_823, Nb_822, Nb_821, Nb_820, Nb_819, Nb_818, Nb_817, Nb_816
yields

Game 27 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_562 <-R keyseed;
          return(@19_pkgen2(k_562));
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              r_372 <-R seed;
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              Na_341 <-R nonce;
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              find @i_597 = @ri_596 <= N suchthat defined(@19_m2_521[@ri_596]) && (m_239 = @19_m2_521[@ri_596]) then
                end
              orfind @i_595 = @ri_594 <= N suchthat defined(@19_m2_526[@ri_594]) && (m_239 = @19_m2_526[@ri_594]) then
                end
              orfind @i_591 = @ri_590 <= N suchthat defined(@19_m2_536[@ri_590]) && (m_239 = @19_m2_536[@ri_590]) then
                end
              orfind @i_589 = @ri_588 <= N suchthat defined(@19_m2_541[@ri_588], Na_246[@ri_588], Nb_333[@ri_588]) && (m_239 = @19_m2_541[@ri_588]) then
              (
                if (Na_341 = Na_246[@i_589]) then
                Nb_816: nonce <- Nb_333[@i_589]
              )
              orfind @i_587 = @ri_586 <= N suchthat defined(@19_m2_546[@ri_586], Na_246[@ri_586], Nb_469[@ri_586]) && (m_239 = @19_m2_546[@ri_586]) then
              (
                if (Na_341 = Na_246[@i_587]) then
                Nb_817: nonce <- Nb_469[@i_587]
              )
              orfind @i_585 = @ri_584 <= N suchthat defined(@19_m2_551[@ri_584], @i_455[@ri_584], Nb_473[@ri_584]) && (m_239 = @19_m2_551[@ri_584]) then
              (
                if (i_228 = @i_455[@i_585]) then
                Nb_818: nonce <- Nb_473[@i_585]
              )
              orfind @i_583 = @ri_582 <= N suchthat defined(@19_m2_556[@ri_582]) && (m_239 = @19_m2_556[@ri_582]) then
                end
              else
                let injbot(concat2(=Na_341, Nb_819: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                event beginA(A, hostX, Na_341, Nb_819);
                r_367 <-R seed;
                @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                return(@19_m2_364);
                OAFinish() :=
                end
            )
            else
              @19_r3_530 <-R seed;
              @19_r3_529 <-R seed;
              Na_341 <-R nonce;
              msg_468: blocksize <- concat1(Na_341, A);
              if (pkX = @19_pkgen2(k_562)) then
              (
                @19_m2_526: bitstring <- @19_enc2(Z, pkX, @19_r3_529);
                return(@19_m2_526);
                OA5(m_239: bitstring) :=
                find @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580]) && (m_239 = @19_m2_521[@ri_580]) then
                  end
                orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578]) && (m_239 = @19_m2_526[@ri_578]) then
                  end
                orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574]) && (m_239 = @19_m2_536[@ri_574]) then
                  end
                orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572], Na_246[@ri_572], Nb_333[@ri_572]) && (m_239 = @19_m2_541[@ri_572]) then
                (
                  if (Na_341 = Na_246[@i_573]) then
                  Nb_823: nonce <- Nb_333[@i_573]
                )
                orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570], Na_246[@ri_570], Nb_469[@ri_570]) && (m_239 = @19_m2_546[@ri_570]) then
                (
                  if (Na_341 = Na_246[@i_571]) then
                  Nb_824: nonce <- Nb_469[@i_571]
                )
                orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568]) && (m_239 = @19_m2_551[@ri_568]) then
                  end
                orfind @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566]) && (m_239 = @19_m2_556[@ri_566]) then
                  end
                else
                  let injbot(concat2(=Na_341, Nb_825: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_825);
                  msg_241: blocksize <- pad(Nb_825);
                  @19_r3_524 <-R seed;
                  @19_x_523: blocksize <- msg_241;
                  @19_y_522: pkey <- pkX;
                  @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                  return(@19_m2_521);
                  OAFinish() :=
                  end
              )
              else
                return(enc_r(msg_468, pkX, @19_r3_530));
                OA5(m_239: bitstring) :=
                find @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580]) && (m_239 = @19_m2_521[@ri_580]) then
                  end
                orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578]) && (m_239 = @19_m2_526[@ri_578]) then
                  end
                orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574]) && (m_239 = @19_m2_536[@ri_574]) then
                  end
                orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572], Na_246[@ri_572], Nb_333[@ri_572]) && (m_239 = @19_m2_541[@ri_572]) then
                (
                  if (Na_341 = Na_246[@i_573]) then
                  Nb_820: nonce <- Nb_333[@i_573]
                )
                orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570], Na_246[@ri_570], Nb_469[@ri_570]) && (m_239 = @19_m2_546[@ri_570]) then
                (
                  if (Na_341 = Na_246[@i_571]) then
                  Nb_821: nonce <- Nb_469[@i_571]
                )
                orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568]) && (m_239 = @19_m2_551[@ri_568]) then
                  end
                orfind @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566]) && (m_239 = @19_m2_556[@ri_566]) then
                  end
                else
                  let injbot(concat2(=Na_341, Nb_822: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_822);
                  msg_241: blocksize <- pad(Nb_822);
                  @19_r3_525 <-R seed;
                  @19_x_523: blocksize <- msg_241;
                  @19_y_522: pkey <- pkX;
                  return(enc_r(msg_241, pkX, @19_r3_525));
                  OAFinish() :=
                  end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            find @i_613 = @ri_612 <= N suchthat defined(@19_m2_521[@ri_612]) && (m_239 = @19_m2_521[@ri_612]) then
              end
            orfind @i_611 = @ri_610 <= N suchthat defined(@19_m2_526[@ri_610]) && (m_239 = @19_m2_526[@ri_610]) then
              end
            orfind @i_607 = @ri_606 <= N suchthat defined(@19_m2_536[@ri_606]) && (m_239 = @19_m2_536[@ri_606]) then
              end
            orfind @i_605 = @ri_604 <= N suchthat defined(@19_m2_541[@ri_604]) && (m_239 = @19_m2_541[@ri_604]) then
              end
            orfind @i_603 = @ri_602 <= N suchthat defined(@19_m2_546[@ri_602]) && (m_239 = @19_m2_546[@ri_602]) then
              end
            orfind @i_601 = @ri_600 <= N suchthat defined(@19_m2_551[@ri_600]) && (m_239 = @19_m2_551[@ri_600]) then
              end
            orfind @i_599 = @ri_598 <= N suchthat defined(@19_m2_556[@ri_598], @i_459[@ri_598], Nb_471[@ri_598]) && (m_239 = @19_m2_556[@ri_598]) then
            (
              if (i_228 = @i_459[@i_599]) then
              Nb_826: nonce <- Nb_471[@i_599];
              event beginA(A, hostX, Na_338, Nb_826);
              r_357 <-R seed;
              @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
              return(@19_m2_354);
              OAFinish() :=
              event endA(A, hostX, Na_338, Nb_826)
            )
          )
          orfind @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = @19_pkgen2(k_562)) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            msg_466: blocksize <- concat1(Na_335, A);
            @19_r3_539 <-R seed;
            @19_m2_536: bitstring <- @19_enc2(Z, pkX, @19_r3_539);
            return(@19_m2_536);
            OA5(m_239: bitstring) :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], A, k_562, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            msg_515: blocksize <- concat2(Na_341[@i_455], Nb_473, B);
            @19_r3_554 <-R seed;
            @19_m2_551: bitstring <- @19_enc2(Z, pkY, @19_r3_554);
            return(@19_m2_551);
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_819[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_473 = Nb_819[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              end
            else
              let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], A, k_562, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            msg_516: blocksize <- concat2(Na_338[@i_459], Nb_471, B);
            @19_r3_559 <-R seed;
            @19_m2_556: bitstring <- @19_enc2(Z, pkY, @19_r3_559);
            return(@19_m2_556);
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_819[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_471 = Nb_819[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @i_599[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (i_229 = @i_599[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            else
              let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              if (pkY = @19_pkgen2(k_389)) then
              (
                r_387 <-R seed;
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_819[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                @19_r3_545 <-R seed;
                @19_r3_544 <-R seed;
                msg_517: blocksize <- concat2(Na_246, Nb_333, B);
                if defined(k_562) && (pkY = @19_pkgen2(k_562)) then
                (
                  @19_m2_541: bitstring <- @19_enc2(Z, pkY, @19_r3_544);
                  return(@19_m2_541);
                  OB11(m3: bitstring) :=
                  find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_819[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                    end
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
                )
                else
                  return(enc_r(msg_517, pkY, @19_r3_545));
                  OB11(m3: bitstring) :=
                  find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_819[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                    end
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_322 = @ri_321 <= N suchthat defined(k_562, h2[@ri_321], r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              msg_518: blocksize <- concat2(Na_246, Nb_469, B);
              @19_r3_549 <-R seed;
              @19_m2_546: bitstring <- @19_enc2(Z, pkY, @19_r3_549);
              return(@19_m2_546);
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_819[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_469 = Nb_819[@i_403]) then
                return();
                OBFinish() :=
                event endB(hostY, B, Na_246, Nb_469)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
                end
              else
                let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(hostY, B, Na_246, Nb_469)
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind  suchthat defined(A, k_562) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_562), h2);
            r_307 <-R sseed;
            return(@19_pkgen2(k_562), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, k_562, k_389) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying remove assignments of useless
  - Remove assignments on msg_518 (definition removed, all usages removed)
  - Remove assignments on msg_515 (definition removed, all usages removed)
  - Remove assignments on msg_516 (definition removed, all usages removed)
  - Remove assignments on @19_x_523 (definition removed, all usages removed)
  - Remove assignments on @19_y_522 (definition removed, all usages removed)
  - Remove assignments on Nb_820 (definition removed, all usages removed)
  - Remove assignments on Nb_821 (definition removed, all usages removed)
  - Remove assignments on @19_x_523 (definition removed, all usages removed)
  - Remove assignments on @19_y_522 (definition removed, all usages removed)
  - Remove assignments on Nb_823 (definition removed, all usages removed)
  - Remove assignments on Nb_824 (definition removed, all usages removed)
  - Remove assignments on Nb_816 (definition removed, all usages removed)
  - Remove assignments on Nb_817 (definition removed, all usages removed)
  - Remove assignments on Nb_818 (definition removed, all usages removed)
  - Remove assignments on Nb_826 (definition removed, all usages removed)
  - Remove assignments on msg_466 (definition removed, all usages removed)
  - Remove assignments on msg_241 (definition removed, all usages removed)
yields

Game 28 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_562 <-R keyseed;
          return(@19_pkgen2(k_562));
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              r_372 <-R seed;
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              Na_341 <-R nonce;
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              find @i_597 = @ri_596 <= N suchthat defined(@19_m2_521[@ri_596]) && (m_239 = @19_m2_521[@ri_596]) then
                end
              orfind @i_595 = @ri_594 <= N suchthat defined(@19_m2_526[@ri_594]) && (m_239 = @19_m2_526[@ri_594]) then
                end
              orfind @i_591 = @ri_590 <= N suchthat defined(@19_m2_536[@ri_590]) && (m_239 = @19_m2_536[@ri_590]) then
                end
              orfind @i_589 = @ri_588 <= N suchthat defined(@19_m2_541[@ri_588], Na_246[@ri_588], Nb_333[@ri_588]) && (m_239 = @19_m2_541[@ri_588]) then
              (
                if (Na_341 = Na_246[@i_589]) then
                end
              )
              orfind @i_587 = @ri_586 <= N suchthat defined(@19_m2_546[@ri_586], Na_246[@ri_586], Nb_469[@ri_586]) && (m_239 = @19_m2_546[@ri_586]) then
              (
                if (Na_341 = Na_246[@i_587]) then
                end
              )
              orfind @i_585 = @ri_584 <= N suchthat defined(@19_m2_551[@ri_584], @i_455[@ri_584], Nb_473[@ri_584]) && (m_239 = @19_m2_551[@ri_584]) then
              (
                if (i_228 = @i_455[@i_585]) then
                end
              )
              orfind @i_583 = @ri_582 <= N suchthat defined(@19_m2_556[@ri_582]) && (m_239 = @19_m2_556[@ri_582]) then
                end
              else
                let injbot(concat2(=Na_341, Nb_819: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                event beginA(A, hostX, Na_341, Nb_819);
                r_367 <-R seed;
                @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                return(@19_m2_364);
                OAFinish() :=
                end
            )
            else
              @19_r3_530 <-R seed;
              @19_r3_529 <-R seed;
              Na_341 <-R nonce;
              msg_468: blocksize <- concat1(Na_341, A);
              if (pkX = @19_pkgen2(k_562)) then
              (
                @19_m2_526: bitstring <- @19_enc2(Z, pkX, @19_r3_529);
                return(@19_m2_526);
                OA5(m_239: bitstring) :=
                find @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580]) && (m_239 = @19_m2_521[@ri_580]) then
                  end
                orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578]) && (m_239 = @19_m2_526[@ri_578]) then
                  end
                orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574]) && (m_239 = @19_m2_536[@ri_574]) then
                  end
                orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572], Na_246[@ri_572], Nb_333[@ri_572]) && (m_239 = @19_m2_541[@ri_572]) then
                (
                  if (Na_341 = Na_246[@i_573]) then
                  end
                )
                orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570], Na_246[@ri_570], Nb_469[@ri_570]) && (m_239 = @19_m2_546[@ri_570]) then
                (
                  if (Na_341 = Na_246[@i_571]) then
                  end
                )
                orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568]) && (m_239 = @19_m2_551[@ri_568]) then
                  end
                orfind @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566]) && (m_239 = @19_m2_556[@ri_566]) then
                  end
                else
                  let injbot(concat2(=Na_341, Nb_825: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_825);
                  @19_r3_524 <-R seed;
                  @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                  return(@19_m2_521);
                  OAFinish() :=
                  end
              )
              else
                return(enc_r(msg_468, pkX, @19_r3_530));
                OA5(m_239: bitstring) :=
                find @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580]) && (m_239 = @19_m2_521[@ri_580]) then
                  end
                orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578]) && (m_239 = @19_m2_526[@ri_578]) then
                  end
                orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574]) && (m_239 = @19_m2_536[@ri_574]) then
                  end
                orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572], Na_246[@ri_572], Nb_333[@ri_572]) && (m_239 = @19_m2_541[@ri_572]) then
                (
                  if (Na_341 = Na_246[@i_573]) then
                  end
                )
                orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570], Na_246[@ri_570], Nb_469[@ri_570]) && (m_239 = @19_m2_546[@ri_570]) then
                (
                  if (Na_341 = Na_246[@i_571]) then
                  end
                )
                orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568]) && (m_239 = @19_m2_551[@ri_568]) then
                  end
                orfind @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566]) && (m_239 = @19_m2_556[@ri_566]) then
                  end
                else
                  let injbot(concat2(=Na_341, Nb_822: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_822);
                  msg_241: blocksize <- pad(Nb_822);
                  @19_r3_525 <-R seed;
                  return(enc_r(msg_241, pkX, @19_r3_525));
                  OAFinish() :=
                  end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            find @i_613 = @ri_612 <= N suchthat defined(@19_m2_521[@ri_612]) && (m_239 = @19_m2_521[@ri_612]) then
              end
            orfind @i_611 = @ri_610 <= N suchthat defined(@19_m2_526[@ri_610]) && (m_239 = @19_m2_526[@ri_610]) then
              end
            orfind @i_607 = @ri_606 <= N suchthat defined(@19_m2_536[@ri_606]) && (m_239 = @19_m2_536[@ri_606]) then
              end
            orfind @i_605 = @ri_604 <= N suchthat defined(@19_m2_541[@ri_604]) && (m_239 = @19_m2_541[@ri_604]) then
              end
            orfind @i_603 = @ri_602 <= N suchthat defined(@19_m2_546[@ri_602]) && (m_239 = @19_m2_546[@ri_602]) then
              end
            orfind @i_601 = @ri_600 <= N suchthat defined(@19_m2_551[@ri_600]) && (m_239 = @19_m2_551[@ri_600]) then
              end
            orfind @i_599 = @ri_598 <= N suchthat defined(@19_m2_556[@ri_598], @i_459[@ri_598], Nb_471[@ri_598]) && (m_239 = @19_m2_556[@ri_598]) then
            (
              if (i_228 = @i_459[@i_599]) then
              event beginA(A, hostX, Na_338, Nb_471[@i_599]);
              r_357 <-R seed;
              @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
              return(@19_m2_354);
              OAFinish() :=
              event endA(A, hostX, Na_338, Nb_471[@i_599])
            )
          )
          orfind @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = @19_pkgen2(k_562)) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_335 <-R nonce;
            @19_r3_539 <-R seed;
            @19_m2_536: bitstring <- @19_enc2(Z, pkX, @19_r3_539);
            return(@19_m2_536);
            OA5(m_239: bitstring) :=
            end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], A, k_562, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            @19_r3_554 <-R seed;
            @19_m2_551: bitstring <- @19_enc2(Z, pkY, @19_r3_554);
            return(@19_m2_551);
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_819[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_473 = Nb_819[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
              end
            else
              let injbot(pad(=Nb_473)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_341[@i_455], Nb_473)
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], A, k_562, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            @19_r3_559 <-R seed;
            @19_m2_556: bitstring <- @19_enc2(Z, pkY, @19_r3_559);
            return(@19_m2_556);
            OB11(m3: bitstring) :=
            find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_819[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
            (
              if (Nb_471 = Nb_819[@i_403]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @i_599[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (i_229 = @i_599[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            else
              let injbot(pad(=Nb_471)) = @19_dec2(m3, @19_skgen2(k_389)) in
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
          )
          orfind @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              if (pkY = @19_pkgen2(k_389)) then
              (
                r_387 <-R seed;
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_819[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                @19_r3_545 <-R seed;
                @19_r3_544 <-R seed;
                msg_517: blocksize <- concat2(Na_246, Nb_333, B);
                if defined(k_562) && (pkY = @19_pkgen2(k_562)) then
                (
                  @19_m2_541: bitstring <- @19_enc2(Z, pkY, @19_r3_544);
                  return(@19_m2_541);
                  OB11(m3: bitstring) :=
                  find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_819[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                    end
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
                )
                else
                  return(enc_r(msg_517, pkY, @19_r3_545));
                  OB11(m3: bitstring) :=
                  find @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_819[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                    end
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_322 = @ri_321 <= N suchthat defined(k_562, h2[@ri_321], r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              @19_r3_549 <-R seed;
              @19_m2_546: bitstring <- @19_enc2(Z, pkY, @19_r3_549);
              return(@19_m2_546);
              OB11(m3: bitstring) :=
              find @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
                end
              orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
                end
              orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
                end
              orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402], Nb_819[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              (
                if (Nb_469 = Nb_819[@i_403]) then
                return();
                OBFinish() :=
                event endB(hostY, B, Na_246, Nb_469)
              )
              orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
                end
              orfind @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
                end
              else
                let injbot(pad(=Nb_469)) = @19_dec2(m3, @19_skgen2(k_389)) in
                return();
                OBFinish() :=
                event endB(hostY, B, Na_246, Nb_469)
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind  suchthat defined(A, k_562) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_562), h2);
            r_307 <-R sseed;
            return(@19_pkgen2(k_562), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, k_562, k_389) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying simplify [probability 6. * N / |nonce|]
  - Global dependency analysis on Nb_469
  - Global dependency analysis on Nb_473
  - Global dependency analysis on Nb_471
  - Simplification pass
    - Merge all branches of find at 41235
    - Merge all branches of find at 41017
    - Replaced defined condition @19_m2_364[@ri_402], Nb_819[@ri_402] with @19_m2_364[@ri_402] in find at 41066
    - Merge branches of test at 40885
    - Replaced defined condition @19_m2_541[@ri_572], Na_246[@ri_572], Nb_333[@ri_572] with @19_m2_541[@ri_572] in find at 40905
    - Merge branches of test at 40888
    - Replaced defined condition @19_m2_546[@ri_570], Na_246[@ri_570], Nb_469[@ri_570] with @19_m2_546[@ri_570] in find at 40905
    - Merge branches of test at 40848
    - Replaced defined condition @19_m2_541[@ri_572], Na_246[@ri_572], Nb_333[@ri_572] with @19_m2_541[@ri_572] in find at 40870
    - Merge branches of test at 40851
    - Replaced defined condition @19_m2_546[@ri_570], Na_246[@ri_570], Nb_469[@ri_570] with @19_m2_546[@ri_570] in find at 40870
    - Merge branches of test at 40805
    - Replaced defined condition @19_m2_541[@ri_588], Na_246[@ri_588], Nb_333[@ri_588] with @19_m2_541[@ri_588] in find at 40829
    - Merge branches of test at 40808
    - Replaced defined condition @19_m2_546[@ri_586], Na_246[@ri_586], Nb_469[@ri_586] with @19_m2_546[@ri_586] in find at 40829
    - Merge branches of test at 40811
    - Replaced defined condition @19_m2_551[@ri_584], @i_455[@ri_584], Nb_473[@ri_584] with @19_m2_551[@ri_584] in find at 40829
    - Remove random number generation at 82369
yields

Game 29 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_562 <-R keyseed;
          return(@19_pkgen2(k_562));
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = @19_pkgen2(k_562)) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            @19_r3_539 <-R seed;
            @19_m2_536: bitstring <- @19_enc2(Z, pkX, @19_r3_539);
            return(@19_m2_536);
            OA5(m_239: bitstring) :=
            end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            find @i_599 = @ri_598 <= N suchthat defined(@19_m2_556[@ri_598], @i_459[@ri_598], Nb_471[@ri_598]) && (m_239 = @19_m2_556[@ri_598]) then
            (
              if (i_228 = @i_459[@i_599]) then
              event beginA(A, hostX, Na_338, Nb_471[@i_599]);
              r_357 <-R seed;
              @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
              return(@19_m2_354);
              OAFinish() :=
              event endA(A, hostX, Na_338, Nb_471[@i_599])
            )
            orfind @i_601 = @ri_600 <= N suchthat defined(@19_m2_551[@ri_600]) && (m_239 = @19_m2_551[@ri_600]) then
              end
            orfind @i_603 = @ri_602 <= N suchthat defined(@19_m2_546[@ri_602]) && (m_239 = @19_m2_546[@ri_602]) then
              end
            orfind @i_605 = @ri_604 <= N suchthat defined(@19_m2_541[@ri_604]) && (m_239 = @19_m2_541[@ri_604]) then
              end
            orfind @i_607 = @ri_606 <= N suchthat defined(@19_m2_536[@ri_606]) && (m_239 = @19_m2_536[@ri_606]) then
              end
            orfind @i_611 = @ri_610 <= N suchthat defined(@19_m2_526[@ri_610]) && (m_239 = @19_m2_526[@ri_610]) then
              end
            orfind @i_613 = @ri_612 <= N suchthat defined(@19_m2_521[@ri_612]) && (m_239 = @19_m2_521[@ri_612]) then
              end
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              r_372 <-R seed;
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              Na_341 <-R nonce;
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              find @i_583 = @ri_582 <= N suchthat defined(@19_m2_556[@ri_582]) && (m_239 = @19_m2_556[@ri_582]) then
                end
              orfind @i_585 = @ri_584 <= N suchthat defined(@19_m2_551[@ri_584]) && (m_239 = @19_m2_551[@ri_584]) then
                end
              orfind @i_587 = @ri_586 <= N suchthat defined(@19_m2_546[@ri_586]) && (m_239 = @19_m2_546[@ri_586]) then
                end
              orfind @i_589 = @ri_588 <= N suchthat defined(@19_m2_541[@ri_588]) && (m_239 = @19_m2_541[@ri_588]) then
                end
              orfind @i_591 = @ri_590 <= N suchthat defined(@19_m2_536[@ri_590]) && (m_239 = @19_m2_536[@ri_590]) then
                end
              orfind @i_595 = @ri_594 <= N suchthat defined(@19_m2_526[@ri_594]) && (m_239 = @19_m2_526[@ri_594]) then
                end
              orfind @i_597 = @ri_596 <= N suchthat defined(@19_m2_521[@ri_596]) && (m_239 = @19_m2_521[@ri_596]) then
                end
              else
                let injbot(concat2(=Na_341, Nb_819: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                event beginA(A, hostX, Na_341, Nb_819);
                r_367 <-R seed;
                @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                return(@19_m2_364);
                OAFinish() :=
                end
            )
            else
              @19_r3_530 <-R seed;
              @19_r3_529 <-R seed;
              Na_341 <-R nonce;
              msg_468: blocksize <- concat1(Na_341, A);
              if (pkX = @19_pkgen2(k_562)) then
              (
                @19_m2_526: bitstring <- @19_enc2(Z, pkX, @19_r3_529);
                return(@19_m2_526);
                OA5(m_239: bitstring) :=
                find @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566]) && (m_239 = @19_m2_556[@ri_566]) then
                  end
                orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568]) && (m_239 = @19_m2_551[@ri_568]) then
                  end
                orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570]) && (m_239 = @19_m2_546[@ri_570]) then
                  end
                orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572]) && (m_239 = @19_m2_541[@ri_572]) then
                  end
                orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574]) && (m_239 = @19_m2_536[@ri_574]) then
                  end
                orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578]) && (m_239 = @19_m2_526[@ri_578]) then
                  end
                orfind @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580]) && (m_239 = @19_m2_521[@ri_580]) then
                  end
                else
                  let injbot(concat2(=Na_341, Nb_825: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_825);
                  @19_r3_524 <-R seed;
                  @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                  return(@19_m2_521);
                  OAFinish() :=
                  end
              )
              else
                return(enc_r(msg_468, pkX, @19_r3_530));
                OA5(m_239: bitstring) :=
                find @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566]) && (m_239 = @19_m2_556[@ri_566]) then
                  end
                orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568]) && (m_239 = @19_m2_551[@ri_568]) then
                  end
                orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570]) && (m_239 = @19_m2_546[@ri_570]) then
                  end
                orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572]) && (m_239 = @19_m2_541[@ri_572]) then
                  end
                orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574]) && (m_239 = @19_m2_536[@ri_574]) then
                  end
                orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578]) && (m_239 = @19_m2_526[@ri_578]) then
                  end
                orfind @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580]) && (m_239 = @19_m2_521[@ri_580]) then
                  end
                else
                  let injbot(concat2(=Na_341, Nb_822: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_822);
                  msg_241: blocksize <- pad(Nb_822);
                  @19_r3_525 <-R seed;
                  return(enc_r(msg_241, pkX, @19_r3_525));
                  OAFinish() :=
                  end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], A, k_562, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            @19_r3_559 <-R seed;
            @19_m2_556: bitstring <- @19_enc2(Z, pkY, @19_r3_559);
            return(@19_m2_556);
            OB11(m3: bitstring) :=
            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @i_599[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (i_229 = @i_599[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], A, k_562, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            @19_r3_554 <-R seed;
            @19_m2_551: bitstring <- @19_enc2(Z, pkY, @19_r3_554);
            return(@19_m2_551);
            OB11(m3: bitstring) :=
            end
          )
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_322 = @ri_321 <= N suchthat defined(k_562, h2[@ri_321], r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              @19_r3_549 <-R seed;
              @19_m2_546: bitstring <- @19_enc2(Z, pkY, @19_r3_549);
              return(@19_m2_546);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              if (pkY = @19_pkgen2(k_389)) then
              (
                r_387 <-R seed;
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                  end
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_819[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                @19_r3_545 <-R seed;
                @19_r3_544 <-R seed;
                msg_517: blocksize <- concat2(Na_246, Nb_333, B);
                if defined(k_562) && (pkY = @19_pkgen2(k_562)) then
                (
                  @19_m2_541: bitstring <- @19_enc2(Z, pkY, @19_r3_544);
                  return(@19_m2_541);
                  OB11(m3: bitstring) :=
                  find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                    end
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_819[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
                )
                else
                  return(enc_r(msg_517, pkY, @19_r3_545));
                  OB11(m3: bitstring) :=
                  find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                    end
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_819[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, k_562) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_562), h2);
            r_307 <-R sseed;
            return(@19_pkgen2(k_562), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, k_389, k_562) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Applying move all binders
  - Move assignment to msg_517
  - Move random number generation @19_r3_544
  - Move random number generation @19_r3_545
  - Move assignment to msg_468
  - Move random number generation Na_341
  - Move random number generation @19_r3_529
  - Move random number generation @19_r3_530
yields

Game 30 is
        OStart() :=
        k_232 <-R skeyseed;
        return(@20_pkgen2(k_232));
        (
          OAGK() :=
          A: host <- concat4(hostnameA, roleA);
          k_562 <-R keyseed;
          return(@19_pkgen2(k_562));
          foreach i_228 <= N do
          OA1(hostX: host) :=
          return(A, hostX);
          OA3(pkX: pkey, =hostX, ms_234: signature) :=
          @20_m1_311: sblocksize <- concat3(pkX, hostX);
          find @i_328 = @ri_327 <= N suchthat defined(h2[@ri_327], r_307[@ri_327]) && (pkX = @19_pkgen2(k_562)) && (hostX = h2[@ri_327]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            @19_r3_539 <-R seed;
            @19_m2_536: bitstring <- @19_enc2(Z, pkX, @19_r3_539);
            return(@19_m2_536);
            OA5(m_239: bitstring) :=
            end
          )
          orfind @i_326 = @ri_325 <= N suchthat defined(k_389, h2[@ri_325], r_308[@ri_325]) && (pkX = @19_pkgen2(k_389)) && (hostX = h2[@ri_325]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            Na_338 <-R nonce;
            r_362 <-R seed;
            @19_m2_359: bitstring <- @19_enc2(Z, pkX, r_362);
            return(@19_m2_359);
            OA5(m_239: bitstring) :=
            find @i_599 = @ri_598 <= N suchthat defined(@19_m2_556[@ri_598], @i_459[@ri_598], Nb_471[@ri_598]) && (m_239 = @19_m2_556[@ri_598]) then
            (
              if (i_228 = @i_459[@i_599]) then
              event beginA(A, hostX, Na_338, Nb_471[@i_599]);
              r_357 <-R seed;
              @19_m2_354: bitstring <- @19_enc2(Z, pkX, r_357);
              return(@19_m2_354);
              OAFinish() :=
              event endA(A, hostX, Na_338, Nb_471[@i_599])
            )
            orfind @i_601 = @ri_600 <= N suchthat defined(@19_m2_551[@ri_600]) && (m_239 = @19_m2_551[@ri_600]) then
              end
            orfind @i_603 = @ri_602 <= N suchthat defined(@19_m2_546[@ri_602]) && (m_239 = @19_m2_546[@ri_602]) then
              end
            orfind @i_605 = @ri_604 <= N suchthat defined(@19_m2_541[@ri_604]) && (m_239 = @19_m2_541[@ri_604]) then
              end
            orfind @i_607 = @ri_606 <= N suchthat defined(@19_m2_536[@ri_606]) && (m_239 = @19_m2_536[@ri_606]) then
              end
            orfind @i_611 = @ri_610 <= N suchthat defined(@19_m2_526[@ri_610]) && (m_239 = @19_m2_526[@ri_610]) then
              end
            orfind @i_613 = @ri_612 <= N suchthat defined(@19_m2_521[@ri_612]) && (m_239 = @19_m2_521[@ri_612]) then
              end
          )
          orfind @i_324 = @ri_323 <= N suchthat defined(Kkey[u_305[@ri_323]], h2[@ri_323], r_309[@ri_323]) && (pkX = Kkey[u_305[@ri_323]]) && (hostX = h2[@ri_323]) && @20_check2(@20_m1_311, @20_pkgen2(k_232), ms_234) then
          (
            if defined(k_389) && (pkX = @19_pkgen2(k_389)) then
            (
              r_372 <-R seed;
              @19_m2_369: bitstring <- @19_enc2(Z, pkX, r_372);
              Na_341 <-R nonce;
              return(@19_m2_369);
              OA5(m_239: bitstring) :=
              find @i_583 = @ri_582 <= N suchthat defined(@19_m2_556[@ri_582]) && (m_239 = @19_m2_556[@ri_582]) then
                end
              orfind @i_585 = @ri_584 <= N suchthat defined(@19_m2_551[@ri_584]) && (m_239 = @19_m2_551[@ri_584]) then
                end
              orfind @i_587 = @ri_586 <= N suchthat defined(@19_m2_546[@ri_586]) && (m_239 = @19_m2_546[@ri_586]) then
                end
              orfind @i_589 = @ri_588 <= N suchthat defined(@19_m2_541[@ri_588]) && (m_239 = @19_m2_541[@ri_588]) then
                end
              orfind @i_591 = @ri_590 <= N suchthat defined(@19_m2_536[@ri_590]) && (m_239 = @19_m2_536[@ri_590]) then
                end
              orfind @i_595 = @ri_594 <= N suchthat defined(@19_m2_526[@ri_594]) && (m_239 = @19_m2_526[@ri_594]) then
                end
              orfind @i_597 = @ri_596 <= N suchthat defined(@19_m2_521[@ri_596]) && (m_239 = @19_m2_521[@ri_596]) then
                end
              else
                let injbot(concat2(=Na_341, Nb_819: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                event beginA(A, hostX, Na_341, Nb_819);
                r_367 <-R seed;
                @19_m2_364: bitstring <- @19_enc2(Z, pkX, r_367);
                return(@19_m2_364);
                OAFinish() :=
                end
            )
            else
              if (pkX = @19_pkgen2(k_562)) then
              (
                @19_r3_529 <-R seed;
                @19_m2_526: bitstring <- @19_enc2(Z, pkX, @19_r3_529);
                Na_341 <-R nonce;
                return(@19_m2_526);
                OA5(m_239: bitstring) :=
                find @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566]) && (m_239 = @19_m2_556[@ri_566]) then
                  end
                orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568]) && (m_239 = @19_m2_551[@ri_568]) then
                  end
                orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570]) && (m_239 = @19_m2_546[@ri_570]) then
                  end
                orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572]) && (m_239 = @19_m2_541[@ri_572]) then
                  end
                orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574]) && (m_239 = @19_m2_536[@ri_574]) then
                  end
                orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578]) && (m_239 = @19_m2_526[@ri_578]) then
                  end
                orfind @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580]) && (m_239 = @19_m2_521[@ri_580]) then
                  end
                else
                  let injbot(concat2(=Na_341, Nb_825: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_825);
                  @19_r3_524 <-R seed;
                  @19_m2_521: bitstring <- @19_enc2(Z, pkX, @19_r3_524);
                  return(@19_m2_521);
                  OAFinish() :=
                  end
              )
              else
                Na_341 <-R nonce;
                msg_468: blocksize <- concat1(Na_341, A);
                @19_r3_530 <-R seed;
                return(enc_r(msg_468, pkX, @19_r3_530));
                OA5(m_239: bitstring) :=
                find @i_567 = @ri_566 <= N suchthat defined(@19_m2_556[@ri_566]) && (m_239 = @19_m2_556[@ri_566]) then
                  end
                orfind @i_569 = @ri_568 <= N suchthat defined(@19_m2_551[@ri_568]) && (m_239 = @19_m2_551[@ri_568]) then
                  end
                orfind @i_571 = @ri_570 <= N suchthat defined(@19_m2_546[@ri_570]) && (m_239 = @19_m2_546[@ri_570]) then
                  end
                orfind @i_573 = @ri_572 <= N suchthat defined(@19_m2_541[@ri_572]) && (m_239 = @19_m2_541[@ri_572]) then
                  end
                orfind @i_575 = @ri_574 <= N suchthat defined(@19_m2_536[@ri_574]) && (m_239 = @19_m2_536[@ri_574]) then
                  end
                orfind @i_579 = @ri_578 <= N suchthat defined(@19_m2_526[@ri_578]) && (m_239 = @19_m2_526[@ri_578]) then
                  end
                orfind @i_581 = @ri_580 <= N suchthat defined(@19_m2_521[@ri_580]) && (m_239 = @19_m2_521[@ri_580]) then
                  end
                else
                  let injbot(concat2(=Na_341, Nb_822: nonce, =hostX)) = @19_dec2(m_239, @19_skgen2(k_562)) in
                  event beginA(A, hostX, Na_341, Nb_822);
                  msg_241: blocksize <- pad(Nb_822);
                  @19_r3_525 <-R seed;
                  return(enc_r(msg_241, pkX, @19_r3_525));
                  OAFinish() :=
                  end
          )
        ) | (
          OBGK() :=
          B: host <- concat4(hostnameB, roleB);
          k_389 <-R keyseed;
          return(@19_pkgen2(k_389));
          foreach i_229 <= N do
          OB7(m_245: bitstring) :=
          find @i_461 = @ri_460 <= N suchthat defined(@19_m2_354[@ri_460]) && (m_245 = @19_m2_354[@ri_460]) then
            end
          orfind @i_459 = @ri_458 <= N suchthat defined(@19_m2_359[@ri_458], A, k_562, Na_338[@ri_458]) && (m_245 = @19_m2_359[@ri_458]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_471 <-R nonce;
            event beginB(A, B, Na_338[@i_459], Nb_471);
            @19_r3_559 <-R seed;
            @19_m2_556: bitstring <- @19_enc2(Z, pkY, @19_r3_559);
            return(@19_m2_556);
            OB11(m3: bitstring) :=
            find @i_407 = @ri_406 <= N suchthat defined(@19_m2_354[@ri_406], @i_599[@ri_406]) && (m3 = @19_m2_354[@ri_406]) then
            (
              if (i_229 = @i_599[@i_407]) then
              return();
              OBFinish() :=
              event endB(A, B, Na_338[@i_459], Nb_471)
            )
            orfind @i_405 = @ri_404 <= N suchthat defined(@19_m2_359[@ri_404]) && (m3 = @19_m2_359[@ri_404]) then
              end
            orfind @i_403 = @ri_402 <= N suchthat defined(@19_m2_364[@ri_402]) && (m3 = @19_m2_364[@ri_402]) then
              end
            orfind @i_401 = @ri_400 <= N suchthat defined(@19_m2_369[@ri_400]) && (m3 = @19_m2_369[@ri_400]) then
              end
            orfind @i_397 = @ri_396 <= N suchthat defined(@19_m2_379[@ri_396]) && (m3 = @19_m2_379[@ri_396]) then
              end
            orfind @i_395 = @ri_394 <= N suchthat defined(@19_m2_384[@ri_394]) && (m3 = @19_m2_384[@ri_394]) then
              end
          )
          orfind @i_457 = @ri_456 <= N suchthat defined(@19_m2_364[@ri_456]) && (m_245 = @19_m2_364[@ri_456]) then
            end
          orfind @i_455 = @ri_454 <= N suchthat defined(@19_m2_369[@ri_454], A, k_562, Na_341[@ri_454]) && (m_245 = @19_m2_369[@ri_454]) then
          (
            return(B, A);
            OB9(pkY: pkey, =A, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, A);
            find @i_322 = @ri_321 <= N suchthat defined(r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            Nb_473 <-R nonce;
            event beginB(A, B, Na_341[@i_455], Nb_473);
            @19_r3_554 <-R seed;
            @19_m2_551: bitstring <- @19_enc2(Z, pkY, @19_r3_554);
            return(@19_m2_551);
            OB11(m3: bitstring) :=
            end
          )
          orfind @i_451 = @ri_450 <= N suchthat defined(@19_m2_379[@ri_450]) && (m_245 = @19_m2_379[@ri_450]) then
            end
          orfind @i_449 = @ri_448 <= N suchthat defined(@19_m2_384[@ri_448]) && (m_245 = @19_m2_384[@ri_448]) then
            end
          else
            let injbot(concat1(Na_246: nonce, hostY: host)) = @19_dec2(m_245, @19_skgen2(k_389)) in
            return(B, hostY);
            OB9(pkY: pkey, =hostY, ms_247: signature) :=
            @20_m1_313: sblocksize <- concat3(pkY, hostY);
            find @i_322 = @ri_321 <= N suchthat defined(k_562, h2[@ri_321], r_307[@ri_321]) && (pkY = @19_pkgen2(k_562)) && (hostY = h2[@ri_321]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_469 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_469);
              @19_r3_549 <-R seed;
              @19_m2_546: bitstring <- @19_enc2(Z, pkY, @19_r3_549);
              return(@19_m2_546);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_320 = @ri_319 <= N suchthat defined(h2[@ri_319], r_308[@ri_319]) && (pkY = @19_pkgen2(k_389)) && (hostY = h2[@ri_319]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_331 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_331);
              r_382 <-R seed;
              @19_m2_379: bitstring <- @19_enc2(Z, pkY, r_382);
              return(@19_m2_379);
              OB11(m3: bitstring) :=
              end
            )
            orfind @i_318 = @ri_317 <= N suchthat defined(Kkey[u_305[@ri_317]], h2[@ri_317], r_309[@ri_317]) && (pkY = Kkey[u_305[@ri_317]]) && (hostY = h2[@ri_317]) && @20_check2(@20_m1_313, @20_pkgen2(k_232), ms_247) then
            (
              Nb_333 <-R nonce;
              event beginB(hostY, B, Na_246, Nb_333);
              if (pkY = @19_pkgen2(k_389)) then
              (
                r_387 <-R seed;
                @19_m2_384: bitstring <- @19_enc2(Z, pkY, r_387);
                return(@19_m2_384);
                OB11(m3: bitstring) :=
                find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                  end
                orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                  end
                orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                (
                  if (Nb_333 = Nb_819[@i_439]) then
                  return();
                  OBFinish() :=
                  end
                )
                orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                  end
                orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                  end
                orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                  end
                else
                  let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                  return();
                  OBFinish() :=
                  end
              )
              else
                if defined(k_562) && (pkY = @19_pkgen2(k_562)) then
                (
                  @19_r3_544 <-R seed;
                  @19_m2_541: bitstring <- @19_enc2(Z, pkY, @19_r3_544);
                  return(@19_m2_541);
                  OB11(m3: bitstring) :=
                  find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                    end
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_819[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
                )
                else
                  msg_517: blocksize <- concat2(Na_246, Nb_333, B);
                  @19_r3_545 <-R seed;
                  return(enc_r(msg_517, pkY, @19_r3_545));
                  OB11(m3: bitstring) :=
                  find @i_443 = @ri_442 <= N suchthat defined(@19_m2_354[@ri_442]) && (m3 = @19_m2_354[@ri_442]) then
                    end
                  orfind @i_441 = @ri_440 <= N suchthat defined(@19_m2_359[@ri_440]) && (m3 = @19_m2_359[@ri_440]) then
                    end
                  orfind @i_439 = @ri_438 <= N suchthat defined(@19_m2_364[@ri_438], Nb_819[@ri_438]) && (m3 = @19_m2_364[@ri_438]) then
                  (
                    if (Nb_333 = Nb_819[@i_439]) then
                    return();
                    OBFinish() :=
                    end
                  )
                  orfind @i_437 = @ri_436 <= N suchthat defined(@19_m2_369[@ri_436]) && (m3 = @19_m2_369[@ri_436]) then
                    end
                  orfind @i_433 = @ri_432 <= N suchthat defined(@19_m2_379[@ri_432]) && (m3 = @19_m2_379[@ri_432]) then
                    end
                  orfind @i_431 = @ri_430 <= N suchthat defined(@19_m2_384[@ri_430]) && (m3 = @19_m2_384[@ri_430]) then
                    end
                  else
                    let injbot(pad(=Nb_333)) = @19_dec2(m3, @19_skgen2(k_389)) in
                    return();
                    OBFinish() :=
                    end
            )
        ) | (
          foreach i_230 <= N do
          OS13(h1: host, h2: host) :=
          find  suchthat defined(A, k_562) && (A = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_562), h2);
            r_307 <-R sseed;
            return(@19_pkgen2(k_562), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_307))
          )
          orfind  suchthat defined(B, k_389) && (B = h2) then
          (
            msg_253: sblocksize <- concat3(@19_pkgen2(k_389), h2);
            r_308 <-R sseed;
            return(@19_pkgen2(k_389), h2, @20_sign2(msg_253, @20_skgen2(k_232), r_308))
          )
          orfind u_305 = u_306 <= N2 suchthat defined(Khost_256[u_306], Kkey[u_306], keytbl_304[u_306]) && (Khost_256[u_306] = h2) then
          (
            msg_253: sblocksize <- concat3(Kkey[u_305], h2);
            r_309 <-R sseed;
            return(Kkey[u_305], h2, @20_sign2(msg_253, @20_skgen2(k_232), r_309))
          )
        ) | (
          foreach i_231 <= N2 do
          OK12(Khost_256: host, Kkey: pkey) :=
          if defined(A, B, k_389, k_562) && (Khost_256 <> A) && (Khost_256 <> B) then
          keytbl_304: pkey <- cst_pkey
        )


Proved event inj:endB(x, y, na, nb) ==> inj:beginA(x, y, na, nb) in game 30
Proved event inj:endA(x, y, na, nb) ==> inj:beginB(x, y, na, nb) in game 30
Proved event endB(x, y, na, nb) ==> beginA(x, y, na, nb) in game 30
Proved event endA(x, y, na, nb) ==> beginB(x, y, na, nb) in game 30
Adv[Game 1: event inj:endB(x, y, na, nb) ==> inj:beginA(x, y, na, nb)] <= (8.5 * N * N + 15. * N) / |nonce| + 3. * N * Penc(time(context for game 23) + time + (-1. + 3. * N) * time(enc_r), N) + 3. * N * Penc(time(context for game 13) + time + (-1. + 3. * N) * time(enc_r), 2. * N) + 2. * Penccoll + Psign(time(context for game 7) + time + (-1. + 2. * N) * time(check), N) + Adv[Game 30: event inj:endB(x, y, na, nb) ==> inj:beginA(x, y, na, nb)]
Adv[Game 30: event inj:endB(x, y, na, nb) ==> inj:beginA(x, y, na, nb)] <= 0
RESULT Proved event inj:endB(x, y, na, nb) ==> inj:beginA(x, y, na, nb) up to probability (8.5 * N * N + 15. * N) / |nonce| + 3. * N * Penc(time(context for game 23) + time + (-1. + 3. * N) * time(enc_r), N) + 3. * N * Penc(time(context for game 13) + time + (-1. + 3. * N) * time(enc_r), 2. * N) + 2. * Penccoll + Psign(time(context for game 7) + time + (-1. + 2. * N) * time(check), N)
Adv[Game 1: event inj:endA(x, y, na, nb) ==> inj:beginB(x, y, na, nb)] <= (8.5 * N * N + 15. * N) / |nonce| + 3. * N * Penc(time(context for game 23) + time + (-1. + 3. * N) * time(enc_r), N) + 3. * N * Penc(time(context for game 13) + time + (-1. + 3. * N) * time(enc_r), 2. * N) + 2. * Penccoll + Psign(time(context for game 7) + time + (-1. + 2. * N) * time(check), N) + Adv[Game 30: event inj:endA(x, y, na, nb) ==> inj:beginB(x, y, na, nb)]
Adv[Game 30: event inj:endA(x, y, na, nb) ==> inj:beginB(x, y, na, nb)] <= 0
RESULT Proved event inj:endA(x, y, na, nb) ==> inj:beginB(x, y, na, nb) up to probability (8.5 * N * N + 15. * N) / |nonce| + 3. * N * Penc(time(context for game 23) + time + (-1. + 3. * N) * time(enc_r), N) + 3. * N * Penc(time(context for game 13) + time + (-1. + 3. * N) * time(enc_r), 2. * N) + 2. * Penccoll + Psign(time(context for game 7) + time + (-1. + 2. * N) * time(check), N)
Adv[Game 1: event endB(x, y, na, nb) ==> beginA(x, y, na, nb)] <= (8.5 * N * N + 15. * N) / |nonce| + 3. * N * Penc(time(context for game 23) + time + (-1. + 3. * N) * time(enc_r), N) + 3. * N * Penc(time(context for game 13) + time + (-1. + 3. * N) * time(enc_r), 2. * N) + 2. * Penccoll + Psign(time(context for game 7) + time + (-1. + 2. * N) * time(check), N) + Adv[Game 30: event endB(x, y, na, nb) ==> beginA(x, y, na, nb)]
Adv[Game 30: event endB(x, y, na, nb) ==> beginA(x, y, na, nb)] <= 0
RESULT Proved event endB(x, y, na, nb) ==> beginA(x, y, na, nb) up to probability (8.5 * N * N + 15. * N) / |nonce| + 3. * N * Penc(time(context for game 23) + time + (-1. + 3. * N) * time(enc_r), N) + 3. * N * Penc(time(context for game 13) + time + (-1. + 3. * N) * time(enc_r), 2. * N) + 2. * Penccoll + Psign(time(context for game 7) + time + (-1. + 2. * N) * time(check), N)
Adv[Game 1: event endA(x, y, na, nb) ==> beginB(x, y, na, nb)] <= (8.5 * N * N + 15. * N) / |nonce| + 3. * N * Penc(time(context for game 23) + time + (-1. + 3. * N) * time(enc_r), N) + 3. * N * Penc(time(context for game 13) + time + (-1. + 3. * N) * time(enc_r), 2. * N) + 2. * Penccoll + Psign(time(context for game 7) + time + (-1. + 2. * N) * time(check), N) + Adv[Game 30: event endA(x, y, na, nb) ==> beginB(x, y, na, nb)]
Adv[Game 30: event endA(x, y, na, nb) ==> beginB(x, y, na, nb)] <= 0
RESULT Proved event endA(x, y, na, nb) ==> beginB(x, y, na, nb) up to probability (8.5 * N * N + 15. * N) / |nonce| + 3. * N * Penc(time(context for game 23) + time + (-1. + 3. * N) * time(enc_r), N) + 3. * N * Penc(time(context for game 13) + time + (-1. + 3. * N) * time(enc_r), 2. * N) + 2. * Penccoll + Psign(time(context for game 7) + time + (-1. + 2. * N) * time(check), N)
RESULT time(context for game 7) = N * time(pad) + N * time(dec, maxlength(game 7: m_239)) + N * time(let concat2) + N * time(concat1) + 2. * time(concat4) + 2. * time(pkgen) + 2. * time(skgen) + N * time(dec, maxlength(game 7: m3)) + 3. * N * time(let injbot) + N * time(let pad) + 3. * N * time(enc_r) + N * time(concat2) + N * time(dec, maxlength(game 7: m_245)) + N * time(let concat1) + 3. * N * time(concat3)
RESULT time(context for game 13) = (1. + 6. * N * N) * time(@20_pkgen2) + time(pkgen) + time(skgen) + N * time(pad) + N * time(dec, maxlength(game 13: m_239)) + N * time(let concat2) + N * time(concat1) + 2. * time(concat4) + 6. * N * N * time(@20_check2) + 3. * N * time(let injbot) + N * time(let pad) + N * time(concat2) + N * time(let concat1) + N * time(@20_sign2) + N * time(@20_skgen2) + 3. * N * time(concat3)
RESULT time(context for game 23) = (1. + 6. * N * N) * time(@20_pkgen2) + N * time(pad) + N * time(let concat2) + N * time(concat1) + 2. * time(concat4) + (1. + 2. * N * N + 4. * N) * time(@19_pkgen2) + N * N * time(= bitstring, maxlength(game 23: m_245), maxlength(game 23: @19_m2_384)) + N * N * time(= bitstring, maxlength(game 23: m_245), maxlength(game 23: @19_m2_379)) + N * N * time(= bitstring, maxlength(game 23: m_245), maxlength(game 23: @19_m2_369)) + N * N * time(= bitstring, maxlength(game 23: m_245), maxlength(game 23: @19_m2_364)) + N * N * time(= bitstring, maxlength(game 23: m_245), maxlength(game 23: @19_m2_359)) + N * N * time(= bitstring, maxlength(game 23: m_245), maxlength(game 23: @19_m2_354)) + 6. * N * N * time(@20_check2) + N * N * time(= bitstring, maxlength(game 23: m3), maxlength(game 23: @19_m2_384)) + N * N * time(= bitstring, maxlength(game 23: m3), maxlength(game 23: @19_m2_379)) + N * N * time(= bitstring, maxlength(game 23: m3), maxlength(game 23: @19_m2_369)) + N * N * time(= bitstring, maxlength(game 23: m3), maxlength(game 23: @19_m2_364)) + N * N * time(= bitstring, maxlength(game 23: m3), maxlength(game 23: @19_m2_359)) + N * N * time(= bitstring, maxlength(game 23: m3), maxlength(game 23: @19_m2_354)) + N * time(@19_dec2, maxlength(game 23: m3)) + 2. * N * time(@19_skgen2) + 3. * N * time(let injbot) + N * time(let pad) + N * time(concat2) + 3. * N * time(@19_enc2) + N * time(@19_dec2, maxlength(game 23: m_245)) + N * time(let concat1) + N * time(@20_sign2) + N * time(@20_skgen2) + 3. * N * time(concat3)
All queries proved.
